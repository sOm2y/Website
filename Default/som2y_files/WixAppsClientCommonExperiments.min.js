define.experiment.Class("wixapps.apps.ecommerce.parts_logic.EcomStoreManageTrait.StoreManagerPopupWidth.New",function(e){var t=e;t.methods({getDataEditDialogParams:function(){this._addPostMessageEvent(this._handleMessageFromManage);var e=window.innerHeight-this.DIALOG_MARGIN;return e=this.DIALOG_MIN_HEIGHT>e?this.DIALOG_MIN_HEIGHT:e,{url:this._getStoreManageURL(),params:{width:992,height:e,title:this._localizer.localize("ECOM_MANAGE_ONLINE_STORE_TITLE"),description:this._localizer.localize("ECOM_MANAGE_ONLINE_STORE_DESC"),dialogSkin:"wysiwyg.editor.skins.dialogs.JustWindowDialogSkin",dialogId:"econManage",nonModal:!1},onClosedCallback:function(){this._dataProvider.reloadAllData()}.bind(this)}}})}),define.experiment.Class("wixapps.core.apprepo.AppPartDefinition.AppBuilderPage.New",function(e,t){var i=e;i.traits(["wixapps.core.apprepo.traits.AppRepoItem"]),i.fields({_dataSelector:null,_viewName:null,_type:null,_displayName:null,_appPageId:"home"}),i.methods({initialize:function(e){this._appInstance=e},loadFromDefinition:function(e){this.setDataSelectorId(e.dataSelector),this.setViewName(e.viewName),this.setCustomizations(e.customizations),this.setEventHandlers(e.eventHandlers),this.setType(e.type),this.setDisplayName(e.displayName)},setDataSelectorId:function(e){this._dataSelector=e},getDataSelectorId:function(){return this._dataSelector},getDataSelector:function(){return this._appInstance.getDataSelectors().getById(this._dataSelector)},setViewName:function(e){this._viewName=e},getViewName:function(){return this._viewName},setType:function(e){this._type=e},getType:function(){return this._type},getTypeDef:function(){return this._appInstance.getTypesManager().getType(this._type)},setCustomizations:function(e){this._customizations=e},getCustomizations:function(){return this._customizations},setEventHandlers:function(e){this._eventHandlers=e},getEventHandlers:function(){return this._eventHandlers},setDisplayName:function(e){this._displayName=e},getDisplayName:function(){return this._displayName},getSerializableProperties:function(){return["dataSelector","viewName","type","displayName"]}})}),define.experiment.Class("wixapps.core.apprepo.AppPartsRepository.AppBuilderPage.New",function(e,t){var i=e;i.methods({createAndRegister:function(e,t,i,n){var a=new this.imports.AppPartDefinition(this._appInstance);a.setDataSelectorId(e),a.setViewName(t),a.setType(i),a.setDisplayName(n);var o=this.register("apppart",a);return o},filterByType:function(e,t){return this.filter(function(i){var n=i.getType()===e&&i.isUsed();if(t){var a=i.getDataSelector();return n&&!a.isPageBased()}return n})},countAppPartOfType:function(e,t){var i=this.filterByType(e,t);return i.length}})}),define.experiment.Class("wixapps.core.apprepo.ApplicationInstance2.AppBuilderPage.New",function(e,t){var i=e;i.methods({_migrateDefinitions:function(){var e=1,t=this._appDef.getAppPartDefinitions();for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];n.hasOwnProperty("displayName")||(n.displayName="List "+e,e++)}}})}),define.experiment.Class("wixapps.core.data.DataItemUtils.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({findExprItems:function(e){return this.findDataItems(e,"wixapps.core.data.ExprDataItem",function(e){return!(e.getParent()&&e.getParent().getChildRef&&"templates"==e.getParent().getChildRef(e)&&e.getParent().getChildValue&&"Toggle"!=e.getParent().getChildValue("name"))})}})}),define.experiment.Class("wixapps.core.data.DataMigrator.AppBuilderLinks.New",function(e,t){var i=e,n={FIELD_DELETED:"FieldDeleted",FIELD_TYPE_CHANGED:"FieldTypeChanged",FIELD_VALIDATIONS_CHANGED:"FieldValidationsChanged",FIELD_DEFAULT_VALUE_CHANGED:"FieldDefaultValueChanged",FIELD_ADDED:"FieldAdded",VALUE_CHANGED:"ValueChanged"};i.methods({migrateItem:function(e,t){for(var i=Object.clone(t),a=0;e.length>a;a++){var o=e[a],s=o.fieldName;switch(o.op){case n.FIELD_DELETED:delete i[s],delete i.links[s];break;case n.FIELD_TYPE_CHANGED:i[s]=this._convertType(i[s],o.oldField.type,o.newField.type,o.newField.defaultValue);break;case n.FIELD_VALIDATIONS_CHANGED:this._typesManager.validateValue(i[s],o.newField)||(i[s]=o.newField.defaultValue);break;case n.FIELD_DEFAULT_VALUE_CHANGED:i[s]=this._preformDefaultValueMigration(i[s],o.oldField,o.newField);break;case n.FIELD_ADDED:void 0!==o.newField.defaultValue&&(i[s]=o.newField.defaultValue)}}return i},_preformDefaultValueMigration:function(e,t,i){return"wix:Map"===t.type?Object.merge({},i.defaultValue,e):e}})}),define.experiment.dataItem("WIXAPPS_EXTERNAL_APPS.EcomRepo.New",function(e){var t=e;return t.merge({items:{ecommerce:{descriptorResourceName:"ecommerceDescriptor"}}})}),define.experiment.Class("wixapps.core.data.providers.wixdb.WixDbDraftDataProvider.AppBuilderPage.New",function(e,t){var i=e,n=t;i.methods({initialize:n.after(function(){this._adminTypeMigrations.push("_migrateDisplayName")}),_migrateDisplayName:function(e){for(var t=this.getManagedTypes(),i=[],n=0;t.length>n;n++){var a=t[n];a.name!=e.name&&i.push(a.displayName)}for(var o=0,s=e.displayName,r=s;i.contains(r);)o++,r=s+" "+o;return e.displayName=r,e}})}),define.experiment.component("wixapps.core.utils.ListCursor.AppBuilderListSettings2.New",function(e){e.methods({hasSelection:function(){this._currentItemIndex>-1}})}),define.experiment.newClass("wixapps.core.utils.PostponeUntilReady.AppBuilderListSettings2.New",function(e){e.fields({_isReady:!1,_pending:[]}),e.methods({callWhenDone:function(e,t,i){t=t||[],i=i||window,this._isReady?e.apply(i,t):this._pending.push({callback:e,argsArray:t,scope:i})},markAsDone:function(){for(this._isReady=!0;this._pending.length>0;){var e=this._pending.shift();e.callback.apply(e.scope,e.argsArray)}}})}),define.experiment.Class("wixapps.core.views.ProxyFactory.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({initialize:function(e,t,i,n,a,o,s,r,l){this._viewRepository=i,this._dataItemFactory=e,this._typesManager=t,this._eventDispatcher=n||new this.imports.ProxyEventBus,this._resourceResolverFunction=a,this._nameSpace=o,this._lifecycleManager=s,this._hostingComponent=r,this._dataItemUtils=new this.imports.DataItemUtils,this._appVars=l},createView:function(e,t,i){i=i||"view";var n=new this.imports.ViewEnvironment(this._dataItemFactory,this._typesManager,this,t,e.getTypeName(),i,this._eventDispatcher,[],void 0,void 0,this._lifecycleManager,this._appVars),a=new this.imports.ViewContext(n,e);return this._createViewInternal(a,t)},_setupViewVariables:function(e,t){var i=t.getChildByRef("vars");if(i)for(var n=i.getChildrenRefs(),a=0;n.length>a;a++){var o=n[a],s=i.getChildByRef(o);e.setVar(o,s.getValue(0)),s.addEvent(Constants.DataItemEvents.CHANGE,function(e,t,i){return function(){e.setVar(t,i.getValue(0))}}(e,o,s))}t.replaceChild(this._appVars,"appVars")}})}),define.experiment.Class("wixapps.core.views.ViewEnvironment.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({initialize:function(e,t,i,n,a,o,s,r,l,p,d,c){this._dataItemFactory=e,this._typesManager=t,this._proxyFactory=i,this._viewName=n,this._forType=a,this._mode=o,this._eventsDispatcher=s,r instanceof Array&&(r=this._dataItemFactory.createDataItem(r)),this._includedViews=r,this._vars={parent:l,vars:{}},this._treePath=new this.imports.TreePath(p),this._lifecycleManager=d,this._appVars=c},newCopy:function(){return new this.constructor(this._dataItemFactory,this._typesManager,this._proxyFactory,this._viewName,this._forType,this._mode,this._eventsDispatcher,this._includedViews,this._vars,this._treePath,this._lifecycleManager,this._appVars)},getVar:function(e){for(var t=this._vars;t;t=t.parent){var i=t.vars[e];if(i)return i}return this._getAppVar(e)||void 0},setVar:function(e,t){var i=this._vars.vars[e]||this._getAppVar(e);return i?i.setValue(t):(i=this._dataItemFactory.createDataItem(t),this._vars.vars[e]=i),i},_getAppVar:function(e){return this._appVars.getChildByRef(e)}})}),define.experiment.Class("wixapps.core.views.ViewsCustomizer.WixAppsApplicationData.New",function(e,t){var i=e;i.statics({_findApplicableFields:function(e,t){var i=[];return"vars"==t.fieldId?i.push(e.vars):"appVars"==t.fieldId?i.push(e.appVars):this._findApplicableFieldsOnItem(e,t,0,i),i}})}),define.experiment.Class("wixapps.core.views.proxies.ArrayProxy.AppBuilderListSettings2.New",function(e){e.methods({_createChildComponents:function(e){this._children.forEach(function(t){var i=t.createComponent();this._components.push(i),this._onChildCreated(t,i),e.grab(i)}.bind(this))},_onChildCreated:function(){},_onBeforeChildDisposed:function(){}})}),define.experiment.component("wixapps.integration.components.AppPart.AutoResizeEvent.New",function(e){var t=e;t.propertiesSchemaType("AppPartProperties"),t.methods({_onAppPartRenderComplete:function(){this.fireEvent("proxyDisplayed",this._mainProxy),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_VIEW_READY),this.fireEvent("autoSized"),this.setState("content"),window.requestAnimFrame(function(){this._updateHeight()}.bind(this))},_setupMainProxyListeners:function(e){var t=this;e.addEvent("wix:zoom-link:open-zoom",function(e){var i=e.zoomParams,n=t.getPartDef().zoomPartName,a=t._logic.getZoomExtraParams&&t._logic.getZoomExtraParams(),o=Object.merge(i.extraParams,a);t.getAppInstance().getZoomHandler().openZoomForItemsList(i.list,i.selectedIndex,n,o)}),e.addEvent("wix:edit-link:open-editor",function(e){var i=e.zoomParams,n=t.getPartDef().zoomPartName;t.getAppInstance().getZoomHandler().openZoomForItemsList(i.list,i.selectedIndex,n)}),e.addEvent("wix:app-link:navigate",function(e){t._navigateToAppPage(e)})}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsApplicationData.New",function(e){var t=e;t.methods({initApp:function(){if(!this._isDisposed){if(this._customizations=new this.imports.ViewsCustomizer(this._appInstance.getDataItemFactory()),this._viewDefinitions=new this.imports.ViewDefinitionsOverrideRepository(this._appInstance.getViewDefRepo(),this._customizations,this._appInstance.getDataItemFactory()),this._applyCustomizationRulesToDefinitions(),this._proxyFactory=new this.imports.ProxyFactory(this._appInstance.getDataItemFactory(),this._appInstance.getTypesManager(),this._viewDefinitions,this._eventDispatcher,this._appInstance.resolveResourcePath,this._appInstance.getPackageName(),this._lifecycleManager,this,this._appInstance.getApplicationVars()),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory),this._partDef=this._appInstance.getPartDefinition(this._data.get("appPartName")),!this._partDef)throw Error("AppPart.initApp partName ["+this._data.get("appPartName")+"] not found in app descriptor");this._allowHeightResize=this._partDef.allowHeightResize||!1,this._allowHeightResize||(this._resizableSides=[Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.RIGHT]),this._partDef.minWidth&&this.setMinW(this._partDef.minWidth),this._loadPartLogic(),this._view.set("partid",this._appInstance.getPackageName()+"_"+this._partDef.id)}},getCustomizationDefaultValue:function(e,t,i,n){var a={forType:e,viewName:t,fieldId:i,key:n},o=this._appInstance.getViewDefRepo(),s=o.getViewDefinition(e,t);if(!s)throw"View "+e+"|"+t+" not found in repository";return s=s.getValue(0),s.appVars=this._appInstance.getApplicationVars().getValue(),this._customizations.getCurrentValue(s,a)},_applyCustomizationRulesToDefinitions:function(){this._customizations.clearRules(),this._customizations.addRules(this._data.get("appLogicCustomizations"));var e=this._appInstance.getViewDefRepo();this._viewDefinitions.getAllViewDefinitions().forEach(function(t){var i=e.getViewDefinition(t.getChildValue("forType"),t.getChildValue("name")).getValue(0);this._customizations.applyAll(i),i.appVars=this._appInstance.getApplicationVars().getValue(),t.setValue(i)}.bind(this)),this.fireEvent("customizationApplied")},applyCustomizationRule:function(e,t){var i,n,a=this._data.get("appLogicCustomizations");if("appVars"==e.fieldId){var o=this._appInstance.getApplicationVars(),s=o.getValue();s[e.key]=e.value,o.setValue(s)}e.type="AppPartCustomization";for(var r=0;a.length>r;r++)if(i=a[r],i.forType===e.forType&&i.view===e.view&&i.fieldId===e.fieldId&&i.mode===e.mode&&i.key===e.key){n=a.splice(r,1);break}a.push(e),this._ignoreUpdate=!t;var l=n?n[0]:void 0,p=this.getCustomizationDefaultValue(e.forType,e.view,e.fieldId,e.key),d=l?!this.injects().Utils.areObjectsEqual(e,l):p!=e.value;d&&this.injects().Commands.executeCommand("WViewerCommands.AppDataChange",[e,l,this]),this._data.fireDataChangeEvent(this._data,e,l,this,!0),this._ignoreUpdate=!1,this._applyCustomizationRulesToDefinitions(),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_PART_RESIZE),window.requestAnimFrame(function(){this.fireEvent("autoSized")}.bind(this))}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsContentResize.New",function(e){e.methods({initialize:function(e,t,i){this.parent(e,t,i),this._logger=new this.imports.WixAppsLogger,this._appInstance=null,this._eventDispatcher=new this.imports.ProxyEventBus,this.setState("content"),this._resizeHandler=new this.imports.AppResizeHandler,this._lifecycleManager=new this.imports.LifecycleManager(this._eventDispatcher,!0),this._eventDispatcher.addEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE,this._onContentResize),this.injects().Commands.registerCommand("WViewerCommands.AppDataChange",!0),this.setMaxH(8e3)},_activateHandlers:function(){this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._skinParts.inlineContent)},_updateHeight:function(){this._allowHeightResize===!1&&(this.setHeight(this._getMinPhysicalHeight(),!1,!1),this.fireEvent("autoSizeChange"),this.fireEvent("autoSized"))}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsDirection.New",function(e,t){var i=e,n=t;i.propertiesSchemaType("AppPartProperties"),i.methods({_onAllSkinPartsReady:n.after(function(){this._skinParts.inlineContent.setStyles({direction:this.getComponentProperty("direction")})}),_onDataChange:function(e){return this._ignoreUpdate?void 0:"AppPartProperties"===e.getType()?(this._skinParts.inlineContent.setStyle("direction",e.get("direction")),void 0):(this._appInstance&&this._runLogic(),void 0)}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsLayoutFixes.New",function(e,t){var i=e,n=t;i.methods({_onAllSkinPartsReady:n.after(function(){Browser.firefox&&this._skinParts.inlineContent.setStyles({"white-space":"pre-wrap"})})})}),define.experiment.component("wixapps.integration.components.AppPart2.AppBuilderPage.New",function(e,t){var i=e,n=t;i.methods({markNeedsDuplication:n.remove(),onDuplicate:n.remove()})}),define.experiment.Class("wixapps.integration.components.ClippedParagraph.AutoResizeEvent.New",function(e,t){var i=e;i.methods({_clipParagraphByLines:function(e,t,i,n,a,o){var s=e!==this._paragraphClipping.getLastTextContent();s&&t.set("html",e),this._paragraphClipping.hideEllipsis(),this._paragraphLineMap.updateMap(t),this._paragraphClipping.showEllipsis();var r=Math.min(a,this._paragraphLineMap.getLineNum()),l=this._paragraphLineMap.getParagraphHeight(r),p=l/r;this._paragraphClipping.clipParagraph(e,t,i,l);var d=0;if("none"!==o&&a>r){var c=parseInt((a-r)*p,10);l+=c,"bottom"===o?d=c:"middle"===o&&(d=Math.floor(c/2))}n>0&&(l=Math.max(l,p*n)),t.setStyle("margin-top",d),this.setHeight(l,void 0,!1),this._view.setStyles({height:l}),this.fireEvent("autoSized")}})}),define.experiment.Class("wixapps.integration.components.editor.AppPartDataPanel.WixAppsDirection.New",function(e,t){var i=e;i.methods({_addRenderingProperties:function(){if(this._previewComponent.getPartDef().allowRtl===!0){var e="radiobuttons/radio_button_states.png",t={w:"35px",h:"33px"},i=[{value:"ltr",image:e,dimensions:t,icon:"radiobuttons/alignment/left.png"},{value:"rtl",image:e,dimensions:t,icon:"radiobuttons/alignment/right.png"}];this.addRadioImagesField(W.AppsEditor.localize("APP_PART_PANEL_DIRECTION"),i,null,null,"inline").bindToProperty("direction")}}})}),define.experiment.Class("wixapps.integration.components.editor.DataEditorDialog.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_onDialogClosing:function(e){if(this._inSaveProcess)return!1;var t=this.resources.W.Commands.getCommand("WAppsEditorCommands.DataEditorFinish"),i={appId:this._targetComp.getDataItem().get("appInnerID")},n=this._appsEnvironment;if("DISCARD"==e.result||"CANCEL"==e.result){var a=function(){i.dataChanged=!1,t.execute(i),this._dialogWindow.closeDialog(),n.popDataServiceContext(),this.dispose()}.bind(this);return this.injects().EditorDialogs.openPromptDialog("Discard Changes","Are you sure you want delete all the edits you just made?","",this.resources.W.EditorDialogs.DialogButtonSet.YES_NO,function(e){e.result==this.resources.W.EditorDialogs.DialogButtons.YES&&setTimeout(a,0)}.bind(this),!1),!1}$$("body").removeEvent("click",this._closeAddItemCombo);var o=n.getDataService();if("SAVE"==e.result){var s,r=o.getItemCache(),l=[],p=[],d=[],c=r.getItemsMarkedAsDeleted(),h=c.length;r.each(function(e,t){!e.isDirty()&&e.getChildValue("_hash")||r.isItemMarkedAsNonPersistent(t)||l.push(t)});var u=function(){if(this._inSaveProcess=!1,d.length>0)this.injects().EditorDialogs.openErrorDialog("Error Saving Data","Please try again in a few minutes",s.code+"\n"+s.description,null);else{n.popDataServiceContext();try{var e=n.getItemCache();p.forEach(function(t){if(r.isItemMarkedAsDeleted(t))e.remove(t);else{var i=e.put(t,r.get(t).getValue(0));i.resetDirtyFlag()}})}catch(a){var o=n.getLogger();o.reportError(o.Errors.UNABLE_TO_REFRESH_AFTER_SAVE,this.$className,"onSuccess",o.SubCategory.DATA_EDITING)}var l=this.injects().EditorDialogs;l.openPromptDialog("Saved Successfully!","Data is saved successfully and published","",l.DialogButtonSet.OK),i.dataChanged=!0,t.execute(i),this._dialogWindow.closeDialog(),this._appsEnvironment.getAppInstance().fireEvent(Constants.WixAppEvents.FULL_DATA_EDITOR_SAVED,{}),this.dispose()}}.bind(this),m=function(e,t){return function(){"create"==t?p.unshift(e):p.push(e),l.length+h==p.length+d.length&&u()}},g=function(e){return function(t){s=t,d.push(e),l.length+h==p.length+d.length&&u()}};if(l.forEach(function(e){var t=r.get(e);t.getChildValue("_hash")?o.updateItem(r.idsFromKey(e).collectionId,t,m(e,"update"),g(e)):o.createItem(r.idsFromKey(e).collectionId,t,m(e,"create"),g(e))}),c.forEach(function(e){var t=r.idsFromKey(e);o.deleteItem(t.collectionId,t.itemId,m(e,"delete"),g(e))}),l.length>0||c.length>0)return this._inSaveProcess=!0,this.setState("saving"),!1;i.dataChanged=!1,t.execute(i),n.popDataServiceContext(),this._resizeHandler.deactivateResizeHandler(),this.dispose()}},dispose:function(){for(;this._listProxies.length;){var e=this._listProxies.pop();e.dispose()}}})}),define.experiment.Class("wixapps.integration.components.editor.DataItemEditorDialog.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_startEditItem:function(e){this._containmentOptions=this._model.getChildContainmentOptions(e.getTypeName()),this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.NONE?(this._skinParts.addToBtn.collapse(),this.setState("parentNonEditable","parentsEditing")):this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.ONE_TO_MANY_REFERENCE?(this._skinParts.addToBtn.setLabel("Move to"),this._skinParts.addToHeader.appendText("Cancel move"),this._allowMultiParents=!1):(this._skinParts.addToBtn.setLabel("Add to"),this._skinParts.addToHeader.appendText("Add to"),this._allowMultiParents=!0);var t=this._model.getTypeFriendlyName(e.getTypeName());this._isNewItem?this._dialogWindow.setTitle("Add "+t):this._dialogWindow.setTitle("Edit "+t),this._dialogWindow.clearTabs(),this._eventDispatcher=new this.imports.ProxyEventBus,this._resizeHandler=new this.imports.AppResizeHandler,this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._view),this._proxyFactory=new this.imports.ProxyFactory(this._appsEnvironment.getDataItemFactory(),this._appsEnvironment.getTypesManager(),this._appsEnvironment.getViewDefRepo(),this._eventDispatcher,this._appsEnvironment.getAppInstance().resolveResourcePath,this._appsEnvironment.getAppInstance().getPackageName(),new this.imports.LifecycleManager(this._eventDispatcher)),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory),this._originalItem=e,this._editedItem=this._createEditableCopy(this._appsEnvironment.getDataItemFactory(),e),this._autoAddToParent&&this._connectToParent(this._autoAddToParent),this._showContainmentControls(),this.proxy=this._proxyFactory.createView(this._editedItem,"editorForm","edit");var i=this.proxy.createComponent();this.proxy.setupProxy(),window.requestAnimFrame(function(){this.proxy.updateLayoutWhenReady()}.bind(this)),this._skinParts.editViewContainer.empty(),this._skinParts.editViewContainer.grab(i)},_onDialogClosing:function(e){if("CANCEL"==e.result)this._onCloseCallback&&this._onCloseCallback([{action:"cancel",originalItem:this._originalItem,editedItem:this._editedItem}]);else if("DELETE"==e.result)this._deleteItem();else{var t=this._appsEnvironment.getTypesManager().validateDataItem(this._editedItem);if(!t)return!1;if(W.Commands.executeCommand("WAppsEditorCommands.FinalizeDataItemEditing"),"DUPLICATE"==e.result)this._saveAsDuplicate();else if(("OK"==e.result||"OK_ADD_ANOTHER"==e.result)&&(this._isNewItem&&this._isRef&&(this._originalItem=this._model.addToCache(this._model.getItemDefaultCollection(this._originalItem.getTypeName()),this._originalItem.getValue(0))),this._editedItem.isDirty()&&(this._originalItem.isRef()?this._originalItem.setReferencedValue(this._editedItem.getValue(0)):this._originalItem.setValue(this._editedItem.getValue(0))),this._applyReparentingActions(this._originalItem),this._onCloseCallback&&this._onCloseCallback([{action:"update",originalItem:this._originalItem,editedItem:this._editedItem}]),"OK_ADD_ANOTHER"==e.result)){var i=this._model.getItemTemplate(this._editedItem.getTypeName(),this._isRef);return this._startEditItem(i),!1}}$(document.body).setStyle("overflow",this._bodyOverFlow),this._resizeHandler.deactivateResizeHandler(),this.dispose()},dispose:function(){this.proxy.dispose()}})}),define.experiment.Class("wixapps.integration.components.editor.ZoomCustomizer.WixAppsDirection.New",function(e,t){var i=e;i.methods({_addRenderingProperties:function(){if(this._zoomPartDef.allowRtl===!0){var e="radiobuttons/radio_button_states.png",t={w:"35px",h:"33px"},i=[{value:"ltr",image:e,dimensions:t,icon:"radiobuttons/alignment/left.png"},{value:"rtl",image:e,dimensions:t,icon:"radiobuttons/alignment/right.png"}];this._directionRadios=this.addRadioImagesField(W.AppsEditor.localize("APP_PART_PANEL_DIRECTION"),i,null,null,"inline"),this._directionRadios.addEvent("inputChanged",function(e){this._zoomComp&&this._zoomComp.setComponentProperty("direction",e.value)}.bind(this))}},_onZoomOpened:function(e){this._zoomComp&&this._zoomComp.getDataItem().removeEvent("dataChanged",this._updateCustomizations),this._zoomComp=e,this._currentZoomData=this._zoomComp.getDataItem(),this._zoomComp.getDataItem().addEvent("dataChanged",this._updateCustomizations),this._zoomComp.addEvent("proxyDisplayed",this._updateCustomizationPanel),W.AppsEditor.activateContentSelector($$("#editorUI")[0],e),$$("#editorUI").addEvent("click",this._customizeSubSelection),this._directionRadios&&this._directionRadios.setValue(this._zoomComp.getComponentProperty("direction"))}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderDialogPanel.AppBuilderPage.New",function(e,t){var i=e;i.skinParts({titleContent:{type:"htmlElement",optional:!0},panelLabel:{type:"htmlElement"},panelDescription:{type:"htmlElement"},help:{type:"htmlElement",optional:!0},close:{type:"htmlElement",optional:!0},paneCloseBtn:{type:"htmlElement",optional:!0},inlineContent:{type:"htmlElement"}}),i.resources(["W.Resources","W.Commands","W.AppsGUI"]),i.methods({_updateTitleContentViewHolder:function(){this._titleContentViewHolder.setContainer(this._skinParts.titleContent),this._skinParts.titleContent.addClass("wixAppsGui"),this._presenter.runWhenReady?this._presenter.runWhenReady(function(){this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")}.bind(this)):this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")},setupPanel:function(e,t,i){if(this.parent(e,t,i),this._skinParts.titleContent){var n=e.getDataItemFactory(),a=this.resources.W.AppsGUI.getViewDescriptor("DataPanelTitleView");a.forType=this._panelModel.getChildValue("_type")||("Array"!=a.forType?"wix:Object":"Array"),a.vars=a.vars||{},a.vars.presenter={};var o=this._viewDefRepo.setViewDefinition(a,!0);this._createPresenterVars(i,o),this._titleContentViewHolder=new this.imports.ViewHolder(n,this._typeManager,this._viewDefRepo,e.resolveResourcePath),this._updateTitleContentViewHolder()}this._hideDescription&&this._skinParts.panelDescription.collapse(),this._helpId&&this._skinParts.help.addEvent("click",this._openHelpDialog),this._skinParts.close&&this._skinParts.close.addEvent(Constants.CoreEvents.CLICK,this._onClose),this._skinParts.paneCloseBtn&&(this._skinParts.paneCloseBtn.addEvent(Constants.CoreEvents.CLICK,this._onExpand),this._skinParts.paneCloseBtn.set("text",this.resources.W.Resources.get("EDITOR_LANGUAGE","close")));var s=window.getSize(),r={x:[10,s.x-this.DRAG_OFFSET],y:[this.DRAG_OFFSET,s.y-this.DRAG_OFFSET]};this._skinParts.titleContent&&(this._drag=new Drag.Move(this._dialogBox,{snap:0,handle:this._skinParts.titleContent,limit:r}))}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderManageDialog.AppBuilderPage.New",function(e,t){var i=e;i.methods({_initSkinParts:function(){var e=this._skinParts;this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_PROPERTY_PANEL),this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_ALL_PANELS),e.customizeItemTemplatePane.addEvent("closeClicked",this._closeDialog);var t=this.resources.W.AppsGUI;e.manageItemsPane.setupPanel(this._appInstance,t.getViewDescriptor("ManageItemsView"),this._manageItemPresenter),e.manageItemsPane.setTitle(this._loc("ManageItemsTitle")),e.manageItemsPane.setDescription(this._loc("ManageItemsDescription")),e.manageItemsPane.addEvent("expandIconClicked",this._expandCollapse);var i;i=this._appPart.getDataSelector().isPageBased()?this._typeDef.displayName:this._appPart.getAppPartDefinition().getDisplayName(),e.customizeItemTemplatePane.setTitle(i),e.customizeItemTemplatePane.setupPanel(this._appInstance,t.getViewDescriptor("CustomizeItemsView"),this._customizeItemsPresenter),e.itemDataPane.setTitle(""),e.itemDataPane.setDescription(""),e.itemDataPane.setupPanel(this._appInstance,t.getViewDescriptor("DataEditView"),this._dataEditPresenter),e.itemDataPane.addEvent("closeClicked",this._closeDialog),e.itemDataPane.getState("expanded")||(e.itemDataPane.setState("collapsed","expanded"),this.setState("collapsed","expanded")),this._skinParts.tabs.addEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._skinParts.tabs.getElement("[rel=dataPane]").set("html",this._loc("Tab_Data")),this._skinParts.tabs.getElement("[rel=templatePane]").set("html",this._loc("Tab_Template"));var n=window.getSize(),a={x:[10,n.x-this._dialogWindow.DRAG_OFFSET],y:[this._dialogWindow.DRAG_OFFSET,n.y-this._dialogWindow.DRAG_OFFSET]},o=this._dialogWindow._skinParts.dialogBox;this._drag=new Drag.Move(o,{snap:0,handle:this._skinParts.tabs,limit:a}),this.changeTab(this._defaultState)},_removeCursor:function(){this._selectionHandler.dispose(),this._listCursor.removeEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_disposeSkinParts:function(){var e=this._skinParts;e.manageItemsPane.dispose(),e.customizeItemTemplatePane.dispose(),e.itemDataPane.dispose()},_closeDialog:function(){this._dialogWindow.closeDialog(),this.dispose()},dispose:function(){this._skinParts.customizeItemTemplatePane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("expandIconClicked",this._expandCollapse),this._dataEditPresenter.removeEvent("expandIconClicked",this._expandCollapse),this._skinParts.tabs.removeEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._selectionHandler.enableClickPropagation(),this._removeListeners(),this._disposePresenters()}})}),define.experiment.component("wixapps.integration.components.panels.BuilderDialogPanel.AppBuilderListSettings2.New",function(e){e.states(["loading","error","rendering","content"])}),define.experiment.component("wixapps.integration.components.panels.BuilderDialogPanel.AppsBuilderPage.New",function(e,t){var i=e;i.methods({dispose:function(){this._presenter.removeEvent&&this._presenter.removeEvent(Constants.WixAppsGUIEvents.MODEL_REPLACED,this._onModelReplaced),this._presenter.dispose(),this._eventBinding.dispose(),this._varBindings.forEach(function(e){e.dispose()}),this._viewHolder.dispose(),this.parent()}})}),define.experiment.component("wixapps.integration.components.panels.ChooseTextStylePanel.SyncWixify.New",function(e,t){var i=e;i.methods({setEditedComponent:function(e,t){this.disposeFields(),this._appPart=e,this._editedComponent=t,this._currentlySelectedStyle=this._originalStyle;for(var i,n,a,o,s=this._editedComponent.getViewNode().getViewProxy(),r=[],l=-1,p=this._originalStyle.split(/\s/),d=p.filter(function(e){return 0===e.indexOf("font_")}).pick(),c=0;10>=c;c++){i="font_"+(c+""),n="FONT_"+(c+"")+"_LABEL",a=new this.imports.Font(i,W.Preview.getPreviewManagers().Theme);var h=W.Data.createDataItem({type:"Button",label:this.injects().Resources.get("EDITOR_LANGUAGE",n),commandParameter:i},"Button");if(r.push(h),i===d){l=c,o=a;var u=W.Preview.getPreviewManagers().Theme.getProperty(i);this._setFontColor(o,u.getColorReference(),u.getColor())}}this._overrideStyleCheckBox=this.addCheckBoxField("Override text styles:");var m=this;this._overridesGroup=this.addInputGroupField(function(){this.setNumberOfItemsPerLine(0,10),m._fontStyle=this.addFontStyleField(),m._colorPicker=this.addFontColorField();var e=m._setFontStyles(o,p),t=s.getViewDefinition().getChildValue("bold"),i=s.getViewDefinition().getChildValue("italic");m._colorPicker.setValue(o),m._fontStyle.setValue(o);var n=m.addSelectionListInputField("",r,null,{type:"wixapps.integration.components.editor.ChooseTextStyleButton",skin:"wixapps.integration.skins.editor.ChooseTextStyleButtonSkin",numRepeatersInLine:1});n.addEvent("inputChanged",m._itemClick),n.addEvent("editStyleClicked",m._editStyleClicked),m._overrideStyleCheckBox.addEvent("inputChanged",m._colorOverrideChange),m._colorPicker.addEvent("inputChanged",m._colorSelected),m._fontStyle.addEvent("inputChanged",m._fontStyleSelected),m._setFontStyle(o,t,i),n.selectItemAtIndexAndUpdate(l),m._overrideStyleCheckBox.setValue(e);var a=this;a&&e?a.uncollapse():a.collapse()})}})}),define.experiment.component("wixapps.integration.components.panels.EditFieldPanel.AppBuilderPage.New",function(e,t){var i=e;i.methods({initialize:function(e,t,i){this.parent(e,t,i),this._fieldHighlighter=this.resources.W.AppsEditor2.getFieldHighlighter(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper()},setupPanel:function(e){this._presenter=e;var t=this,i=this.resources.W.Resources.get("EDITOR_LANGUAGE","HELPLET_LEARN_MORE");this.setNumberOfItemsPerLine(3,20),t._addLinkButton(this,i,t._onHelpClicked,"linkLeft");var n=this._presenter.getFieldInfo();if(!this._typesHelper.isMandatoryField(n)){var a=this.resources.W.AppsEditor2.localize("DELETE");t._addLinkButton(this,a,t._onDeleteClicked,"linkRight",function(e){e._skinParts.button.getViewNode().setStyles({color:"#aa0000"}),e.getViewNode().setStyles({"float":"right"})})}this.setNumberOfItemsPerLine(1,0),this._isVertical="vertical"===e.getBoxOrientation(),this._addCustomizationControl(this,e.getFieldType(),e.getCompName()),this._setFieldHighlighting(),this._dialogWindow.setCloseCallBack(this._onDialogClosing),this._dialogWindow.getViewNode().addEvent("dialogClosed",this._onDialogClosing)
},_addFieldNameInput:function(e,t){var i=this,n=this._presenter.getFieldInfo(),a=this._typesHelper.isMandatoryField(n);e.addInputGroupField(function(){var e=this.addInputField(i._loc("FieldNameLabel"));e.setValue(t.getFieldDisplayName()),e.addEvent("blur",function(){t.setFieldDisplayName(e.getValue())}),e.runWhenReady(function(e){if(a){e.disable();var t=e.getSkinPart("label");t.setStyle("opacity",1)}})})}})}),define.experiment.component("wixapps.integration.components.panels.ListSettingsPanel.AppBuilderListSettings2.New",function(e,t){e.resources(["W.AppsGUI","W.EditorDialogs","W.Commands","W.AppsEditor2","W.Components"]),e.utilize(["wixapps.core.utils.PostponeUntilReady","wixapps.core.utils.ListCursor","wixapps.integration.gui.CustomizationBinding","wixapps.core.views.ViewsCustomizer","wixapps.integration.gui.ManageItemsPresenter","wixapps.integration.gui.DataEditPresenter","wixapps.integration.gui.CustomizeItemsPresenter"]),e.traits(["core.editor.components.traits.DataPanel"]),e.binds(t.merge(["_onEditOrganizeData","_onCustomizeItems","_listCursorChanged","_loadSharedData","_updateCustomizationPanel","_onOpenItem","_openAdvancedDesign","backToSettings"])),e.skinParts({content:{type:"htmlElement"}}),e.dataTypes(["AppBuilderComponent"]),e.methods({_initModels:function(){this._setupAction=new this.imports.PostponeUntilReady,this._initData()},_createFields:function(){var e=this;"error"!==this._appPart.getState()&&(this._settingsPanel=this.addInputGroupField(function(){var t=[];this.addInputGroupField(function(){e._addCollapsiblePanel(this,"Settings",function(){this.addBreakLine(7,"1px solid #E5E5E5",10),e._createPageLinksFrame(this),e._createListNameFrame(this),e._enablePanelControls()},!1,t)}),this.addBreakLine(10),this.addInputGroupField(function(){e._addCollapsiblePanel(this,"Items",function(){this.addBreakLine(7,"1px solid #E5E5E5",10),e._setupAction.callWhenDone(function(){e.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),this,"ManageItems2",e._manageItemPresenter)}.bind(this))},!0,t)}),this.addBreakLine(10),this.addInputGroupField(function(){e._addCollapsiblePanel(this,"Design",function(){this.addBreakLine(7,"1px solid #E5E5E5",10),this.addInputGroupField(function(){e._custPanel=this,e._updateCustomizationPanel()},"skinless"),this.addButtonField("","Advanced Design Mode",!1,void 0,"blue",0,"").runWhenReady(function(t){t.addEvent("click",e._openAdvancedDesign)})},!1,t)})},"skinless"),this._advancedDesignPanel=this.addInputGroupField(function(){e._setupAction.callWhenDone(function(){e.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),this,"CustomizeItems2",e._customizeItemsPresenter)}.bind(this))}),this._advancedDesignPanel.collapse(),this._dataEditPanel=this.addInputGroupField(function(){e._setupAction.callWhenDone(function(){e.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),this,"DataEdit2",e._dataEditPresenter)}.bind(this))}),this._dataEditPanel.collapse(),this._appPart.addEvent(Constants.WixAppEvents.APP_VIEW_READY,this._updateCustomizationPanel))},_addCollapsiblePanel:function(e,t,i,n,a){n=void 0!==n?n:!1;var o=e.addCheckBoxField(t,null,"toggle");o.setValue(n);var s=e.addInputGroupField(i,"skinless"),r=function(e){e?s.runWhenReady(function(e){e.uncollapseGroup()}.bind(this)):s.runWhenReady(function(e){e.collapseGroup()}.bind(this))};a&&a.push({setIsOpen:r,checkbox:o}),r(n),o.addEvent("inputChanged",function(e){if(a){r(e.value);for(var t=0;a.length>t;t++){var i=a[t].setIsOpen;i!==r&&(i(!1),a[t].checkbox.setValue(!1))}}else r(e.value)}.bind(this))},_onOpenItem:function(){this._openDataItemEditing()},backToSettings:function(){this._settingsPanel.uncollapse(),this._advancedDesignPanel.collapse(),this._dataEditPanel.collapse()},_openAdvancedDesign:function(){this._settingsPanel.collapse(),this._advancedDesignPanel.uncollapse(),this._dataEditPanel.collapse()},_openDataItemEditing:function(){this._settingsPanel.collapse(),this._advancedDesignPanel.collapse(),this._dataEditPanel.uncollapse()},_initData:function(){var e=this._appPart.getAppInstance().getTypesManager();this._typeName=this._appPart.getAppPartDefinition().getType(),this._typeDef=e.getType(this._typeName),this._appInstance=this._appPart.getAppInstance(),this._usedDataSelector=this._appPart.getDataSelector(),this._viewDataItem=this._appPart.getViewDefinition();var t=this._appInstance.getDataItemFactory();this._itemsData=t.createVirtualArray(),this._loadSharedData(function(){this._initCursor(),this._initPresenters()}.bind(this))},_initPresenters:function(){this._manageItemPresenter=new this.imports.ManageItemsPresenter(this._appPart,this._usedDataSelector,this._itemsData,this._typeDef,this._listCursor,this._loadSharedData,this._onOpenItem),this._customizeItemsPresenter=new this.imports.CustomizeItemsPresenter(this._appInstance,this._usedDataSelector,this._typeDef,this._appPart,this._updateModel,this),this._dataEditPresenter=new this.imports.DataEditPresenter(this._appPart,this._listCursor,this._usedDataSelector,this._itemsData,function(){return!1},function(){},this),this._setupAction.markAsDone()},_loadSharedData:function(e){var t,i=this._usedDataSelector.getSelectionType(),n=this._usedDataSelector.getDataProvider();if(this._usedDataSelector.isListSelector())t=this._usedDataSelector.getItemIds(),n.readItems(i,t,function(t){this._itemsData.setChildren(t),e&&e(this._itemsData)}.bind(this));else{var a=n.queryLocalStore(i,{},{},0,-1);this._itemsData.setChildren(a),t=this._itemsData.getChildren().map(function(e){return e.getChildValue("_iid")});var o=this._appInstance.getDataSelectors(),s=o.createAndRegister("IB.ManualSelectedList",n,i,t);this._usedDataSelector=o.getById(s),e&&e(this._itemsData)}},_initCursor:function(){this._selectionHandler=this.resources.W.AppsEditor2.getSelectionHandler();var e=this._selectionHandler.getCurrentDataItem(),t=-1;if(e){var i=e.getChildValue("_iid");t=this._usedDataSelector.getItemIdRealIndex(i)}this._listCursor=new this.imports.ListCursor(this._itemsData,t),this._listCursor.addEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_listCursorChanged:function(e){var t=e.index;e.oldIndex,this._manageItemPresenter.rebuildModel(),this._dataEditPresenter.rebuildModel();var i=this._itemsData.getChildByIndex(t);if(i){var n=i.getChildValue("_iid");t=this._usedDataSelector.getItemIdIndex(n),0>t?this._selectionHandler.removeSelection():this._selectionHandler.setSelectedIndex(t,!0),this._handleNonListSelectors(n)}},_handleNonListSelectors:function(e){var t=this._appPart.getDataSelector();if(t.isListSelector()===!1){var i=t.getLogicalTypeName();switch(i){case"IB.PageSelectedItem":var n=this.resources.W.Preview.getPreviewManagers().Viewer.getCurrentPageNode(),a=n.getLogic();a.updateParams({type:this._typeName,itemId:e});break;case"IB.ManualSelectedItem":t.setItemId(e)}}},_addListeners:function(){this._usedDataSelector.addEvent(Constants.DataEvents.DATA_CHANGED,this._onSelectorDataChange),this._appInstance.addEvent(Constants.WixAppEvents.TYPE_CHANGE,this._onTypeChanged),this._viewDataItem.addEvent(Constants.DataItemEvents.CHANGE,this._onViewDefChange),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.SelectionChanged",this,this._componentSelectionChanged)},_removeListeners:function(){this._usedDataSelector.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onSelectorDataChange),this._appInstance.removeEvent(Constants.WixAppEvents.TYPE_CHANGE,this._onTypeChanged),this._viewDataItem.removeEvent(Constants.DataItemEvents.CHANGE,this._onViewDefChange),this.resources.W.Commands.unregisterListener(this)},_disposePresenters:function(){this._manageItemPresenter.dispose(),this._customizeItemsPresenter.dispose(),this._dataEditPresenter.dispose()},dispose:function(){this._removeListeners(),this._disposePresenters(),this._appPart.removeEvent(Constants.WixAppEvents.APP_VIEW_READY,this._updateCustomizationPanel),this._bindings.forEach(function(e){e.dispose()})}})}),define.experiment.component("wixapps.integration.components.panels.ListSettingsPanel.AppBuilderPage.New",function(e,t){var i=e,n=t;i.binds(n.merge(["_onEditOrganizeData","_onCustomizeItems","_updateCustomizationPanel","_validateListName","_submitListName","_onEnablePageLinks","_onEditPageTemplate","_openPageLinkFieldsDialog","_updateAppPageAndLinkFields","_preSubmitListName"])),i.resources(n.merge(["W.Commands","W.AppsEditor2","W.Preview","W.Utils"])),i.statics({ALLOWED_PAGE_LINK_FIELD_TYPES:["String","wix:Image"]}),i.methods({_initPageSettings:function(){this._viewBuilder=this.resources.W.AppsEditor2.getViewBuilder(),this._viewDef=this._appPart.getViewDefinition(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper()},_createPageLinksFrame:function(e){this._appPart.getDataSelector().isPageBased()||e.addInputGroupField(function(e){this.addButtonField("",e._loc("EditPageTemplate")).runWhenReady(function(t){e._editPageTemplateBtn=t,t.addEvent("click",e._onEditPageTemplate)}),this.addBreakLine(10),this.addCheckBoxField(e._loc("DeepLinkCheckbox")).runWhenReady(function(t){e._enableDeepLinkingChkBox=t,t.addEvent("inputChanged",e._onEnablePageLinks)}),this.addBreakLine(10),this.addButtonField("",e._loc("SetLinkToPage"),!1,void 0,"linkLeft",0,"").runWhenReady(function(t){e._setLinkToPageLink=t,t.getViewNode().setStyle("font-size","15px"),t.addEvent("inputChanged",function(){e._openPageLinkFieldsDialog()})})})},_createCollectionSettingsFields:function(e){e.addButtonField("",e._loc("CollectionSettings"),null,null,"linkRight","60px",void 0,"WAppsEditor2Commands.OpenCollectionSettings",{appInstance:this._appPart.getAppInstance(),typeName:this._appPart.getAppPartDefinition().getType()}).getHtmlElement().setStyle("font-size","15px")},render:function(){if(!this._isList()){var e=W.Editor.getPropertyPanel();e.setLabel(this._loc("ItemSettings")),e.setDescription(this._loc("ItemSettingsDescription"))}this.parent()},_getButtonLabel:function(){return this._isList()?this._loc("EditData"):this._loc("EditItemData")},_isList:function(){return this._appPart.getDataSelector().isListSelector()},_currentIsAppPage:function(){var e=this.resources.W.Preview.getPreviewManagers().Viewer.getCurrentPageNode(),t=e.getLogic().getDataItem();return"AppPage"==t.getType()},_getEligibleFields:function(){var e=this._appPart.getAppPartDefinition().getTypeDef(),t=this._typesHelper.getDisplayableFields(e),i=t.filter(function(e){return this.ALLOWED_PAGE_LINK_FIELD_TYPES.contains(e.type)}.bind(this));return i},_onEnablePageLinks:function(e){var t,i=e.value;if(this._toggleLinkButtons(i),i)this._openPageLinkFieldsDialog(["title"]);else{var n=this._viewDef.getValue(),a=this._viewBuilder.getPageLinkFields(n);for(t=0;a.length>t;t++){var o=a[t];delete o.comp.pageLink,this._viewDef.setValue(n)}}},_updateAppPageAndLinkFields:function(e){var t=!1;if(e){t=Object.some(e,function(e){return e===!0});var i=this._appPart.getAppPartDefinition().getType(),n=this._appPart.getAppInstance().getPages().getPageDefByType(i);n?this._linkFieldsToPage(e,n.getId()):t&&this._createAppPage(function(t){this._linkFieldsToPage(e,t)}.bind(this)),this._enablePanelControls(t)}else this._enablePanelControls()},_createAppPage:function(e){var t=this._appPart._data.get("appInnerID"),i=this._appPart.getAppPartDefinition().getType(),n=this._appPart.getAppInstance().getTypesManager().getType(i),a=n.displayName;W.Commands.executeCommand("WAppsEditor2Commands.CreateAppPage",{appInnerID:t,pageName:a,appPart:this._appPart,onPageCreated:e})},_linkFieldsToPage:function(e,t){var i=this._viewDef.getValue();Object.each(e,function(e,n){var a=this._viewBuilder.getViewFieldByTypeField(i,n);e?a.comp.pageLink=t:delete a.comp.pageLink}.bind(this)),this._viewDef.setValue(i)},_openPageLinkFieldsDialog:function(e){var t=this.resources.W.Utils.getPositionRelativeToWindow(this._enableDeepLinkingChkBox.getViewNode()),i="";this.resources.W.AppsEditor2.openContextDialog(400,400,"wixapps.intergration.components.editor.dialogs.PageLinkFieldsDialog","wysiwyg.editor.skins.panels.base.AutoPanelSkin",this._loc("SetLinkToPage"),{left:t.x,top:t.y+50},this._previewComponent,this._updateAppPageAndLinkFields,this._updateAppPageAndLinkFields,i,{suggestedFields:e||[],eligibleFields:this._getEligibleFields()})},_enablePanelControls:function(e){if(!this._enableDeepLinkingChkBox)return this.callLater(this._enablePanelControls,[],this),void 0;if(!e){var t=this._viewBuilder.getPageLinkFields(this._viewDef.getValue());e=t.length>0}this._enableDeepLinkingChkBox.setChecked(e),this._toggleLinkButtons(e)},_toggleLinkButtons:function(e){return this._enableDeepLinkingChkBox&&this._editPageTemplateBtn&&this._setLinkToPageLink?(void 0===e&&(e=this._enableDeepLinkingChkBox.getViewNode().checked),e?(this._editPageTemplateBtn.uncollapse(),this._setLinkToPageLink.uncollapse()):(this._editPageTemplateBtn.collapse(),this._setLinkToPageLink.collapse()),void 0):(this.callLater(this._toggleLinkButtons,[e],this),void 0)},_onEditPageTemplate:function(){var e=this._appPart.getAppPartDefinition().getType(),t=this._appPart.getAppInstance();this.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:e,appInstance:t})},_createListNameHelpTooltip:function(){var e=this.resources.W.Data.getDataByQuery("#TOOLTIPS.toolTips"),t=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId("list_name_tooltip");return e.set(t,{isMoreLess:!1,isDontShowAgain:!1,content:"<p>"+this._loc("ListNameHelpTooltip")+"</p>",isPublished:!0,help:{isMoreHelp:!1,text:null,url:""}}),t},_trimListNameValue:function(e){return e.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},_validateListName:function(e){var t=this._appPart.getAppInstance(),i=t.getAppPartDefinitions(),n=i.toObject(),a=this._appPart.getAppPartDefinition();if(e=this._trimListNameValue(e),0===e.length)return this._loc("ListNameExistsErrorMessage");if(e.test(/[^A-Za-z0-9 ]/g))return this._loc("ListNameExistsErrorMessage");var o=!1;for(var s in n)if(n.hasOwnProperty(s)&&s!==a.getId()&&n[s].displayName===e){o=!0;break}return o?this._loc("ListNameExistsErrorMessage"):""},_submitListName:function(){var e=this._listNameInput.getValue(),t=this._appPart.getAppPartDefinition();t.setDisplayName(e),this._updateListNameInputState()},_preSubmitListName:function(e,t){var i=this._listNameInput.getValue();i=this._trimListNameValue(i),this._listNameInput.setValue(i),t(e)},_addListNameInput:function(e,t){return e._addField("wysiwyg.editor.components.inputs.SubmitInput","wixapps.integration.skins.inputs.SubmitInputMessageAboveButtonSkin",{labelText:this._loc("ListName"),placeholderText:"",minLength:void 0,maxLength:void 0,validatorArgs:{validators:[this._validateListName],validationOkCallback:this._submitListName},buttonLabel:this._loc("SubmitListName"),iconSrc:void 0,preSubmitFunction:this._preSubmitListName,toolTip:{toolTipId:t,addQuestionMark:!0}})},_updateListNameInputState:function(){var e=this._listNameInput.getSkinPart("button"),t=this._listNameInput.getValue(),i=this._appPart.getAppPartDefinition().getDisplayName();t===i?(e.disable(),e.getViewNode().setStyle("cursor","default")):(e.enable(),e.getViewNode().setStyle("cursor","pointer"))},_createListNameFrame:function(e){if(!this._appPart.getDataSelector().isPageBased()){var t=this,i=this._createListNameHelpTooltip();e.addInputGroupField(function(){var e=t._addListNameInput(this,i);e.setValue(t._appPart.getAppPartDefinition().getDisplayName()),e.runWhenReady(function(e){t._listNameInput=e,t._updateListNameInputState();var i=t._listNameInput.getSkinPart("input");i.addEvent(Constants.CoreEvents.KEY_UP,function(){t._updateListNameInputState()})})})}}})}),define.experiment.component("wixapps.integration.components.panels.ProxyStylePanel.StylePerComponent.New",function(e,t){var i=e,n=t;i.methods({setEditedComponent:n.remove(),_createFields:function(){this._originalStyle=this._editedComponent.getStyle().getId(),this._currentlySelectedStyle=this._originalStyle,this._buildStyleButtons()}})}),define.experiment.Class("wixapps.integration.components.traits.FppMetaDataBuilderTrait2.AppBuilderPage.New",function(e){var t=e;t.methods({_getListTitle:function(e){var t=e.getAppPartDefinition();return t.getDisplayName()}})}),define.experiment.Class("wixapps.integration.components.traits.ResizableProxyTrait.AutoResizeEvent.New",function(e){var t=e;t.statics({COMPONENT_AUTO_RESIZE_EVENT:"autoSized"}),t.methods({_handleSizeChange:function(){if(!this.isDisposed()){if(this._isCompBasedWidth()){var e=this._getComponentWidth();this._element.setStyle("width",e),this._innerElement.setStyle("width",e)}if(this._isCompBasedHeight()){var t=this._getComponentHeight();this._element.setStyle("height",t),this._innerElement.setStyle("height",t)}this.fireEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE,{})}}})}),define.experiment.Class("wixapps.integration.gui.CustomizeItemsPresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i,n,a,o){this._appInstance=e,this._typeDef=i,this._viewBuilder=this.resources.W.AppsEditor2.getViewBuilder(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper(),this._dataItemFactory=e.getDataItemFactory(),this._model=this._dataItemFactory.createDataItem([]),this._appPart=n,this._viewDataItem=this._appPart.getViewDefinition(),this._parentUpdateModel=a,this._fieldHighlighter=this.resources.W.AppsEditor2.getFieldHighlighter(),this._dataItemUtils=new this.imports.DataItemUtils,this._settingsPanel=o},_createDataStructure:function(){var e=[],t=this._viewDataItem.getValue(),i=this._viewBuilder.getViewFieldsMapping(t),n=this._addShownContainersAndFields(i,e);this._addHiddenContainer(e),this._addHiddenFields(n,e),this._model.setValue(e)},backToSettings:function(){this._settingsPanel.backToSettings()},onItemMoved:function(e){var t=e.cause.oldIndex,i=e.cause.newIndex;if(t!==i){var n=e.data.getValue(),a=n.slice(0);a.splice(t,0,a.splice(i,1)[0]);var o=n[i],s=o.id,r=o.displayName,l=o.data,p=o.type,d="Hidden"===o.containerId,c=this._viewDataItem.getValue(),h=Object.clone(c),u=this._getContainerByIndex(i,n),m=this._getContainerByIndex(t,a);if(!m||!u)return this._createDataStructure(),void 0;var g=m.data.containerId,_=u.data.containerId;t-=m.indexInList+1,i-=u.indexInList+1,"Hidden"==_?this.resources.W.Commands.executeCommand("WAppsEditor2Commands.HideField",{appPart:this._appPart,fieldId:s}):d?this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AddExtraField",{appPartLogic:this._appPart,typeFieldId:l,fieldTemplateKey:this._viewBuilder.getDefaultTemplateKey(p),fieldDisplayName:r,extraFieldContainerId:_}):(_===g?this._viewBuilder.reorderExtraFields(c,g,t,i):this._viewBuilder.moveField(c,s,_,i),this._viewDataItem.setValue(c),W.UndoRedoManager.startTransaction(),W.Commands.executeCommand("WAppsEditor2Commands.Undo.ViewDefinitionChange",{viewRepo:this._appInstance.getViewDefinitions(),oldValue:h,newValue:c,appPart:this._appPart}),W.UndoRedoManager.endTransaction()),this._createDataStructure()}},_getContainerById:function(e,t){for(var i=0;t.length>i;i++){var n=t[i];if(n.isContainer&&n.containerId==e)return{data:t[i],indexInList:i}}}})}),define.experiment.Class("wixapps.integration.gui.DataEditPresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i,n,a,o,s){this._appPart=e,this._isExpandedFunc=a,this._onExpand=o,this._usedDataSelector=i,this._listCursor=t,this._itemsData=n,this._typeName=this._appPart.getAppPartDefinition().getType(),this._appInstance=this._appPart.getAppInstance(),this._typesManager=this._appInstance.getTypesManager(),this._typeDef=this._typesManager.getType(this._typeName),this._dataItemFactory=this._appInstance.getDataItemFactory(),this._editViewGenerator=new this.imports.EditViewGenerator(this._typesManager),this._settingsPanel=s,this._isInRichTextEditing=!1,this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeStartEditingText",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeStartEditingText",this,this._onBeforeStartEditingText);var r=this.resources.W.Commands.getCommand("WEditorCommands.StopEditingText");r&&r.registerListener(this,this._onStopEditingText);var l={_iid:"NULL_ITEM",_type:this._typeName};this._model=this._dataItemFactory.createDataItem(l),this._typesManager.applyDefaults(this._model),this._model.addEvent(Constants.DataItemEvents.CHANGE,this._onModelChanged)},backToSettings:function(){this._settingsPanel.backToSettings()}})}),define.experiment.Class("wixapps.integration.gui.DataEditPresenter.AppBuilderPage.New",function(e,t){var i=e;i.methods({_updateMetadata:function(){var e=this._model.getChildValue("_iid"),t=this._usedDataSelector.getHiddenItemIds().contains(e),i=this._appPart.getDataSelector().isListSelector()===!1,n=W.AppsEditor2.getTypesHelper().getDisplayableFields(this._typeDef),a=this._isInRichTextEditing,o=this._typeDef.displayName,s=this._model.getChildValue("title")?this._model.getChildValue("title"):this.resources.W.AppsEditor2.localize("DATA_EDIT_PANEL_UntitledItem"),r={hidden:t,noItems:0===this._itemsData.getChildren().length,pagingLabel:this._createPagingLabel(),noFields:0===n.length,expanded:this._isExpandedFunc(),isList:i,noAvailItems:!0,isInRichTextEditing:a,typeFriendlyName:o,itemTitle:s};this._setMetaDataValue(r);var l=this.resources.W.AppsEditor2.getAllItemsOfTypeDataSelector(this._typeName,this._appInstance);l.hasAnyItems(function(e){r.noAvailItems=!e,this._setMetaDataValue(r)}.bind(this))},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)}})}),define.experiment.Class("wixapps.integration.gui.EditViewGenerator.AppBuilderPage.New",function(e,t){var i=e;i.methods({_createEditFieldLabel:function(e){var t=e.displayName||e.name,i=this._idioms.label(t);return i.layout={spacerAfter:5},this._typesHelper.isMandatoryField(e)?this._idioms.hbox([i,{comp:{name:"TooltipIcon",tooltipId:"AppBuilder_TT_Mandatory_Title"},value:{_type:"wix:Image",src:"images/icons/q-mark.png",height:13,width:10,title:""},layout:{spacerBefore:"*",spacerAfter:4}}]):i}})}),define.experiment.Class("wixapps.integration.gui.ManageItemsPresenter.AppBuilderListSettings2.New",function(e){e.utilize(["wixapps.core.utils.PostponeUntilReady"]),e.binds(["onItemMoved","onShowHideItem","onSelectionChanged","_onSharedDataChange","_onPrivateDataChange"]),e.methods({initialize:function(e,t,i,n,a,o,s){this._appPart=e,this._appInstance=e.getAppInstance(),this._typeDef=n,this._typeName=this._typeDef.name,this._itemsData=i,this._appPartDataSelector=t,this._dataItemFactory=this._appInstance.getDataItemFactory(),this._model=this._dataItemFactory.createDataItem([]),this._model.addEvent(Constants.DataItemEvents.CHANGE,this._onPrivateDataChange),this._listCursor=a,this._itemsData.addEvent(Constants.DataItemEvents.CHANGE,this._onSharedDataChange),this._loadSharedData=o,this._openItemFn=s,this._setupAction=new this.imports.PostponeUntilReady},setupPresenter:function(){this._listCursor.hasSelection()||this._listCursor.first(),this._createModel(),this._setupAction.markAsDone()},runWhenReady:function(e){this._setupAction.callWhenDone(e)},_onSharedDataChange:function(){this._ignoreSharedDataChange||this.rebuildModel()},_createModel:function(){for(var e=[],t=this._appPartDataSelector.getHiddenItemIds(),i=this._listCursor.getCurrentItemIndex(),n=this._itemsData.getChildren(),a=this._getTitleFieldName(),o=0;n.length>o;o++){var s=n[o],r=s.getChildValue("_iid"),l=t.contains(r),p={itemId:r,title:null!==a?s.getChildValue(a):this._getNoTitleFieldText(o),hidden:l,iconType:l?"hidden":"arrow",selected:i===o};e.push(p)}this.resources.W.Utils.AppsUtils.deepEquals(this._model.getValue(),e)||this._model.setValue(e)},_onPrivateDataChange:function(e){if(e.action===Constants.DataItemEvents.CHANGE_EVENT_ACTION_MOVE){var t=e.index,i=e.to;W.UndoRedoManager.startTransaction(),this._appPartDataSelector.moveItem(t,i),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.Undo.DataSelectorChange",{changeType:"Move",selector:this._appPartDataSelector,dataItemId:this._appPartDataSelector.getItemIds()[t],newValue:i,oldValue:t,appPart:this._appPart}),W.UndoRedoManager.endTransaction()}},createDataItem:function(){W.Commands.executeCommand("WAppsEditor2Commands.AddNewDataItem",{appPart:this._appPart,onDataItemAdded:function(){this._listCursor.first(),this._loadSharedData()}.bind(this)})},removeDataItem:function(){var e=this._listCursor.getCurrentItemIndex();this._listCursor.removeSelection();var t=this._itemsData.getChildByIndex(e);if(t){var i=t.getChildValue("_iid");this.resources.W.Commands.executeCommand("WAppsEditor2Commands.RemoveDataItem",{appPart:this._appPart,dataItemId:i,onDataItemRemoved:function(){this._loadSharedData()}.bind(this)})}},duplicateDataItem:function(){var e=this._listCursor.getCurrentItemIndex(),t=this._itemsData.getChildByIndex(e),i=t.getValue();delete i._createdAt,delete i._updatedAt,i._iid=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AddNewDataItem",{appPart:this._appPart,rawData:i,onDataItemAdded:function(){this._listCursor.first(),this._loadSharedData()}.bind(this)})},openItem:function(e){var t=e.context.getData().getChildValue("itemId");this._openItemFn(t)},onItemMoved:function(e){var t=e.cause.oldIndex,i=e.cause.newIndex;this._ignoreSharedDataChange=!0;var n=this._itemsData.getRealChildren();n.splice(i,0,n.splice(t,1)[0]),this._itemsData.setChildren(n),this._ignoreSharedDataChange=!1;var a=this._listCursor.getCurrentItemIndex(),o=a;a===t?o=i:(a>t&&o--,o>=i&&o++),a!==o&&this._listCursor.setSelectedIndex(o)},onSelectionChanged:function(e){var t=e.data.getParent().getChildIndex(e.data);0>t||this._listCursor.setSelectedIndex(t)}})}),define.experiment.Class("wixapps.integration.gui.ManageItemsPresenter.AppBuilderPage.New",function(e,t){var i=e;i.methods({_updateMetadata:function(){var e={noItems:0===this._itemsData.getChildren().length,noAvailItems:!1};this._setMetaDataValue(e);var t=this.resources.W.AppsEditor2.getAllItemsOfTypeDataSelector(this._typeName,this._appInstance);t.hasAnyItems(function(t){e.noAvailItems=!t,this._setMetaDataValue(e)}.bind(this))},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)}})}),define.experiment.Class("wixapps.integration.managers.ApplicationInstance.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({initialize:function(e){this._appParts=[],this._appPages=[],this._idInMetasite=e.applicationId,this._appDefinitionId=e.appDefinitionId,this._packageName=e.packageName,this._types=new this.imports.TypesManager,this._funcLibrary=new this.imports.FunctionLibrary,this._dataFactory=new this.imports.DataItemFactory,this._dataFactory.registerFunctionLibrary(this._funcLibrary),this._itemCache=new this.imports.ItemCache(this._dataFactory),this._zoomHandler=new this.imports.ZoomHandler(this),this._localizer=null,"wixapps"==e.type?(this._transport=new this.imports.DataServiceTransport(e.datastoreId,"",""),this._dataService=new this.imports.DataService(this._transport,this._dataFactory,this._itemCache)):"ecommerce"==e.type&&(this._magentoStoreId=e.magentoStoreId),this._customizations=new this.imports.ViewsCustomizer,this._viewDefinitions=new this.imports.ViewDefinitionsRepository(this._dataFactory),this._appVars={},this._appBasePath=null;var t=W.Config.getServiceTopologyProperty("scriptsLocationMap");if(!t||!t.wixapps)throw"wixapps topology path is undefined";this._appBasePath=t.wixapps+"/javascript/wixapps/apps/"+this._packageName+"/",this.resources.W.Data.getDataByQuery("#WIXAPPS_EXTERNAL_APPS",function(e){e.get("items")[this._packageName]&&(this._appBasePath=this.resources.topology[this._packageName])}.bind(this)),this._createdApplicationPages={},this._utils=new this.imports.ApplicationInstanceUtils(this)},_onDescriptorLoaded:function(e){var t,i=e.lang||{};this._localizer=new this.imports.ApplicationLocalizer(i),e=this._localizer.localizeDescriptor(e),this._descriptor=e;var n=Constants.WixAppsSystemTypes;for(t=0;n.length>t;t++)this._types.registerType(n[t]);for(t=0;e.types.length>t;t++)this._types.registerType(e.types[t]);for(this._setApplicationVars(),this._customizations.addRules(e.customizations),this._addDataEditingCustomizations(),t=0;e.views.length>t;t++)for(var a=this._viewDefinitions.cloneAndMultiply(e.views[t]),o=0;a.length>o;o++)this._customizations.fillMissingIds(a[o]),this._customizations.applyAll(a[o]),a[o].appVars={},this._viewDefinitions.setViewDefinition(a[o]);for(t=0;this._appParts.length>t;t++)this._appParts[t].initApp();for(t=0;this._appPages.length>t;t++)this._appPages[t].initApp();W.Viewer&&W.Viewer.isSiteReady()?this._zoomHandler.validateZoomRelatedData():this._callValidateZoomData()},getApplicationVars:function(){return this._appVars},_setApplicationVars:function(){var e=this._descriptor.appVars||{},t=this._getSavedAppVars(),i=t?t.get("items")[0]:{},n=Object.merge(e,i);this._appVars=this._dataFactory.createDataItem(n),this._mirrorAppVarsChange()},_mirrorAppVarsChange:function(){if(this._appVars)for(var e=this,t=this._appVars.getChildrenRefs(),i=0;t.length>i;i++){var n=t[i],a=this._appVars.getChildByRef(n);a.addEvent(Constants.DataItemEvents.CHANGE,function(e,t,i){return function(){var n=e._getAppVarsDataObj();n[t]=i.getValue(0)}}(e,n,a))}},_getSavedAppVars:function(){var e=this.resources.W.Data,t="#appVars_"+this._appDefinitionId;return e.isDataAvailable(t)?e.getDataByQuery(t):null},_getAppVarsDataObj:function(){var e=this.resources.W.Data,t=this._getSavedAppVars();return t||(t=e.addDataItem("appVars_"+this._appDefinitionId,{type:"list",items:[{}]})),t.get("items")[0]}})}),define.experiment.Class("wixapps.integration.managers.ApplicationInstance.WixAppsPage.New",function(e,t){var i=e,n=t;i.resources(n.merge(["W.Pages"])),i.methods({_onDescriptorLoaded:function(e){var t,i=e.lang||{};this._localizer=new this.imports.ApplicationLocalizer(i),e=this._localizer.localizeDescriptor(e),this._descriptor=e;var n=Constants.WixAppsSystemTypes;for(t=0;n.length>t;t++)this._types.registerType(n[t]);for(t=0;e.types.length>t;t++)this._types.registerType(e.types[t]);var a=e.pages,o=this.resources.W.Pages.getPageConfigurationFactory();if(a)for(t=0;a.length>t;t++){var s=a[t];s.pageSettings&&s.pageSettings.pageIcon&&(s.pageSettings.pageIcon=this.resolveResourcePath(s.pageSettings.pageIcon)),o.registerConfig(s.id,{options:s.pageSettings})}for(this._customizations.addRules(e.customizations),this._addDataEditingCustomizations(),t=0;e.views.length>t;t++)for(var r=this._viewDefinitions.cloneAndMultiply(e.views[t]),l=0;r.length>l;l++)this._customizations.fillMissingIds(r[l]),this._customizations.applyAll(r[l]),this._viewDefinitions.setViewDefinition(r[l]);for(t=0;this._appParts.length>t;t++)this._appParts[t].initApp();for(t=0;this._appPages.length>t;t++)this._appPages[t].initApp();W.Viewer&&W.Viewer.isSiteReady()?this._zoomHandler.validateZoomRelatedData():this._callValidateZoomData()}})}),define.experiment.Class("wixapps.integration.managers.LifecycleManager.NBC_WCD.New",function(e){var t=e;t.methods({_waitsForWixification:function(e){return e.$viewProxy.isWixificationPending()},_performCleanup:function(){var e=this._pendingComponents;this._pendingComponents=[];for(var t=0;e.length>t;t++){var i=e[t];this._waitsForWixification(i)&&this._pendingComponents.push(i)}}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPart:function(e,t){var i=e.applicationId;this._applicationPageMgr.openDestinationPageDialogIfNeeded(i,t,function(){this._applicationPageMgr.addApplicationPages(i,function(){var n=e.widgets[t]||{},a={comp:"wixapps.integration.components.AppPart",data:{type:"AppPart",appInnerID:i,appLogicParams:{"wixapps:first-load-after-add-to-stage":{type:"AppPartParam",value:"true"}},appLogicCustomizations:[],appPartName:t,viewName:""},layout:{width:n.defaultWidth||500,height:n.defaultHeight||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},o=e.packageName+"_"+t+"_1",s=W.Commands.getCommand("WEditorCommands.AddComponentFullParams"),r=function(t){var i=t.getAppPartLogic().getDataEditingMetaInfo().hasDataSelection;
i&&(s=W.Commands.getCommand("WAppsEditorCommands.OpenSectionDialog"),s.execute({selectedComp:t}));var n="page/"+this.injects().Preview.getPreviewManagers().Viewer.getCurrentPageId();LOG.reportEvent(wixEvents.APPS_FLOW_APP_ADDED_TO_STAGE,{g1:e.appDefinitionId,c1:n,c2:t.getComponentId()})}.bind(this);s.execute({compDef:a,styleId:o,onCreation:function(e){void 0!==e.getAppPartLogic()?r(e):e.addEvent("logicLoaded",function(){r(e)})}})}.bind(this))}.bind(this))}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.AppBuilderPage.New",function(e,t){var i=e;i.methods({_beforeDeleteItem:function(e,t,i){var n=e.countAppPartOfType(t,!0);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_ITEM_TITLE"),this.localize("CONFIRM_REMOVE_ITEM_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_ITEM_CONFIRM):i()},_beforeDeleteField:function(e,t,i){var n=e.countAppPartOfType(t,!1);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_FIELD_TITLE"),this.localize("CONFIRM_REMOVE_FIELD_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_FIELD_CONFIRM):i()},_onAppBuilderListAdded:function(e){this.openListAddedDialog(e.appPart)}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPartComponent:function(e,t,i,n,a){var o={comp:"wixapps.integration.components.AppPart2",data:{type:"AppBuilderComponent",appInnerID:e,appPartName:i},layout:{width:n.defaultWidth||500,height:n.defaultHeight||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},s="app1",r=this.resources.W.Commands.getCommand("WEditorCommands.AddComponentFullParams");r.execute({compDef:o,styleId:s,onCreation:function(e){for(var t=e.getDataSelector(),i=t.getDataProvider(),n=0;a.length>n;n++){var o=a[n];this._addDataItemChangeEvent(o,i,t,e)}this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AppBuilderListAdded",{appPart:e})}.bind(this)}),this._reportAddPartToBi(t,n,i)}})}),define.experiment.Class("wixapps.integration.managers.WixAppsGUIManager.AppBuilderListSettings2.New",function(e){e.fields({_dialogProfiles:{basicPopup:{width:300,position:"side",level:1,allowScroll:!0,showToolbar:!0,semiModal:!0,allowDrag:!0,buttonSet:["OK"]},basicModalPopup:{width:450,position:"side",level:1,allowScroll:!0,showToolbar:!0,nonModal:!1,allowDrag:!0,buttonSet:[]}}}),e.methods({openDialog:function(e,t,i,n){var a=this.getViewDescriptor(t);a&&this.resource.getResourceValue("W.EditorDialogs",function(o){o._createAndOpenWDialog(t,"wixapps.integration.components.panels.BuilderDialogPanel","mobile.core.skins.InlineSkin",function(t){t.setupPanel(e,a,i)}.bind(this),n,void 0,!0,void 0,!1,!1,!0)}.bind(this))},addViewToPanel:function(e,t,i,n){var a=this.getViewDescriptor(i),o=function(t){t.setState("content"),t.setupPanel(e,a,n)};this.resource.getResourceValue("W.Components",function(e){var i=e.createComponent("wixapps.integration.components.panels.BuilderDialogPanel","wysiwyg.viewer.skins.AppPartSkin","",{},function(){},o),n=t.getSkinPart("content")||t.getSkinPart("inlineContent")||t.getViewNode();n.grab(i)})}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager.EcomRepo.New",function(e,t){var i=e;i.methods({getAppsDeploymentConfig:function(e){this.resource.getResourceValue("WixappsAppsDeploymentEcom",e)}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager.WixAppsPage.New",function(e,t){var i=e,n=t;i.resources(n.merge(["W.Pages"])),i.methods({_initialize:function(){this._appInstanceMap={},this._appDescriptorMap={},this._descriptionCallBacks={},this._logger=new this.imports.WixAppsLogger,this.resources.W.Utils.AppsUtils.getUserRole(function(e){this._userRole=e}.bind(this)),this.registerAppPageConfiguration(),this._loadInstalledApps()},registerAppPageConfiguration:function(){var e=this.resources.W.Pages.getPageConfigurationFactory();e.registerPageType("AppPage",function(e){return"AppPage"===e.appPageType?e.appPageId:e.appPageType})}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager2.WixAppsPage.New",function(e,t){var i=e,n=t;i.utilize(["wixapps.core.apprepo.ApplicationInstance2","wixapps.core.apprepo.AppRepoTransport","wixapps.core.utils.WixAppsLogger","wixapps.core.data.selectors.AllItemsOfTypeDataSelector"]),i.resources(n.merge(["W.Pages"])),i.methods({initialize:n.after(function(){this.registerAppBuilderPageConfiguration()}),registerAppBuilderPageConfiguration:function(){var e=this.resources.W.Pages.getPageConfigurationFactory();e.registerConfig("AppBuilderPage",{options:{canBeDeleted:!0,canBeDuplicated:!1,showSeoSettings:!1,canBeHidden:!1,isHidden:!0,canBeReordered:!0,canHaveChildren:!1,canBeAddedFromMenu:!1,canBeSetAsHomePage:!1,showBasicSettings:!1}})}})}),define.experiment.Class("wixapps.integration.managers.applicationhandlers.ZoomHandler.MobileEcomViews.New",function(e,t){var i=e,n=t;i.resources(n.merge(["W.Config"])),i.methods({_setComponentSize:function(e,t,i,n){var a=this.resources.W.Config.mobileConfig.isMobile(),o=i;e.defaultWidth&&!a&&(o=Math.min(e.defaultWidth,i)),t.setWidth(o),e.defaultHeight&&!a&&t.setHeight(e.defaultHeight),window.requestAnimFrame(function(){t.getMainProxy().updateLayoutWhenReady(function(){t.getEventDispatcher().fireEvent(Constants.WixAppEvents.APP_VIEW_READY),n(t.getViewNode())}.bind(this))}.bind(this))}})}),define.experiment.newClass("wixapps.integration.proxies.DragAndDropVListProxy.AppBuilderListSettings2.New",function(e){e.binds(["_onItemDrag","_onItemEndDrag"]),e.inherits("wixapps.integration.proxies.ListProxy2"),e.methods({createComponent:function(){var e=this.parent();return e.setStyle("position","relative"),this._applyExtraDragStyling(),e},_onChildCreated:function(e,t){if(this.parent(e,t),!t.hasClass("container")){var i=function(t){this._startDragChild(e,this._children.indexOf(e),t)}.bind(this);e.dragEventHandler=i,t.addEvent(Constants.CoreEvents.MOUSE_DOWN,i)}},_onBeforeChildDisposed:function(e){this.parent(e),e.dragEventHandler&&e.getElement().removeEvent(Constants.CoreEvents.MOUSE_DOWN,e.dragEventHandler)},_startDragChild:function(e,t,i){if("INPUT"!=i.target.tagName){this._startIdx=t,this._body=this._body||document.body;var n=i.client.y+window.getScroll().y;this._deltaY=n-e.getElement().getPosition().y,this._lastMouseY=n,this._startedDrag=!1,this._body.addEvent(Constants.CoreEvents.MOUSE_MOVE,this._onItemDrag),this._body.addEvent(Constants.CoreEvents.MOUSE_UP,this._onItemEndDrag),this._body.addClass("blockSelection")}},_doStartDrag:function(){var e=this._children[this._startIdx];this._movedElement=e.getElement(),this._undockMovingItem(),this._startedDrag=!0},_undockMovingItem:function(){var e=this._movedElement.getSize(),t=this._movedElement.getPosition(),i=this._rootElement.getPosition();this._placeholder=new Element("DIV"),this._placeholder.setStyles({width:e.x,height:e.y,backgroundColor:"#FF8F00",border:"1px dashed #544300"}),this._movedContainer=new Element("DIV"),this._movedContainer.setStyles({width:e.x,height:e.y,position:"absolute",top:t.y-i.y-this._deltaY,"border-radius":5,"box-shadow":"rgba(0, 59, 202, 0.6) 0px 0px 5px 5px",opacity:.8}),this._rootElement.insertBefore(this._placeholder,this._movedElement),this._rootElement.grab(this._movedContainer),this._movedContainer.grab(this._movedElement),this._applyExtraDragStyling()},_dockMovingItem:function(){this._rootElement.replaceChild(this._movedElement,this._placeholder),this._placeholder.destroy(),this._placeholder=void 0,this._movedContainer.destroy(),this._movedContainer=void 0,this._applyExtraDragStyling()},_onItemDrag:function(e){this._startedDrag||this._doStartDrag();var t=e.client.y+window.getScroll().y,i=this._rootElement.getPosition(),n=t-i.y-this._deltaY;this._movedContainer.setStyle("top",n);var a=this._lastMouseY>t;this._lastMouseY=t;for(var o=void 0,s=0;this._rootElement.children.length>s;s++){var r=this._rootElement.children[s],l=r.getPosition().y,p=l+r.getSize().y;if(t>=l&&p>t){o=r;break}}o!==this._placeholder&&(0>n&&(o=this._rootElement.firstChild),a?this._rootElement.insertBefore(this._placeholder,o):this._rootElement.insertBefore(this._placeholder,o.nextSibling),this._applyExtraDragStyling())},_applyExtraDragStyling:function(){this._hideShowContainers()},_hideShowContainers:function(){var e=this._rootElement.getElements(".container");Array.each(e,function(e){var t=e.getElement(".container-box"),i=e.getNext();!i||i===this._movedContainer||i&&i.hasClass("container")?(t.removeClass("hidden"),e.setStyle("opacity","0.5")):(t.addClass("hidden"),e.setStyle("opacity","1"))}.bind(this))},_onItemEndDrag:function(){if(this._body.removeEvent(Constants.CoreEvents.MOUSE_MOVE,this._onItemDrag),this._body.removeEvent(Constants.CoreEvents.MOUSE_UP,this._onItemEndDrag),this._body.removeClass("blockSelection"),this._startedDrag){for(var e=-1,t=0;this._rootElement.children.length>t;t++)if(this._rootElement.children[t]===this._placeholder){e=t;break}this._dockMovingItem(),this._startIdx!=e&&(this._children.splice(e,0,this._children.splice(this._startIdx,1)[0]),this._data.moveChildByIndex(this._startIdx,e),this.fireEvent("itemMoved",{oldIndex:this._startIdx,newIndex:e}))}},_registerProxyEvents:function(e,t){this.parent(e,t),"itemMoved"===e&&this.addEvent(e,t)}})}),define.experiment.Class("wixapps.integration.proxies.DraggableListItemProxy.AppBuilderListSettings2.New",function(e){e.methods({_onComponentWixified:function(){this.parent();var e=this._getLayoutRootElement();this.imports.BoxFlexPolyfill.applyBoxFlexPolyfill(e),this._applyBoxStyles(e),this._setupBox(e)}})}),define.experiment.Class("wixapps.integration.proxies.GalleryProxy.WixAppsLayoutFixes.New",function(e){var t=e;t.methods({_createGalleryDisplayer:function(e,t,i,n){var a=this._viewContext.getEnvironment().getProxyFactory(),o=this._viewContext.newContextForData(e);this._addPositionInParentVars(o,t,i.length);var s=a.createProxyFromItemDefinition(o,n).proxy,r=s.createComponent();if(r.setStyles({overflow:"hidden",width:"1px",height:"1px"}),Browser.firefox){var l=new Element("div");l.getViewProxy=function(){return s},l.$viewProxy=s,l.adopt(r),r.setStyles({width:"100%",height:"100%"}),r=l}return r.setStyle("position","absolute"),this._galleryUtils.createMinimalGalleryDisplayer(r,e),r}})}),define.experiment.Class("wixapps.integration.proxies.ImageProxy.AppBuilderLinks.New",function(e){var t=e;t.methods({createComponent:function(){var e=this._createRawData();return this._createWixComponent("wixapps.integration.components.WPhoto",e)}})}),define.experiment.Class("wixapps.integration.proxies.LabelProxy.WixAppsLayoutFixes.New",function(e){var t=e;t.methods({_onComponentWixified:function(){this._viewContext.getEnvironment().getEventsDispatcher().addEvent(Constants.WixAppEvents.APP_PART_RESIZE,this._onAppPartResize),this._onAppPartResize(),window.setTimeout(this._setTooltip.bind(this),100),Browser.firefox&&this._isSingleLine()&&this._element.setStyle("min-width","100%");var e=this._def.getChildValue("noWrap");e===!0||"true"===e?this._element.setStyle("white-space","nowrap"):this._element.setStyle("white-space","normal")}})}),define.experiment.Class("wixapps.integration.proxies.ListProxy2.AppBuilderListSettings2.New",function(e){e.methods({_removeChild:function(e){var t=this._children.splice(e,1);this._onBeforeChildDisposed(t),t[0].dispose(),this._childrenTemplateMap.splice(e,1)},_addChildAndSetup:function(e,t,i){var n=this._addChild(e,t,i);if(n){var a=n.createComponent();this._onChildCreated(n,a),this._insertElementAt(a,t),n.setupProxy()}}})}),define.experiment.Class("wixapps.integration.proxies.ProxyMap.AppBuilderListSettings2.New",function(e){e.utilize(["wixapps.integration.proxies.VerticalLineProxy","wixapps.integration.proxies.HorizontalLineProxy","wixapps.integration.proxies.SwitchProxy","wixapps.integration.proxies.LabelProxy","wixapps.integration.proxies.ClippedParagraphProxy","wixapps.integration.proxies.DateProxy","wixapps.integration.proxies.DateSelectorProxy","wixapps.integration.proxies.TimeSelectorProxy","wixapps.integration.proxies.InlineTextProxy","wixapps.integration.proxies.TextInputProxy","wixapps.integration.proxies.StringArrayInputProxy","wixapps.integration.proxies.InlineTextInputProxy","wixapps.integration.proxies.NumberInputProxy","wixapps.integration.proxies.NumericStepperProxy","wixapps.integration.proxies.RichTextEditorProxy","wixapps.integration.proxies.RichTextEditorInlineProxy","wixapps.integration.proxies.FormattedPriceProxy","wixapps.integration.proxies.ImageProxy","wixapps.integration.proxies.ImageSelectorProxy","wixapps.integration.proxies.ImageInputProxy","wixapps.integration.proxies.VerticalListProxy","wixapps.integration.proxies.FlowListProxy","wixapps.integration.proxies.MultiColumnListProxy","wixapps.integration.proxies.ButtonProxy","wixapps.integration.proxies.Button2Proxy","wixapps.integration.proxies.LinkProxy","wixapps.integration.proxies.LinkSelectorProxy","wixapps.integration.proxies.layout.CssLayoutProxy","wixapps.integration.proxies.layout.BoxLayoutProxy","wixapps.integration.proxies.layout.StackLayoutProxy","wixapps.integration.proxies.layout.FieldProxy","wixapps.integration.proxies.layout.SwitchBoxProxy","wixapps.integration.proxies.layout.OptionalAreaProxy","wixapps.integration.proxies.layout.FieldBoxProxy","wixapps.integration.proxies.layout.TextFieldProxy","wixapps.integration.proxies.layout.DataEditFieldProxy","wixapps.integration.proxies.SpacerProxy","wixapps.integration.proxies.GalleryProxy","wixapps.integration.proxies.SuperFlowProxy","wixapps.integration.proxies.VerticalListEditorProxy","wixapps.integration.proxies.DraggableListItemProxy","wixapps.integration.proxies.TableProxy","wixapps.integration.proxies.OptionsListProxy","wixapps.integration.proxies.OptionListInputProxy","wixapps.integration.proxies.ComboBoxProxy","wixapps.integration.proxies.RadioGroupProxy","wixapps.integration.proxies.CheckBoxGroupProxy","wixapps.integration.proxies.TabMenuProxy","wixapps.integration.proxies.TextAreaProxy","wixapps.integration.proxies.AreaProxy","wixapps.integration.proxies.SliderGalleryProxy","wixapps.integration.proxies.VideoProxy","wixapps.integration.proxies.VideoThumbProxy","wixapps.integration.proxies.ExpanderProxy","wixapps.integration.proxies.IconProxy","wixapps.integration.proxies.VideoSelectorProxy","wixapps.integration.proxies.ExpanderProxy","wixapps.integration.proxies.ToggleProxy","wixapps.integration.proxies.DeckProxy","wixapps.integration.proxies.ContainerProxy","wixapps.integration.proxies.ZoomLinkProxy","wixapps.integration.proxies.AppLinkProxy","wixapps.integration.proxies.layout.ZoomLayoutProxy","wixapps.integration.proxies.layout.FixedRatioLayoutProxy","wixapps.integration.proxies.CheckBoxProxy","wixapps.integration.proxies.CheckBoxViewProxy","wixapps.integration.proxies.GoogleMapProxy","wixapps.integration.proxies.LocationSelectorProxy","wixapps.integration.proxies.EmptyProxy","wixapps.integration.proxies.TagInputProxy","wixapps.integration.proxies.ListProxy2","wixapps.integration.proxies.UnstyledLabelProxy","wixapps.integration.proxies.DragAndDropVListProxy","wixapps.integration.proxies.TooltipIconProxy","wixapps.integration.proxies.HelpProxy","wixapps.integration.proxies.ImageButtonProxy","wixapps.integration.proxies.AudioPlayerProxy","wixapps.integration.proxies.AudioInputProxy"]),e.methods({registerComponentProxies:function(e){e.registerProxy("Label",this.imports.LabelProxy,"String",[{forType:"String",forMode:"view"},{forType:"Number",forMode:"view"},{forType:"wix:RichText",forMode:"view"}]),e.registerProxy("ClippedParagraph",this.imports.ClippedParagraphProxy,"String"),e.registerProxy("Date",this.imports.DateProxy,"wix:Date"),e.registerProxy("DateEdit",this.imports.DateSelectorProxy,"wix:Date"),e.registerProxy("TimeEdit",this.imports.TimeSelectorProxy,"wix:Date"),e.registerProxy("InlineText",this.imports.InlineTextProxy,"String"),e.registerProxy("InlineTextInput",this.imports.InlineTextInputProxy,"String"),e.registerProxy("TextInput",this.imports.TextInputProxy,"String",[{forType:"String",forMode:"edit"}]),e.registerProxy("NumberInput",this.imports.NumberInputProxy,"Number",[{forType:"Number",forMode:"edit"}]),e.registerProxy("NumericStepper",this.imports.NumericStepperProxy,"Number",[{forType:"NumberInRange",forMode:"edit"}]),e.registerProxy("CheckBox",this.imports.CheckBoxProxy,"Boolean",[{forType:"Boolean",forMode:"edit"}]),e.registerProxy("CheckBoxViewProxy",this.imports.CheckBoxViewProxy,"Boolean",[{forType:"Boolean",forMode:"view"}]),e.registerProxy("RichTextEditor",this.imports.RichTextEditorProxy,"wix:RichText"),e.registerProxy("RichTextEditorInline",this.imports.RichTextEditorInlineProxy,"wix:RichText",[{forType:"wix:RichText",forMode:"edit"}]),e.registerProxy("Price",this.imports.FormattedPriceProxy,"Price",[{forType:"Price",forMode:"view"}]),e.registerProxy("Image",this.imports.ImageProxy,"wix:Image",[{forType:"wix:Image",forMode:"view"}]),e.registerProxy("Video",this.imports.VideoProxy,"wix:Video",[{forType:"Video",forMode:"view"},{forType:"wix:Video",forMode:"view"}]),e.registerProxy("VideoSelector",this.imports.VideoSelectorProxy,"wix:Video",[{forType:"Video",forMode:"edit"},{forType:"wix:Video",forMode:"edit"}]),e.registerProxy("VideoThumb",this.imports.VideoThumbProxy,""),e.registerProxy("ImageSelector",this.imports.ImageSelectorProxy,"wix:Image",[{forType:"wix:Image",forMode:"edit"}]),e.registerProxy("ImageInput",this.imports.ImageInputProxy,""),e.registerProxy("VerticalList",this.imports.VerticalListProxy,"Array",[{forType:"Array",forMode:"view"},{forType:"Array",forMode:"edit"}]),e.registerProxy("FlowList",this.imports.FlowListProxy,""),e.registerProxy("MultiColumn",this.imports.MultiColumnListProxy,""),e.registerProxy("VerticalListEditor",this.imports.VerticalListEditorProxy,""),e.registerProxy("DraggableListItem",this.imports.DraggableListItemProxy,""),e.registerProxy("Gallery",this.imports.GalleryProxy,""),e.registerProxy("Box",this.imports.BoxLayoutProxy,""),e.registerProxy("VBox",this.imports.BoxLayoutProxy,""),e.registerProxy("HBox",this.imports.BoxLayoutProxy,""),e.registerProxy("Field",this.imports.FieldProxy,""),e.registerProxy("FieldBox",this.imports.FieldBoxProxy,""),e.registerProxy("TextField",this.imports.TextFieldProxy,""),e.registerProxy("DataEditField",this.imports.DataEditFieldProxy,""),e.registerProxy("Stack",this.imports.StackLayoutProxy,""),e.registerProxy("Css",this.imports.CssLayoutProxy,""),e.registerProxy("VSpacer",this.imports.SpacerProxy,""),e.registerProxy("HSpacer",this.imports.SpacerProxy,""),e.registerProxy("InlineSpacer",this.imports.SpacerProxy,""),e.registerProxy("HorizontalLine",this.imports.HorizontalLineProxy,""),e.registerProxy("VerticalLine",this.imports.VerticalLineProxy,""),e.registerProxy("Switch",this.imports.SwitchProxy,""),e.registerProxy("SwitchBox",this.imports.SwitchBoxProxy,""),e.registerProxy("OptionalArea",this.imports.OptionalAreaProxy,""),e.registerProxy("SuperFlow",this.imports.SuperFlowProxy,""),e.registerProxy("Button",this.imports.ButtonProxy,""),e.registerProxy("Button2",this.imports.Button2Proxy,""),e.registerProxy("Table",this.imports.TableProxy,""),e.registerProxy("Expander",this.imports.ExpanderProxy,""),e.registerProxy("Deck",this.imports.DeckProxy,""),e.registerProxy("TabMenu",this.imports.TabMenuProxy,""),e.registerProxy("Icon",this.imports.IconProxy,""),e.registerProxy("StringArrayInput",this.imports.StringArrayInputProxy,""),e.registerProxy("Toggle",this.imports.ToggleProxy,""),e.registerProxy("AudioPlayer",this.imports.AudioPlayerProxy,""),e.registerProxy("AudioInput",this.imports.AudioInputProxy,""),e.registerProxy("Link",this.imports.LinkProxy,"wix:LinkBase",[{forType:"wix:LinkBase",forMode:"view"}]),e.registerProxy("LinkSelector",this.imports.LinkSelectorProxy,"wix:LinkBase",[{forType:"wix:LinkBase",forMode:"edit"}]),e.registerProxy("OptionsList",this.imports.OptionsListProxy,"OptionsList",[{forType:"OptionsList",forMode:"view"}]),e.registerProxy("OptionsListInput",this.imports.OptionListInputProxy,"OptionsList",[{forType:"ComboOptionsList",forMode:"edit"},{forType:"OptionsList",forMode:"edit"}]),e.registerProxy("ComboBox",this.imports.ComboBoxProxy,"ComboOptionsList",[{forType:"ComboOptionsList",forMode:"view"}]),e.registerProxy("RadioGroup",this.imports.RadioGroupProxy,"ComboOptionsList",[{forType:"ComboOptionsList",forMode:"view"}]),e.registerProxy("CheckBoxGroup",this.imports.CheckBoxGroupProxy,"MultiOptionsList",[{forType:"MultiOptionsList",forMode:"view"}]),e.registerProxy("TextArea",this.imports.TextAreaProxy,"String"),e.registerProxy("Area",this.imports.AreaProxy),e.registerProxy("SliderGallery",this.imports.SliderGalleryProxy,"Array",[{forType:"Array<wix:Image>",forMode:"view"}]),e.registerProxy("Container",this.imports.ContainerProxy,""),e.registerProxy("ZoomLink",this.imports.ZoomLinkProxy,""),e.registerProxy("AppLink",this.imports.AppLinkProxy,""),e.registerProxy("ZoomLayout",this.imports.ZoomLayoutProxy,""),e.registerProxy("FixedRatioLayout",this.imports.FixedRatioLayoutProxy,""),e.registerProxy("GoogleMap",this.imports.GoogleMapProxy,"wix:Location"),e.registerProxy("LocationSelector",this.imports.LocationSelectorProxy,"wix:Location"),e.registerProxy("Empty",this.imports.EmptyProxy,"",[]),e.registerProxy("TagInput",this.imports.TagInputProxy,""),e.registerProxy("DragAndDropVList",this.imports.DragAndDropVListProxy,""),e.registerProxy("List2",this.imports.ListProxy2,"Array",[{forType:"Array",forMode:"view"},{forType:"Array",forMode:"edit"}]),e.registerProxy("UnstyledLabel",this.imports.UnstyledLabelProxy,"String"),e.registerProxy("TooltipIcon",this.imports.TooltipIconProxy,""),e.registerProxy("Help",this.imports.HelpProxy,""),e.registerProxy("ImageButton",this.imports.ImageButtonProxy,"")}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var i=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(i,e,t,this._stylesMap)}.bind(this)),this._componentLogic.addEvent("endEditing",this._onEditingCompleted),this.resources.W.Commands.registerCommandAndListener("WAppsEditorCommands.FinalizeDataItemEditing",this,this._onFinalizeDataItemEditing)},_onFinalizeDataItemEditing:function(){this.resources.W.Commands.executeCommand("WEditorCommands.StopEditingText"),this.resources.W.Commands.unregisterCommand("WAppsEditorCommands.FinalizeDataItemEditing")},dispose:function(){this._componentLogic.removeEvent("endEditing",this._onEditingCompleted),this.parent()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorProxy.RichText2.New",function(e,t){var i=e;i.binds(["_linkIdGenerator","_onPreviewClicked","_onEditingCompleted","_onCKDataChanged"]),i.methods({_createRTEditorComponent:function(){var e=W.Data;W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e);var t=new Element("DIV");t.set("comp","wysiwyg.editor.components.richtext.WRichTextEditor"),t.set("skin","wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin"),t.set("pos",""),this._editorElement=t,this._editorElement.addEvent(Constants.ComponentEvents.WIXIFIED,function(){}.bind(this)),this._editorElement.addEvent(Constants.ComponentEvents.READY,function(){this._editorLogic=t.getLogic(),this._editorLogic.addEvent("richTextEditorReady",function(){this._componentLogic.getSkinPart("frame").setStyle("visibility","hidden")}.bind(this)),this._notifyEditorReady()}.bind(this)),this._componentLogic.getSkinPart("frame").grab(t);var i={isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator,getDataOnCKChange:!0};this._editorElement.wixify(i,this._editorData)},_onPreviewClicked:function(){this._getEditorComponent(function(e){var t=this._element.getWidth(),i=this._def.getChildValue("height"),n=this._data.getChildValue("text");e.addEvent("endEditing",this._onEditingCompleted),e.addEvent("ckDataChanged",this._onCKDataChanged),this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",this,this._onBeforeDataItemChanged),e.startEditing(n,i,t,this._stylesMap)}.bind(this))},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t),this._componentLogic.getSkinPart("frame").setStyle("visibility","inherit"),this._editorLogic.removeEvent("endEditing"),this._editorLogic.removeEvent("ckDataChanged");var i=this.resources.W.Commands.getCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka");i&&i.unregisterListener(this)},_onCKDataChanged:function(e){var t=this._data.getValue();t.text!==e&&(t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t))}})}),define.experiment.Class("wixapps.integration.proxies.ToggleProxy.WixAppsContentResize.New",function(e){e.methods({_onComponentWixified:function(){this._componentLogic.addEvent("wix:toggle",function(e){this.fireEvent("wix:toggle",{state:e.state,toggleGroup:this.getToggleGroup()}),this._viewContext.getEnvironment().getEventsDispatcher().fireEvent(Constants.WixAppEvents.APP_PART_RESIZE)}.bind(this)),this.addEventFilteredByScope(this.getToggleScope(),"wix:toggle",this._handlePeerToggleEvent)}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.AppBuilderListSettings2.New",function(e){e.methods({dispose:function(){this._disposed||(this._isWixificationPending=!1,this._dataItem&&this._dataItem.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onComponentDataChanged),this._children&&this._children.forEach(function(e){this._onBeforeChildDisposed&&this._onBeforeChildDisposed(e),e.dispose()}),this._deactivateResizeMechanism&&this._deactivateResizeMechanism(this._element),this._styleObj&&(this._styleObj.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStyleChangeInternal),this._styleObj.removeEvent(Constants.StyleEvents.SKIN_CHANGED,this._onSkinChange),this._styleObj=null),this._nativeEventHandlers.forEach(function(e){this._element.removeEvent(e.type,e.handler)}.bind(this)),this._nativeEventHandlers=null,this._element.removeEvent("mouseover",this._onHover),this._element.removeEvent("mouseout",this._onHoverOut),this._componentLogic?this._componentLogic.dispose():this._element.destroy(),this._dataItem=null,this._componentLogic=null,this._element=null,this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.NBC_WCD.New",function(e){var t=e;t.methods({_onWixComponentWixifiedInternal:function(e){this._disposed||(this._componentLogic=e,this._updateComponentState(),this._applyAccumulatedPropertyChanges(),this._onComponentWixified(),this._registerStyleChangeHandler(),this._applyAfterWixifiedActions.forEach(function(e){e.apply(this)}.bind(this)),this._applyAfterWixifiedActions=[],this._isWixificationPending=!1)}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.NBC_WCD.New",function(e){var t=e;t.methods({_onWixComponentWixifiedInternal:function(e){this._disposed||(this._componentLogic=e,this._updateComponentState(),this._applyAccumulatedPropertyChanges(),this._onComponentWixified(),this._registerStyleChangeHandler(),this._applyAfterWixifiedActions.forEach(function(e){e.apply(this)}.bind(this)),this._applyAfterWixifiedActions=[],this._componentLogic.addEvent("autoSizeChange",this._onAutoSizeChange))},_onWixComponentReadyInternal:function(e){this._isWixificationPending=!1,this._defferedDataChangeEvent&&this._onDataChanged(this._defferedDataChangeEvent),this._onWixComponentReadyInternalNotifyLifecycle(e)}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.RenderPerf.New",function(e,t){var i=e,n=t;i.methods({_preventReflowCssClass:function(){return"wixAppsInRenderPreventReflow"},_onWixComponentReadyInternalNotifyLifecycle:function(e){setTimeout(function(){this.resetResizingCache&&this.resetResizingCache(),this._lifecycleManager.notifyComponentReady(e)}.bind(this),0)},_createElement:n.around(function(e){var t=e(),i=this._preventReflowCssClass();return i&&t.addClass(i),i&&this._lifecycleManager.performAction(function(){t.removeClass(i)}.bind(this),this._lifecycleManager.ExecutionOrder.Early),t})})}),define.experiment.Class("wixapps.integration.proxies.layout.DataEditFieldProxy.AppBuilderLinks.New",function(e,t){var i=e;i.binds(["_linkClick","_onLinkDialogClosing"]),i.traits(["wixapps.integration.proxies.traits.AppsLinkTrait"]),i.methods({_rewriteDefinition:function(e,t,i,n){if(!t.items||1!==t.items.length)throw"DataEditFieldProxy accepts exactly one child";var a=t.items[0];a.layout=a.layout||{};var o=this._linkPath+"_click",s=this._getLinkData(),r=[],l="",p=W.AppsEditor2.getSelectionHandler()._appPart.getViewDefinition(),d=this._linkPath.replace("links.",""),c=W.AppsEditor2.getViewBuilder().getViewFieldByTypeField(p.getValue(),d),h=c&&c.comp.pageLink;h?r=this._generatePageLinkSelectorContent(a,h,n):s?(r=this._generateLinkSelectorContent(a,o,n),l="bottom"):(r=this._generateAddLinkContent(t,a,o,n),l="top");var u={name:"HBox","box-align":l,items:r,events:{}},m=i.getEnvironment(),g=m.getEventsDispatcher();return g.addEvent(o,this._linkClick),u},_generatePageLinkSelectorContent:function(e,t,i){var n=W.Preview.getPreviewManagers().Viewer.getAppPages()[t],a=n.getDataItem().get("id"),o={id:i+"_linkSelector",comp:{name:"LinkSelector",skin:"wixapps.integration.skins.LinkSelectorSkinII",showDescription:!0,isEditable:!1},value:{_type:"wix:PageLink",pageId:a,linkId:""}},s={id:i+"_selectorWrapper",comp:{name:"VBox",items:[e,o]},layout:{"box-flex":1}};return[s]},_generateLinkSelectorContent:function(e,t,i){var n={id:i+"_addLinkButton",comp:{name:"Icon",css:{cursor:"pointer"},events:{click:{event:t,mode:"remove"}}},value:{_type:"wix:Image",src:"http://images/icons/link_remove.png",height:20,width:20,title:""},layout:{spacerBefore:3,height:27}},a={id:i+"_linkSelector",comp:{name:"LinkSelector",skin:"wixapps.integration.skins.LinkSelectorSkinII",showDescription:!0},data:this._linkPath},o={id:i+"_selectorWrapper",comp:{name:"VBox",items:[e,a]},layout:{"box-flex":1}};return[o,n]},_generateAddLinkContent:function(e,t,i,n){t=Object.merge({},t,{layout:{"box-flex":1}});var a={id:n+"_addLinkButton",comp:{name:"Icon",css:{cursor:"pointer"},events:{click:{event:i,mode:"add"}}},value:{_type:"wix:Image",src:"http://images/icons/link_create.png",height:20,width:20,title:""},layout:{spacerBefore:e["link-top-offset"]}};return a={id:n+"_addLinkButtonSpacing",comp:{name:"VBox",items:[a]},layout:{spacerBefore:3}},[t,a]},_linkClick:function(e){if("add"===e.mode){var t="appbuilderlink",i=this._getLinkData();i=i&&i.getValue?i.getValue():{_type:"wix:LinkBase"},this._openLinkDialog(i,t,this._onLinkDialogClosing)}if("remove"===e.mode){var n=this._viewContext.evaluatePath("links"),a=n.getValue(),o=this._linkPath.split(".").pop();delete a[o],n.setValue(a)}},_onLinkDialogClosing:function(e,t,i,n){var a=this;this.resource.getResources(["W.EditorDialogs"],function(o){if(n.result===o.W.EditorDialogs.DialogButtons.OK){e.copySchemaFieldsFrom(i);var s=a._createAppsLink(e).getValue(),r=a._viewContext.evaluatePath("links"),l=r.getValue(),p=a._linkPath.split(".").pop();t!==Constants.LinkState.NO_LINK&&s._type?l[p]=s:delete l[p],r.setValue(l)}})},dispose:function(){var e=this._linkPath+"_click",t=this._viewContext.getEnvironment(),i=t.getEventsDispatcher();i.removeEvent(e),this.parent()}})}),define.experiment.skin("wixapps.integration.skins.ClippedParagraphSkin.RichTextPresets.New",function(e){var t=e;t.css([" {word-wrap: break-word;}"," ul { list-style-type: disc; padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}"," ol {  list-style-type: decimal;padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}",' ul[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}',' ol[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}'," ul ul {list-style-type: circle; line-height: normal;}"," ol ul {list-style-type: circle; line-height: normal;}"," ol ol ul {list-style-type: square; line-height: normal;}"," ol ul ul {list-style-type: square; line-height: normal;}"," ul ol ul {list-style-type: square; line-height: normal;}"," ul ul ul {list-style-type: square; line-height: normal;}"," li{ color: inherit; font-size: inherit; font-family: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; letter-spacing: normal;}"," p {margin: 0; line-height: normal; letter-spacing: normal;}"," h1 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h2 {margin: 0; line-height: normal; letter-spacing: normal;}"," h3 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h4 {margin: 0; line-height: normal; letter-spacing: normal;}"," h5 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h6 {margin: 0;  line-height: normal; letter-spacing: normal;}"," a { color: inherit}"])
}),define.experiment.skin("wixapps.integration.skins.ToggleSkin.WixAppsLayoutFixes.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.skinParams([{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"BASE_THEME_DIRECTORY"},{id:"sel",type:Constants.SkinParamTypes.OTHER,defaultValue:"-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"}]),t.html('<div skinPart="on" class="label"></div><div skinPart="off"></div>'),t.css(["{ width: 100%; height: 100%; }",'[state="on"] > %off% { display: none;}','[state="off"] > %off% { display: block; padding-top: 3px; cursor: pointer; } ','[state="on"] > %on% { display: block; padding-top: 3px; cursor: pointer; }','[state="off"] > %on% { display: none;}'])}),define.experiment.skin("wixapps.integration.skins.WixAppsButtonSkin.NBC_SiteButton.New",function(e){var t=e;t.inherits("core.managers.skin.BaseSkin2")}),define.experiment.skin("wixapps.integration.skins.dialogs.AppBuilderDataPanelSkin.AppBuilderPage.New",function(e,t){var i=e;i.html('<div skinPart="topBar"><strong skinPart="panelLabel"></strong><div skinPart="titleContent"></div><div skinPart="help" class="help"><span>&nbsp;</span></div><div skinPart="close"><span>&nbsp;</span></div></div><div skinPart="panelDescription"></div><div skinPart="inlineContent"></div>'),i.css(["{background:#f7f7f7; width:[panelWidth]; [$panelBorderRadius] [noShadow]}","[state=expanded] { [$contentAreaShadow] }","%topBar% {width:100%; height:50px; [$topBorderRadius]; border-bottom:1px solid #dddddd; cursor:move; position:relative}","%panelLabel% {display:none;}","%panelDescription% {display:none;}","%close% {position:absolute; top:1px; right:0; height:50px; width:34px; border-left:1px solid #ccc; cursor:pointer; [$closeBorderRadius]}",'%close% span {position:absolute; left:8px; top:14px; width:15px; height:15px; display:block; background:url("[webThemeDir]icons/top-bar-icons.png") 0 0 no-repeat}',"%close%:hover span {background-position:0 -140px}","%.help% {width:35px; height:50px; position:absolute; right:35px; top:1px; cursor:default;}","%.help% span {background:url([webThemeDir]icons/help_sprite.png) no-repeat 0 1px; width:19px; height:18px; position:absolute; right:8px; top:15px; cursor:pointer}","%.help% span:hover { background-position: 0 -16px}","%.help% span:active { background-position: 0 -33px}","%inlineContent% { top:10px; padding:0; }",' .font_6 { font: normal bold normal 16px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }',' .font_7 { font: normal normal normal 13px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }'])}),define.experiment.skin("wixapps.integration.skins.editor.DraggableListItemSkin.AppBuilderListSettings2.New",function(e){e.css(["{cursor:pointer; position:relative; [box] height:34px; line-height:34px; background:#fff url([webThemeDir]button/button-gradient.png) left center repeat-x; border-top:solid 1px #ccc;  border-bottom:solid 1px #ccc; }",':before { content:""; display:block; position:absolute; top:8px; bottom:7px; left:0; width:30px; background:url([webThemeDir]icons/top-bar-icons.png) center -101px no-repeat; }',"%inlineContent% { position:absolute; top:0; bottom:0; left:44px; right:5px; overflow:hidden; }","%inlineContent% span { overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }","%icon% { width:20px; height:34px; position:absolute; top:0; right:10px; bottom:0; }","%inlineContent% .headingGrey18 span { font-size:18px; font-weight:bold; color:#333; }","%inlineContent% .headingGrey18norm span { font-size:18px; font-weight:normal; color:#333; }","%inlineContent% .headingGrey16 span { font-size:16px; font-weight:normal; color:#333; }","%inlineContent% .textItalic14 span{ font-size:13px; font-style:italic; color:#808080; }","%inlineContent% .textItalic16 span{ font-size:16px; font-style:italic; color:#808080; }","%inlineContent% span.typeName { color:#808080; }","[state*=draggable] {padding:6px 0 6px 42px; border-bottom:solid 1px #ccc; border-top:solid 1px #f4f5f5;}",'[state*=draggable] %inlineContent%:before { content:""; position:absolute; left:15px; top:50%; margin-top:-14px; width:13px; height:28px; background:transparent url([webThemeDir]wix_apps/menus_app_sprite.png) -147px -374px no-repeat; }',"[state*=rollover] { border:solid 1px #ccc; [rd]}","[state*=selected] { background:#09f url([webThemeDir]lists/appbuilder_sprite.png) left -60px repeat-x; border-top-color:#333; border-bottom-color:#888;}","[state*=selected] span { color:#fff }",'[state*=selected]:before { content:""; display:block; position:absolute; top:0; bottom:0; left:0; width:30px; background:url([webThemeDir]button/button-gradient.png) left center repeat-x; }','[state*=selected]:after { content:""; display:block; position:absolute; top:0; bottom:0; left:0; width:30px; background:url([webThemeDir]lists/appbuilder_sprite.png) 8px center no-repeat; border-right: solid 1px #017bb5; }',"[state*=dragged] { display:block; width:296px; margin-left:2px; cursor:move; background:[dragColor]; border: solid 1px #09f; [rd] [dragShadow] }","[state*=dragged] span { color:#333; }","[state*=icon-hidden] %icon% { background:url([webThemeDir]lists/appbuilder_sprite.png) -87px center no-repeat;  }","[state*=selected][state*=icon-hidden] %icon% { background-position:-117px center;  }",".debug {}"])}),define.experiment.skin("wixapps.integration.skins.editor.ImageSelectorSkin.NBC_WPhoto.New",function(e){var t=e;t.inherits("core.managers.skin.BaseSkin2"),t.compParts({img:{skin:"skins.core.ImageNewSkin"}})}),define.experiment.skin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichText2.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>')}),define.experiment.skin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({formatBlock:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddStyle"},fontFamily:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFont"},justify:{skin:"wysiwyg.editor.skins.richtext.ToolBarIconsDropDownSkin",styleGroup:"toolbarBtn"},fontSize:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFontSize"},letterSpacing:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},lineHeight:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},bold:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},italic:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},underline:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},removeFormat:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},outdent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},indent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},numberedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bulletedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidiltr:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidirtl:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixLink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixUnlink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},foreColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBtn"}}),t.html('<div class="container"><ul><li class="part drop style" skinPart="formatBlock" ></li><li class="part drop font" skinPart="fontFamily"  ></li><li class="part drop" skinPart="fontSize" ></li><li class="divider"></li><li class="part cols" skinPart="foreColor"  ></li><li class="divider"></li><li class="part" skinPart="bold"></li><li class="part" skinPart="italic"></li><li class="part" skinPart="underline" ></li><li class="divider"></li><li class="part cols justify" skinPart="justify"></li><li class="part" skinPart="removeFormat"></li></ul><ul><li class="part drop size spacing" skinPart="letterSpacing"></li><li class="part drop size lines" skinPart="lineHeight"></li><li class="divider"></li><li class="part" skinPart="outdent"></li><li class="part" skinPart="indent"></li><li class="divider"></li><li class="part" skinPart="numberedlist" ></li><li class="part" skinPart="bulletedlist" ></li><li class="divider"></li><li class="part" skinPart="bidiltr" ></li><li class="part" skinPart="bidirtl" ></li><li class="divider"></li><li class="part" skinPart="wixLink"  ></li><li class="part" skinPart="wixUnlink"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 3px 10px rgba(0,0,0,0.35)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#fff; [shd][rd]}",'%.drag%  {display:none; left :2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/dragdots.png")  no-repeat 50% 50%; [rd] cursor:move;}','%.close% {display:none; right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd]; cursor: pointer; }','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0px;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; }",'li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }',"%formatBlock% {width:80px;}","%fontFamily% {width:100px;}","%fontSize% {width:50px;}","%letterSpacing% {width:106px;}","%lineHeight% {width:106px;}","li.cols {width:40px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url("[tdr]richtext/icons.png") no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px; pointer-events:none;}',"li.spacing:before {background-position:2px -220px}","li.lines:before {background-position:2px -240px}"])}),define.experiment.skin("wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({toolBar:{skin:"wixapps.integration.skins.editor.WixAppsToolBarSkin",styleId:"RTAppBuilderToolBar"}}),t.html('<textarea skinPart="ckArea" ></textarea><div skinPart="toolBar"></div>'),t.css(["{margin:0px; cursor:default; position:absolute; top:0px; bottom:0px; left:0px; right:0px}","%toolBar% {position:fixed; top:350px; left:500px;}"])}),define.experiment.skin("wixapps.integration.skins.editor.WRichTextInlineEditorSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({toolBar:{skin:"wixapps.integration.skins.editor.RichTextInlineToolBarSkin",styleId:"RTInlineAppsToolBar"}}),t.html('<div skinPart="toolBar"></div><div class="bg"><textarea skinPart="ckArea" ></textarea></div>'),t.css(["{margin:5px; cursor:default;}"," .bg { background-color:#fff; }","%toolBar% { }"])}),define.experiment.skin("wixapps.integration.skins.editor.WixAppsToolBarSkin.RichText2.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>')}),define.experiment.skin("wixapps.integration.skins.editor.WixAppsToolBarSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({formatBlock:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddStyle"},fontFamily:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFont"},justify:{skin:"wysiwyg.editor.skins.richtext.ToolBarIconsDropDownSkin",styleGroup:"toolbarBtn"},fontSize:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFontSize"},letterSpacing:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},lineHeight:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},bold:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},italic:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},underline:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},removeFormat:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},outdent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},indent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},numberedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bulletedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidiltr:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidirtl:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixLink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixUnlink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},foreColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBtn"}}),t.html('<div class="container"><ul><li class="part drop style" skinPart="formatBlock" ></li><li class="part drop font" skinPart="fontFamily"  ></li><li class="part drop" skinPart="fontSize" ></li><li class="divider"></li><li class="part cols" skinPart="foreColor"  ></li><li class="divider"></li><li class="part" skinPart="bold"></li><li class="part" skinPart="italic"></li><li class="part" skinPart="underline" ></li><li class="divider"></li><li class="part cols justify" skinPart="justify"></li><li class="part" skinPart="removeFormat"></li></ul><ul><li class="part drop size spacing" skinPart="letterSpacing"></li><li class="part drop size lines" skinPart="lineHeight"></li><li class="divider"></li><li class="part" skinPart="outdent"></li><li class="part" skinPart="indent"></li><li class="divider"></li><li class="part" skinPart="numberedlist" ></li><li class="part" skinPart="bulletedlist" ></li><li class="divider"></li><li class="part" skinPart="bidiltr" ></li><li class="part" skinPart="bidirtl" ></li><li class="divider"></li><li class="part" skinPart="wixLink"  ></li><li class="part" skinPart="wixUnlink"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 3px 10px rgba(0,0,0,0.35)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#fff; [shd][rd]}",'%.drag%  {display: none; left :2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/dragdots.png")  no-repeat 50% 50%; [rd] cursor:move;}','%.close% {right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd]; cursor: pointer; }','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0 20px 0 0;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; }",'li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }',"%formatBlock% {width:80px;}","%fontFamily% {width:100px;}","%fontSize% {width:50px;}","%letterSpacing% {width:106px;}","%lineHeight% {width:106px;}","li.cols {width:40px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url("[tdr]richtext/icons.png") no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px; pointer-events:none;}',"li.spacing:before {background-position:2px -220px}","li.lines:before {background-position:2px -240px}"])}),define.experiment.Class("wixapps.integration.utils.flex.ComputedFlex.WixAppsLayoutFixes.New",function(e){var t=e;t.methods({_updateChildrenStyles:function(){this._updateBox0(),this._isFlexDisplay&&("row"===this._direction?(this._element.removeClass("flex_vbox"),this._element.addClass("flex_hbox")):(this._element.removeClass("flex_hbox"),this._element.addClass("flex_vbox")));var e=this._getChildCss(),t=""===this._alignment||"stretch"===this._alignment;Array.forEach(this._element.children,function(i){i!==this._box0&&i.setStyles&&i.style&&(t&&this._applyCrossAxisStretch(i),i.setStyles(e))}.bind(this))},updateGeometry:function(){var e=this._performGeometryUpdateStep();e&&window.requestAnimFrame(function(){this._performGeometryUpdateStep()}.bind(this))},_performGeometryUpdateStep:function(){this._flexGeometry=this._flexGeometry||new this.imports.FlexGeometry,this._flexGeometry.clear(),this._updateChildrenStyles();var e=this._updateDescendants();this._traverseDescendants(this._element,function(e){e.parentNode&&e.parentNode.$flexPolyfill&&this._flexGeometry.registerNodeFlexInfo(e,e.$flexPolyfill.getFlexValue(),e.parentNode.$flexPolyfill.getDirection())}.bind(this)),this.isAutoHeight()&&e.unshift(this._element),this._flexGeometry.recalculateFlexNodes();var t=e.sort(this._autoHeightChildrenSortFunc);return t.forEach(function(e){e.$flexPolyfill.updateAutoHeight()}),e.length>0&&this._flexGeometry.recalculateFlexNodes(),e.length>0},updateAutoHeight:function(){for(var e=0,t=0;this._element.children.length>t;t++){var i=this._element.children[t],n=i.getSize().y;e=Math.max(e,n)}this._element.style.height=e+"px"},_autoHeightChildrenSortFunc:function(e,t){var i=e.getParents().length,n=t.getParents().length;return n-i}})});