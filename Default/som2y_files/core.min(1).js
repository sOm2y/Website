define.Class("core.utils.BeatStatisticsAndKeepAlive",function(a){var b=a;b.resources["W.Editor"],b.statics({BeatStatisticsAndKeepAliveInstances:[]}),b.fields({beatDefaultPulseTime:900,timeoutTimeMillis:1e3,_JSONPScriptId:"BeatStatisticsAndKeepAliveJSONP",_InstanceId:-1,beatUrl:"http://beat.wix.com/alive/jsonp"}),b.methods({initialize:function(a,b,c,d,e,f,g){if(this.isEmpty(a)||this.isEmpty(b)||this.isEmpty(c))throw"the appId, pageId and siteId are mandatory";"preview"!==window.viewMode&&(this._initialize(a,b,c,d,e,f,g),this._gotResponse=!1,this._timeoutCount=0,this._sendRequestToBeatJSONP())},_initialize:function(a,b,c,d,e,f,g){this._InstanceId=this.BeatStatisticsAndKeepAliveInstances.push(this)-1,this._properties={isKeepAlive:e?e:!1,callback:g},this._requestData={app:a,siteId:b,metaSiteId:f,isTemplate:d?d:0,pageFileName:c,firstTimeInDocPage:!0,etag:this._getEtag()}},_getEtag:function(){return $$("meta[http-equiv=etag]")[0]&&$$("meta[http-equiv=etag]")[0].getAttribute?$$("meta[http-equiv=etag]")[0].getAttribute("content"):null},_addJSONPScriptElement:function(){if(!document.getElementById(this._JSONPScriptId)){var a=document.getElementsByTagName("script")[0],b=document.createElement("script");return b.id=this._JSONPScriptId,b.type="text/javascript",b.async=!0,a.parentNode.insertBefore(b,a),b}},_sendRequestToBeatJSONP:function(){this._gotResponse=!1;var a=this._getRequestUrl(),b=document.getElementById(this._JSONPScriptId);b&&b.parentNode.removeChild(b);var c=this._addJSONPScriptElement();c.src=a},_processJsonResponse:function(a){this._gotResponse=!0,this._timeoutCount=0,this._requestData.firstTimeInDocPage=!1;var b=a&&a.payload&&a.payload.wixBeat?a.payload.wixBeat:this.beatDefaultPulseTime;if(this._properties.isKeepAlive){var c=this;window.setTimeout(function(){c._sendRequestToBeatJSONP()},1e3*b)}this._properties.callback&&this._properties.callback(a)},_timeoutJsonP:function(){if(!this._gotResponse&&this._properties.callback){if(this._properties.callback({errorCode:1,errorDescription:"timeout: there is no response after "+this.timeoutTimeMillis+"millis",success:!1}),this._timeoutCount<2){var a=this;window.setTimeout(function(){a._sendRequestToBeatJSONP()},1e4)}this._timeoutCount++}},_getRequestUrl:function(){var a=this.beatUrl+"?";for(var b in this._requestData)a+=b+"="+this._requestData[b]+"&";return a=a.slice(0,-1)},isEmpty:function(a){return void 0===a||null===a}})}),define.utils("ColorValidations:this",function(){return{isValidColor:function(a){return instanceOf(a,String)&&(0===a.indexOf("#")&&(4===a.length||7===a.length)&&!isNaN(a.replace("#","0x"))||Constants.CSS.COLORS.contains(a.toLowerCase()))}}}),define.utils("CoreDebug:this",function(){return{errorPopup:function(a,b,c){W.EditorDialogs&&(W.Config.isInDebugMode()?W.EditorDialogs.openErrorDialog(a,b,c):W.EditorDialogs.openErrorDialog(a,b))},debugTrace:function(){W.Config.isInDebugMode()&&window.console&&(console.log.apply?console.log.apply(console,arguments):console.log(arguments))}}}),define.utils("linkUtils",function(){var a={linkType:{SMS:"SMS",CALL:"CALL",SKYPE:"SKYPE",MAP:"MAP",EMAIL:"EMAIL",FACEBOOK:"FACEBOOK",FLICKR:"FLICKR",BLOGGER:"BLOGGER",MYSPACE:"MYSPACE",LINKEDIN:"LINKEDIN",TWITTER:"TWITTER",TUMBLR:"TUMBLR",YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",PAGE:"PAGE",FREE_LINK:"FREE_LINK",TEXT:"TEXT",DELICIOUS:"DELICIOUS",WEBSITE:"WEBSITE",DOCUMENT:"DOCUMENT",LOGIN:"LOGIN"},linkTarget:{SAME_WINDOW:"_self",NEW_WINDOW:"_blank"}};return{linkify:function(a,b,c,d){b&&(c&&""!==c?(b.set("href",c),b.setStyle("cursor","pointer"),this._setTarget(b,d),this.hasState("noLink","linkableComponent")&&this.removeState("noLink","linkableComponent")):(b.setStyle("cursor","default"),b.erase("href"),b.erase("target"),this.hasState("noLink","linkableComponent")&&this.setState("noLink","linkableComponent")),this._handleSpecialCases(a,b))},renderLinks:function(a,b){var c=a.getData(),d=c.href,e=c.target,f=c.linkType,g=b?b:this._skinParts.link;if(("same"===e||"self"===e)&&(e="_self",a.set("target","_self")),W.Experiments&&W.Experiments._runningExperiments&&"new"===W.Experiments._runningExperiments.linkutilshreffix){if("PAGE"===f&&!d.indexOf("#!")){var h=new RegExp(/[/].*/);this._pageId=d.match(h)[0].replace("/","#"),W.Data.getDataByQuery(this._pageId,function(a){var b="#!"+a.getData().pageUriSEO+"/"+this._pageId;W.Utils.linkUtils.linkify.call(this,f,g,b,e)}.bind(this))}}else W.Utils.linkUtils.linkify.call(this,f,g,d,e);this._NO_LINK_PROPAGATION&&W.Utils.linkUtils.disableLinkClickPropagation(g)},disableLinkClickPropagation:function(a){a.addEvent("click",function(a){a.stopPropagation()})},_setTarget:function(a,b){a.set("target",b)},_bindPageLeaveWarningToLink:function(a,b){b.erase("href"),b.erase("target"),b.addEvent("click",function(b){b.preventDefault(),this._showNavigationDisabledTooltip(a)}.bind(this))},_showNavigationDisabledTooltip:function(a){this.injects().Commands.executeCommand("linkableComponent.navigateSameWindow",{component:a},a)},linkableComponentEditModeChanged:function(b,c,d){if(!this._isDisposed){var e=d?d:this._skinParts.link,f=!1,g=!1,h=this.getDataItem?this.getDataItem():c,i=h.get("linkType"),j=h.get("target"),k=a.linkTarget.SAME_WINDOW,l=a.linkType.WEBSITE,m=a.linkType.EMAIL;j===k&&i===l&&(f=!0),i===m&&(g=!0),"PREVIEW"==b?f?this._bindPageLeaveWarningToLink(e):g&&(this._bindMailtoLinks(e),this.renderLinks(c)):(e.removeEvents("click"),this.renderLinks(c))}},_bindMailtoLinks:function(a){a=this._skinParts.link,a.addEvent("click",this._temporaryDisableNavigationWarning)},_temporaryDisableNavigationWarning:function(){window.enableNavigationConfirmation=!1,setTimeout(function(){window.enableNavigationConfirmation=!0},50)},_handleSpecialCases:function(b,c){switch(c.removeEvents("click"),b){case a.linkType.LOGIN:c.addEvent("click",function(){if(window.animateForm){var a=this.getDataItem(),b=a.get("text");if(b){b=JSON.parse(b);var c=b.postLoginUrl,d=b.postSignupUrl,e=b.type,f="HTML",g=window.userApi?window.userApi.isSessionValid():!1;g?c&&(window.location.href=c):window.animateForm.callOnContent([d,c,e,f])}}}.bind(this));break;case a.linkType.ADMIN_LOGIN:c.setStyle("cursor","pointer"),c.addEvent("click",function(){this.injects().Commands.executeCommand("WViewerCommands.AdminLogin.Open")}.bind(this))}}}}),define.Class("core.utils.css.Background",function(a){var b=a;b.utilize(["core.utils.css.Color"]),b.methods({initialize:function(a,b){if(this.setThemeManager(b),a){a.getThemeString&&(a=a.getThemeString());var c=a.split(" ").filter(function(a){return!!a});if(1===c.length){var d="^#[\\dA-Fa-f]{3,8}$",e="^rgba?\\([\\d,]+\\)$",f="^[\\[\\{][\\w\\d_]+[\\]\\}]$",g=new RegExp(d+"|"+e+"|"+f),h=c[0];"none"==h?c=["none",0,0,"center","center","auto","repeat","repeat","scroll","none"]:h.test(g)&&(c=["none",0,0,"center","center","auto","repeat","repeat","scroll",h])}this.set.apply(this,c)}},setThemeManager:function(a){this._themeManager=a},set:function(a,b,c,d,e,f,g,h,i,j){this._setColor(j),this.setImage(a,b,c),this.setRepeat(g,h),this.setAttachment(i),this.setPosition(d,e),this.setWidth(f)},setWidth:function(a){var b=parseInt(a,10),c=Constants.Background.VALID_WIDTH;this._width=c.contains(a)||!isNaN(b)?a:this._width||c[0]},setPosition:function(a,b){if("undefined"==typeof b){var c=a.split(" ");2===c.length&&(a=c[0],b=c[1])}var d=Constants.Background.VALID_POSITION_X,e=Constants.Background.VALID_POSITION_Y;this._x=d.contains(a)?a:this._x||d[0],this._y=e.contains(b)?b:this._y||e[0]},setAttachment:function(a){var b=Constants.Background.VALID_ATTACHMENT;this._attachment=b.contains(a)?a:this._attachment||b[0]},setColorReference:function(a){this._colorSource="theme",this._colorName=a,this._color=new this.imports.Color(this._themeManager&&this._themeManager.getProperty(a))},setColor:function(a){("transparent"==a||"none"==a)&&(a="0,0,0,0"),this._colorSource="value",this._colorName="",this._color=new this.imports.Color(a)},_setColor:function(a){var b="",c=a&&(a.test(/\{.+\}/)||a.test(/\[.+\]/));a&&c?(b=c&&a.substring(1,a.length-1)||a,this.setColorReference(b)):this.setColor(a)},setImage:function(a,b,c){this._imageId=a||"none",this._imageW=b||0,this._imageH=c||0},setPyramidSize:function(a){this._pyramid=a},setRepeat:function(a,b){if("undefined"==typeof b){var c=a.split(" ");switch(c.length){case 1:b=a;break;case 2:a=c[0],b=c[1]}}var d=Constants.Background.VALID_REPEAT;this._repeatX=d.contains(a)?a:this._repeatX||d[0],this._repeatY=d.contains(b)?b:this._repeatY||d[0]},getCssValue:function(a){var b=a?"background:":"";return this.getImageId()&&(b+=[this.getUrl(),this.getPosition(),this.getRepeatUnified(),this.getAttachment()].join(" ")+" "),b+=this.getColor()},getCssSizeValue:function(a){return this.getWidth(a)},getCssRule:function(a){var b=this.getCssValue(!0);return a&&(b+=";"+this.getCssSizeValue(!0)),b},getCssRules:function(){return[this.getUrl(!0),this.getPosition(!0),this.getWidth(!0),this.getRepeat(!0),this.getAttachment(!0),this.getColor(!0)].join(";")},getThemeString:function(){var a="theme"===this._colorSource?"{"+this.getColorReference()+"}":this.getColor();return[this.getImageId(),this.getImageSize()[0],this.getImageSize()[1],this.getPosition(),this.getWidth(),this.getRepeat(),this.getAttachment(),a].join(" ")},getWidth:function(a){var b=a?"background-size:":"";return b+=this._width},getWidthInline:function(a){return Modernizr&&Modernizr.backgroundsize||a?"/"+this.getWidth():""},getPosition:function(a){var b=a?"background-position:":"";return b+=this.getPositionX()+" "+this.getPositionY()},getPositionX:function(a){var b=a?"background-position-x:":"";return b+=this._x},getPositionY:function(a){var b=a?"background-position-y:":"";return b+=this._y},getAttachment:function(a){var b=a?"background-attachment:":"";return b+=this._attachment},getColor:function(a){var b=a?"background-color:":"";return b+=0==this._color.getAlpha()?"transparent":this._color.getHex()},getColorReference:function(){return this._colorName},getUrl:function(a){var b=W.Config.getServiceTopologyProperty("staticMediaUrl")+"/",c=a?"background-image:":"";return c+="none"==this._imageId?this._imageId:"url("+b+this._imageId+this._getPyramidSuffix()+")"},getImageSize:function(){return[this._imageW,this._imageH]},getImageId:function(){return this._imageId||"none"},_getPyramidSuffix:function(){var a,b,c="",d=this._pyramid||Constants.Background.DEFAULT_PYRAMID_SIZE,e=[],f=1;return e[0]=parseInt(this.getImageSize()[0],10),e[1]=parseInt(this.getImageSize()[1],10),f=e[0]/e[1],a=e[0],b=e[1],(e[0]>d||e[1]>d)&&(a=e[0]>=e[1]?d:Math.round(f*d),b=e[1]>=e[0]?d:Math.round(1/f*d)),c="_crp_0_0_"+e[0]+"_"+e[1]+"_"+a+"_"+b+"_crp"},getRepeat:function(a){var b=a?"background-repeat:":"";return b+=this._repeatX+" "+this._repeatY},getRepeatUnified:function(a){var b=a?"background-repeat:":"";return b+=this._repeatX==this._repeatY?"no-repeat"==this._repeatX?"no-repeat":"repeat":"repeat"==this._repeatX?"repeat-x":"repeat-y"},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.BorderRadius",function(a){var b=a;b.methods({initialize:function(a){a=a.getThemeString?a.getThemeString():Array.isArray(a)?a.join(" "):a.toString();var b=a.split(" ").filter(function(a){return!!a});this.set.apply(this,b)},square:function(){this._isLocked=!1;for(var a=0;a<arguments.length;++a)switch(arguments[a].toLowerCase()){case"tr":this._topRightRadius=0;break;case"tl":this._topLeftRadius=0;break;case"br":this._bottomRightRadius=0;break;case"bl":this._bottomLeftRadius=0}return this},set:function(a,b,c,d){this._isLocked=!1,"undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=a,this._isLocked=!0),"undefined"==typeof c&&(c=a),"undefined"==typeof d&&(d=b),this.setTopLeft(a,this._isLocked),this.setTopRight(b,this._isLocked),this.setBottomRight(c,this._isLocked),this.setBottomLeft(d,this._isLocked)},setTopLeft:function(a,b){this._isLocked=!!b;var c=this._seperateSizeFromUnit(a,this._topLeftUnits);this._topLeftRadius=c.size,this._topLeftUnits=c.unit},setTopRight:function(a,b){this._isLocked=!!b;var c=this._seperateSizeFromUnit(a,this._topRightUnits);this._topRightRadius=c.size,this._topRightUnits=c.unit},setBottomRight:function(a,b){this._isLocked=!!b;var c=this._seperateSizeFromUnit(a,this._bottomRightUnits);this._bottomRightRadius=c.size,this._bottomRightUnits=c.unit},setBottomLeft:function(a,b){this._isLocked=!!b;var c=this._seperateSizeFromUnit(a,this._bottomLeftUnits);this._bottomLeftRadius=c.size,this._bottomLeftUnits=c.unit},_seperateSizeFromUnit:function(a,b){a=String(a);var c=parseFloat(a),d=a.split(String(c)).join("");return c=isNaN(c)?0:c,d=Constants.BorderRadius.VALID_UNITS.contains(d)?d:b||Constants.BorderRadius.VALID_UNITS[0],{unit:d,size:c}},getCssValue:function(){return this._isLocked?this.getTopLeft():[this.getTopLeft(),this.getTopRight(),this.getBottomRight(),this.getBottomLeft()].join(" ")},getCssRule:function(){return"border-radius:"+this.getCssValue()},getThemeString:function(){return this.getCssValue()},getTopLeft:function(){return this._topLeftRadius+this._topLeftUnits},getTopRight:function(){return this._topRightRadius+this._topRightUnits},getBottomRight:function(){return this._bottomRightRadius+this._bottomRightUnits},getBottomLeft:function(){return this._bottomLeftRadius+this._bottomLeftUnits},getIsLocked:function(){return this._isLocked},getUnits:function(){return[this._topLeftUnits,this._topRightUnits,this._bottomRightUnits,this._bottomLeftUnits]},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.BoxShadow",function(a){var b=a;b.utilize(["core.utils.css.Color"]),b.methods({initialize:function(a,b){this._shadow=[];var c="",d=!1;a&&"none"!==a&&(c=a),b!==!1&&c&&(d=!0),c.getThemeString&&(c=c.getThemeString()),this._parseShadowString(c||"0 0 0 0 #000000"),this.setToggleOn(d)},setToggleOn:function(a){this._toggleOn=a},setColor:function(a,b){b=b||0,this._shadow[b].color=new this.imports.Color(a)},setBlurRadius:function(a,b){b=b||0,this._shadow[b].blur=this._getSizeFromUnit(a)},setSpreadRadius:function(a,b){b=b||0,this._shadow[b].spread=this._getSizeFromUnit(a)},setOffset:function(a,b,c){b="undefined"!=typeof b?b:a,this.setOffsetX(a,c),this.setOffsetY(b,c)},setOffsetX:function(a,b){b=b||0,this._shadow[b].x=this._getSizeFromUnit(a),this._shadow[b].angle=this._calcAngle(b),this._shadow[b].distance=this._calcDistance(b)},setOffsetY:function(a,b){b=b||0,this._shadow[b].y=this._getSizeFromUnit(a),this._shadow[b].angle=this._calcAngle(b),this._shadow[b].distance=this._calcDistance(b)},setInset:function(a,b){this._shadow[b||0].inset=a?"inset":""},setDistance:function(a,b){b=b||0,this._shadow[b].distance=this._getSizeFromUnit(a),this._shadow[b].x=this._shadow[b].distance*Math.sin(this._shadow[b].angle),this._shadow[b].y=this._shadow[b].distance*Math.cos(this._shadow[b].angle)},setAngle:function(a,b,c){var d=b?Math.PI/180:1;c=c||0,this._shadow[c].angle=a*d||0,this._shadow[c].x=this._shadow[c].distance*Math.sin(this._shadow[c].angle),this._shadow[c].y=this._shadow[c].distance*Math.cos(this._shadow[c].angle)},setUnit:function(a,b){b=b||0,this._shadow[b].unit=Constants.BoxShadow.VALID_UNITS.contains(a)?a:Constants.BoxShadow.VALID_UNITS[0]},getDistance:function(a){return a=a||0,this._shadow[a].distance},getAngle:function(a,b){b=b||0;var c=a?180/Math.PI:1,d=this._modulo(this._shadow[b].angle,2*Math.PI)*c;return a?Math.round(d):d},getColor:function(a){a=a||0;var b=this._shadow[a].color;return Modernizr&&Modernizr.rgba?"rgba("+b.getRgba()+")":b.getHex()},getBlurRadius:function(a){return a=a||0,this._shadow[a].blur},getSpreadRadius:function(a){return a=a||0,this._shadow[a].spread},getOffsetX:function(a){return a=a||0,this._shadow[a].x.toFixed(3)},getOffsetY:function(a){return a=a||0,this._shadow[a].y.toFixed(3)},getInset:function(a){return a=a||0,this._shadow[a].inset},getToggleOn:function(){return this._toggleOn},getThemeString:function(){var a=!0;return this._getCssValueFromShadowObject(a)},getUnit:function(a){return a=a||0,this._shadow[a].unit},getCssValue:function(){return this._toggleOn?this._getCssValueFromShadowObject():""},_calcAngle:function(a){a=a||0;var b={x:this._shadow[a].x,y:this._shadow[a].y},c={x:0,y:0},d={x:c.x,y:c.y-Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y))};return 2*Math.atan2(b.x-d.x,b.y-d.y)},_calcDistance:function(a){a=a||0;var b=this._shadow[a].x||0,c=this._shadow[a].y||0;return Math.sqrt(b*b+c*c)},_getSizeFromUnit:function(a){a=String(a);var b=parseFloat(a);return b=isNaN(b)?0:b},_parseShadowString:function(a){var b,c,d=[],e=0;if("string"==typeof a){if(b=a.trim().replace(/\s*([\(\)\}\s,])\s*/g,"$1").replace(/([\)\}]|#\w{3,6}),/g,"$1, ").replace(/[,;]$/,""),!b)return"";for(d=b.split(", "),e=0;e<d.length;e++)c=d[e].split(" "),"inset"!=c[0]&&c.unshift(""),this._shadow[e]=[],this.setUnit("px",e),this.setInset(c[0],e),this.setOffset(c[1],c[2],e),this.setBlurRadius(c[3],e),this.setSpreadRadius(c.length>5?c[4]:0,e),this.setColor(c.getLast(),e)}},_getCssValueFromShadowObject:function(a){var b,c=[];for(b=0;b<this._shadow.length;b++)a?c.push([this.getInset(b),this.getOffsetX(b),this.getOffsetY(b),this.getBlurRadius(b),this.getSpreadRadius(b),this.getColor(b)].join(" ").trim()):c.push([this.getInset(b),Math.round(this.getOffsetX(b))+this._shadow[b].unit,Math.round(this.getOffsetY(b))+this._shadow[b].unit,Math.round(this.getBlurRadius(b))+this._shadow[b].unit,Math.round(this.getSpreadRadius(b))+this._shadow[b].unit,this.getColor(b)].join(" ").trim());return c.join(",")},_modulo:function(a,b){return(a%b+b)%b},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.Color",function(a){function b(a,b,c){var d,e,f,g,h,i,j,k;return a%=360,0===c?{r:0,g:0,b:0}:(b/=100,c/=100,a/=60,g=Math.floor(a),h=a-g,i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h)),0===g?(d=c,e=k,f=i):1==g?(d=j,e=c,f=i):2==g?(d=i,e=c,f=k):3==g?(d=i,e=j,f=c):4==g?(d=k,e=i,f=c):5==g&&(d=c,e=i,f=j),d=Math.floor(255*d),e=Math.floor(255*e),f=Math.floor(255*f),{r:d,g:e,b:f})}function c(a,b,c){var d,e,f,g,h,i;return a/=255,b/=255,c/=255,d=Math.min(Math.min(a,b),c),e=Math.max(Math.max(a,b),c),d==e?{h:void 0,s:0,l:100*e}:(f=a==d?b-c:b==d?c-a:a-b,g=a==d?3:b==d?5:1,h=Math.floor(60*(g-f/(e-d)))%360,i=Math.floor(100*((e-d)/e)),e=Math.floor(100*e),{h:h,s:i,l:e})}var d=a;d.methods({initialize:function(a,b,c,d){if("number"==typeOf(c)&&"number"==typeOf(b)&&"number"==typeOf(a))this.setRed(a),this.setGreen(b),this.setBlue(c),this.setAlpha(d);else if("string"==typeOf(a))if(0===a.indexOf("#"))this.setHex(a);else{var e=a.replace(/[rgba\(\)]/g,"");this.setRgba(e)}else this._isUpdateDisabled=!0,a=a||{},this.setRed(a.getRed&&"function"==typeOf(a.getRed)?a.getRed():0),this.setGreen(a.getGreen&&"function"==typeOf(a.getGreen)?a.getGreen():0),this.setBlue(a.getBlue&&"function"==typeOf(a.getBlue)?a.getBlue():0),this.setAlpha(a.getAlpha&&"function"==typeOf(a.getAlpha)?a.getAlpha():1),this._isUpdateDisabled=!1,this._updateHsb()},invert:function(){return this.getInvertColor()},saturation:function(a){return this.setSaturation(a*(this._s/100)),this},luminous:function(a){return this.setLuminous(a*(this._l/100)),this},alpha:function(a){return this.setAlpha(a*(this._a/100)),this},maxSaturation:function(a){return this._s>a&&this.setSaturation(a),this},minSaturation:function(a){return this._s<a&&this.setSaturation(a),this},maxLuminous:function(a){return this._l>a&&this.setLuminous(a),this},minLuminous:function(a){return this._l<a&&this.setLuminous(a),this},getHex:function(a){var b="#"+this._formatHexColor(this._r)+this._formatHexColor(this._g)+this._formatHexColor(this._b);return a&&(b+=this._formatHexColor(255*this._a)),b},getRgb:function(){return this._r+","+this._g+","+this._b},getRgba:function(){return this.getRgb()+","+this.getAlpha()},getRed:function(){return this._getValue(this._r,0)},getGreen:function(){return this._getValue(this._g,0)},getBlue:function(){return this._getValue(this._b,0)},getAlpha:function(){return this._getValue(this._a,1,2)},getHue:function(){return this._getValue(this._h,0)},getSaturation:function(){return this._getValue(this._s,100)},getLuminous:function(){return this._getValue(this._l,100)},getInvertColor:function(){return new this.$class([255-this._r,255-this._g,255-this._b].join(","))},_getValue:function(a,b,c){var d=a||0===a?a:b;return 0!==d&&1!==d&&"number"==typeof c&&"number"==typeof d&&(d=d.toFixed(c),d=Number(d)),d},setRed:function(a){this._r=this._validateValue(a,0,255,0),this._updateHsb()},setGreen:function(a){this._g=this._validateValue(a,0,255,0),this._updateHsb()},setBlue:function(a){this._b=this._validateValue(a,0,255,0),this._updateHsb()},setAlpha:function(a){this._a=this._validateValue(a,0,1,1)},setHue:function(a){this._h=this._validateValue(a,0,360,0),this._updateRgb()},setSaturation:function(a){this._s=this._validateValue(a,0,100,100),this._updateRgb()},setLuminous:function(a){this._l=this._validateValue(a,0,100,100),this._updateRgb()},setHex:function(a){"#"==a.charAt(0)&&(a=a.substr(1)),this._isUpdateDisabled=!0,this.setRed(parseInt(a.substr(0,2),16)),this.setGreen(parseInt(a.substr(2,2),16)),this.setBlue(parseInt(a.substr(4,2),16));var b=parseInt(a.substr(6,2),16);isNaN(b)&&this._a||this.setAlpha(0===b?0:b/255),this._isUpdateDisabled=!1,this._updateHsb()},setRgba:function(a){this._isUpdateDisabled=!0;var b=this._formatSplitValue(a,["r","g","b","a"]);this.setRed(b.r),this.setGreen(b.g),this.setBlue(b.b),this.setAlpha(b.a),this._isUpdateDisabled=!1,this._updateHsb()},setHsl:function(a){this._isUpdateDisabled=!0;var b=this._formatSplitValue(a,["h","s","l"]);this.setHue(b.h),this.setSaturation(b.s),this.setLuminous(b.l),this._isUpdateDisabled=!1,this._updateRgb()},_formatSplitValue:function(a,b){var c={};if("string"==typeOf(a)&&(a=a.split(",")),"array"==typeOf(a))for(var d=0;d<b.length;++d)c[b[d]]=a[d];return c},_validateValue:function(a,b,c,d){return a=isNaN(a)?parseFloat(a):a,0!==a&&(a=a||d||b),a=isNaN(a)?a:Number(String(a).trim()),(isNaN(a)||a>c)&&(a=c),b>a&&(a=b),a},_formatHexColor:function(a){for(a=a||"00","number"==typeOf(a)&&(a=Math.round(a),a=a.toString(16));a.length<2;)a="0"+a;return a.toUpperCase()},_updateHsb:function(){if(this._isUpdateDisabled!==!0){var a=c(this._r,this._g,this._b);this._h=a.h||0,this._s=a.s||0,this._l=a.l||0}},_updateRgb:function(){if(this._isUpdateDisabled!==!0){var a=b(this._h,this._s,this._l);this._r=a.r,this._g=a.g,this._b=a.b}},toString:function(){return this.getHex(!1)}})}),define.Class("core.utils.css.Font",function(a){var b=a;b.utilize(["core.utils.css.Color"]),b.methods({initialize:function(a,b){if(this.setThemeManager(b),"string"==typeOf(a))this._parseFontString(a);else{var c=a||{};if(this.setStyle(c.getStyle&&"function"==typeOf(c.getStyle)?c.getStyle():void 0),this.setVariant(c.getVariant&&"function"==typeOf(c.getVariant)?c.getVariant():void 0),this.setWeight(c.getWeight&&"function"==typeOf(c.getWeight)?c.getWeight():void 0),this.setSize(c.getSize&&"function"==typeOf(c.getSize)?c.getSize():void 0),this.setLineHeight(c.getLineHeight&&"function"==typeOf(c.getLineHeight)?c.getLineHeight():void 0),this.setFontFamily(c.getFontFamily&&"function"==typeOf(c.getFontFamily)?c.getFontFamily():void 0),c.getColorReference&&"function"==typeOf(c.getColorReference)&&""!==c.getColorReference())this.setColorReference(c.getColorReference());else{var d=c.getColor&&"function"==typeOf(c.getColor)?c.getColor():"#000000";this.setColor(d)}}},getThemeString:function(){var a="theme"===this._colorSource?"{"+this.getColorReference()+"}":this.getColor();return[this._style,this._variant,this._weight,this.getSize()+"/"+this.getLineHeight(),this.getFontFamilyWithNoSpaces(),a].join(" ")},getCssRule:function(){return["font:",this.getCssValue(),"; color:",this.getColor()].join(" ")},getCssValue:function(){var a=this.getFontFamilyWithFallbacks();return[this._style,this._variant,this._weight,this.getSize()+"/"+this.getLineHeight(),a].join(" ")},getStyle:function(){return this._style},getVariant:function(){return this._variant},getWeight:function(){return this._weight},getSize:function(){return this._fontSize+this._fontUnit},getLineHeight:function(){return this._lineHeightSize+this._lineHeightUnit},getFontFamily:function(){return this._fontFamily},getFontFamilyWithNoSpaces:function(){return this._fontFamily.replace(/\s/g,"+")},getFontFamilyWithFallbacks:function(){return W.Css.getFontFallbacksCss(this._fontFamily)},getColorReference:function(){return this._colorName},getColor:function(){return this._color},_parseFontString:function(a){var b=a.split(" "),c=b[3]?b[3].split("/"):[];this.setStyle(b[0]),this.setVariant(b[1]),this.setWeight(b[2]),this.setSize(c[0]),this.setLineHeight(c[1]),this.setFontFamily(b[4]),this._setColor(b[5])},setThemeManager:function(a){this._themeManager=a},setStyle:function(a){a=Constants.FONT.STYLE.contains(a)?a:Constants.FONT.STYLE[0],this._style=a},setVariant:function(a){a=Constants.FONT.VARIANT.contains(a)?a:Constants.FONT.VARIANT[0],this._variant=a},setWeight:function(a){a=Constants.FONT.WEIGHT.contains(a)?a:Constants.FONT.WEIGHT[0],this._weight=a},setSize:function(a){var b=this._seperateSizeFromUnit(a);this._fontSize=b.size,this._fontUnit=b.unit},setLineHeight:function(a){var b=this._seperateSizeFromUnit(a);this._lineHeightSize=b.size,this._lineHeightUnit=b.unit},setFontFamily:function(a){a=a&&a.replace(/\+/g," ");var b=W.Css.getFontType(a);b||(a=W.Css.getDefaultFont(),b="system"),this._fontFamily=a},setColorReference:function(a){this._colorSource="theme",this._colorName=a,this._color=new this.imports.Color(this._themeManager&&this._themeManager.getProperty(a)).getHex()},setColor:function(a){this._colorSource="value",this._colorName="",this._color=new this.imports.Color(a).getHex()},_setColor:function(a){var b="",c=a&&(a.test(/\{.+\}/)||a.test(/\[.+\]/));a&&c?(b=c&&a.substring(1,a.length-1)||a,this.setColorReference(b)):this.setColor(a)},_seperateSizeFromUnit:function(a){a=String(a);var b=parseFloat(a),c=a.split(String(b)).join("");return b=isNaN(b)?this._getDefaultFontSize():b,c=Constants.FONT.UNITS.contains(c)?c:this._getDefaultFontUnit(),{unit:c,size:b}},_getDefaultFontSize:function(){return this._fontSize?this._fontSize:12},_getDefaultFontUnit:function(){return this._fontUnit?this._fontUnit:Constants.FONT.UNITS[0]},toString:function(){return this.getCssValue()}})}),define.Class("core.utils.css.Size",function(a){var b=a;b.statics({UNITS:["px","%","em"],DEFAULT_AMOUNT_FOR_UNIT:{px:12,"%":100,em:1}}),b.methods({initialize:function(a){if("string"==typeOf(a))this._parseSizeString(a);else{var b=a||{};this.setUnit(b.getUnit&&"function"==typeOf(b.getUnit)?b.getUnit():void 0),this.setAmount(b.getAmount&&"function"==typeOf(b.getAmount)?b.getAmount():void 0)}},multiply:function(a){return this._amount*=a,this},decrease:function(a){return this._amount-=a,this},increase:function(a){return this._amount+=a,this},getThemeString:function(){return this.getCssValue()},getCssRule:function(){return this.getCssValue()},getCssValue:function(){return this._amount+this._unit},getAmount:function(){return this._amount},getUnit:function(){return this._unit},add:function(a){var b=new this.$class(a);this._unit===b.getUnit()&&(this._amount+=b.getAmount())},_parseSizeString:function(a){var b=this._seperateAmountFromUnit(a);this.setAmount(b.amount),this.setUnit(b.unit)},setAmount:function(a){this._amount=a||0===a?a:this._getDefaultAmountForUnit(this._unit)},setUnit:function(a){this._unit=a||this._getDefaultUnit()},_seperateAmountFromUnit:function(a){a=String(a);var b=parseFloat(a),c=a.split(String(b)).join("");return c=this.UNITS.contains(c)?c:this._getDefaultUnit(),b=isNaN(b)?this._getDefaultAmountForUnit(c):b,{unit:c,amount:b}},_getDefaultAmountForUnit:function(a){return this.DEFAULT_AMOUNT_FOR_UNIT[a]||1},_getDefaultUnit:function(){return this._unit?this._unit:this.UNITS[0]},toString:function(){return this.getCssValue()}})}),define.Const("Background",{VALID_WIDTH:["auto","contain","cover"],VALID_POSITION_X:["left","right","center"],VALID_POSITION_Y:["top","bottom","center"],VALID_ATTACHMENT:["scroll","fixed"],VALID_REPEAT:["repeat","no-repeat"],DEFAULT_PYRAMID_SIZE:1920}),define.Const("BorderRadius",{VALID_UNITS:["px","%","em"]}),define.Const("BoxShadow",{VALID_UNITS:["px"]}),define.Const("FONT",{STYLE:["normal","italic"],VARIANT:["normal","small-caps","inherit"],WEIGHT:["normal","bold","bolder","lighter"],UNITS:["px","em","pt","ex","in","cm","mm","pc"]}),define.bootstrapClass("core.utils.Wixify",function(){function a(a,b,c){this._requiredParams={compData:null,compProperties:null,idPrefix:null,logicClass:null,skinClass:null,dataInstance:null,viewNode:null,style:null},this._wixifyDone=!1,this._wixifyCallback=a,this._paramsSet={},this._className=c,this._startTime=(new Date).getTime(),this._wixifyTimeout=b?b:j}var b={getType:function(){return""}},c=function(a){a.viewNode.$logic||(a.logicClass.NEW_BASE_COMP===!0?d(a):f(a))},d=function(a){var c=a.logicClass,d=a.skinClass,f=a.dataInstance,i=a.viewNode,j=a.compProperties,k=a.style||a.compData.innerStyle,l=e(c,i,a.idPrefix,a.compData.argsObject);W.ComponentLifecycle.registerComponent(l),f&&f!==b&&l.setDataItem(f),j&&l.setComponentProperties(j);var m=new d;k&&(g()?m.setParamMapper(k,!!a.style):m.setParamMapper(k)),l.setSkin(m),h(i)},e=function(a,b,c,d){var e=b.getProperty("id")||i(a,c),f=new a(e,b,d);return b.$logic=f,b.getLogic=function(){return f},f},f=function(a){a.dataInstance||(a.dataInstance=b);var c=a.viewNode.getProperty("id")||i(a.logicClass,a.idPrefix),d=new a.logicClass(c,a.viewNode,a.compData.argsObject),e=new a.skinClass;if(g()){var f=a.style||a.compData.innerStyle;f&&(e.applyStyle(f),d.wixifySetStyle(f,!!a._style)),d.wixifySetSkin(e)}else a.compData.innerStyle&&e.applyStyle(a.compData.innerStyle),a.style?d.initSkinAndStyle(e,a.style):d.setSkin(e);var j=d.getAcceptableDataTypes(),k=a.dataInstance.getType();a.compProperties&&d.setComponentProperties(a.compProperties),-1!=j.indexOf(k)?a.dataInstance!==b&&d.setDataItem(a.dataInstance):LOG.reportError(wixErrors.WIXIFY_INVALID_DATA_TYPE,"wrong data type",k,", data type: "+k+", acceptable types: "+j+", component: "+d.className),a.viewNode.$logic=d,a.viewNode.getLogic=function(){return d},h(a.viewNode)},g=function(){return W.Experiments.getOrderedRunningExperiments().some(function(a){return"innerstylesfix"===a.id})},h=function(a){a.fireEvent(Constants.ComponentEvents.WIXIFIED,a.$logic),a.$logic.fireEvent(Constants.ComponentEvents.WIXIFIED,a.$logic),a.trigger&&a.trigger(Constants.ComponentEvents.WIXIFIED,a.$logic),a.$logic.trigger&&a.$logic.trigger(Constants.ComponentEvents.WIXIFIED,a.$logic)},i=function(a,b){b=b?b+"___":"";var c=a.prototype.className,d=c.lastIndexOf(".");return c=d>-1?c.substr(d):c,W.Utils.getUniqueId(b+c)};Element.implement({wixify:function(d,e,f,g,h){var i,j,k,l,m,n,o;i=this.getProperty("comp"),j=this.getProperty("skin"),k=this.getProperty("dataQuery"),l=this.getProperty("propertyQuery"),n={argsObject:d,innerStyle:h},o=this.getProperty("styleId"),!g&&Constants.WixifyTimeOut&&(g=Constants.WixifyTimeOut);var p=new a(c,g,i);if(o)W.Theme.getStyle(o,function(a){p.setParam("style",a),W.Skins.getSkin(a.getSkin(),p.getAsyncSetterFor("skinClass"))},j);else{if(p.setParam("style",void 0),!j)return LOG.reportError(wixErrors.WIXIFY_NO_SKIN,"Element","wixify",i),void 0;W.Skins.getSkin(j,p.getAsyncSetterFor("skinClass"))}if(!i)return LOG.reportError(wixErrors.WIXIFY_NO_COMP,"Element","wixify",i),void 0;if(this.getLogic)return LOG.reportError(wixErrors.WIXIFY_ALREADY_WIXIFIED,"Element","wixify",i),void 0;if(m=this,m.fireEvent("wixifyStarted"),p.setParam("viewNode",m),p.setParam("idPrefix",f),p.setParam("compData",n),e)p.setParam("dataInstance",e);else if(k){var q,r=this.getProperty("dataQuerySource");q=r&&"preview"==r&&W.Editor?W.Preview.getPreviewManagers().Data:W.Data,q.getDataByQuery(k,p.getAsyncSetterFor("dataInstance"))}else p.setParam("dataInstance",b);return l?(this.isTimedOut=!1,this.propQueryTimer=setTimeout(function(){this.isTimedOut=!0,p.setParam("compProperties",void 0)}.bind(this),1e4),W.ComponentData.getDataByQuery(l,function(a){this.isTimedOut||(clearTimeout(this.propQueryTimer),p.getAsyncSetterFor("compProperties")(a))
}.bind(this))):p.setParam("compProperties",void 0),W.Components.getComponent(i,p.getAsyncSetterFor("logicClass")),p.run(),this}}),Elements.implement({wixify:function(a,b){for(var c=this.length-1;c>-1;--c)this[c].wixify(a,b);return this}});var j=2e3;return a.prototype={_timedOut:null,_timeOutId:null,run:function(){this._wixifyDone||(this._timeOutHandler=setTimeout(function(){this._clearTimeout(),this._onWixifyTimeout()}.bind(this),this._wixifyTimeout))},_clearTimeout:function(){clearTimeout(this._timeOutHandler)},setParam:function(a,b){if(!this._requiredParams.hasOwnProperty(a))throw"this wixifier is not waiting for a parameter named "+a;this._requiredParams[a]=b,this._paramsSet[a]=(new Date).getTime()-this._startTime,this._checkIfEverythingIsThere()},getAsyncSetterFor:function(a){return function(b){this.setParam(a,b)}.bind(this)},_checkIfEverythingIsThere:function(){var a=!0;for(var b in this._requiredParams)if(this._requiredParams.hasOwnProperty(b)&&void 0===this._paramsSet[b]){a=!1;break}a&&this._onAllWixifyParamsReady()},_onAllWixifyParamsReady:function(){if(!this._wixifyDone&&(this._wixifyDone=!0,this._clearTimeout(),this._wixifyCallback&&this._wixifyCallback(this._requiredParams),this._timedOut)){var a=(new Date).getTime()-this._startTime;LOG.reportError(wixErrors.WIXIFY_FINISHED_AFTER_TIMEOUT,a,this._timeOutId,a)}},_onWixifyTimeout:function(){this._timedOut=(new Date).getTime()-this._startTime,this._timeOutId="["+this._className+":"+this._timedOut+"]";var a=this._requiredParams,b=this._paramsSet,c=[];for(var d in a)a.hasOwnProperty(d)&&void 0===b[d]&&c.push(d);var e="Time: "+this._wixifyTimeout+". missing: "+c.join(",");W.Utils.debugTrace("Wixify Error",this._className,this._timeOutId,e),1==c.length&&"compProperties"==c[0]&&(LOG.reportError(wixErrors.WIXIFY_TIMEOUT,this._className,this._timeOutId,e),this._onAllWixifyParamsReady())},toString:function(){return"[Wixifier]"}},function(){}}),define.dataSchema("Button",{label:"resourceKey",toggleMode:"boolean",disabled:"boolean",iconSrc:"string",command:"string",commandParameter:"string",action:"string"}),define.dataSchema("Document",{renderModifiers:"object",name:"string",mainPage:"ref",mainPageId:"string",pages:"refList"}),define.dataSchema("FlatTheme",{THEME_DIRECTORY:{type:"themeUrl","default":"base"},BG_DIRECTORY:{type:"themeUrl","default":"base"},CONTACT_DIRECTORY:{type:"themeUrl","default":"base"},NETWORKS_DIRECTORY:{type:"themeUrl","default":"base"},EXTERNAL_LINKS_DIRECTORY:{type:"themeUrl","default":"base"},PAGES_DIRECTORY:{type:"themeUrl","default":"base"},WEB_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},font:{type:"font-family","default":"Arial,sans-serif"},bgId:{type:"imageId","default":"BG_USES_THEME_IMAGE"},bgSize:{type:"size","default":","},bgType:{type:"bgMode","default":"BG_USES_THEME_IMAGE"},siteBgColor:{type:"color","default":"0,0,0,1"},headerTextColor:{type:"color","default":"255,255,255,1"},headerBgColor:{type:"color","default":"0,0,0,0"},textColor:{type:"color","default":"255,255,255,1"},areaBgColor:{type:"color","default":"130,81,13,1"},iconBgColor:{type:"color","default":"255,255,255,1"},borderColor:{type:"color","default":"255,255,255,1"},fontHeader:{type:"font","default":"normal normal bold 2.4em/1.0em [font] {headerTextColor}"},fontTitle:{type:"font","default":"italic normal bold 2.0em/2.0em [font] {siteBgColor}"},fontSubTitle:{type:"font","default":"normal normal bold 1.2em/1.4em [font] {siteBgColor}"},fontButton:{type:"font","default":"normal normal bold 1.4em/2.2em [font] {areaBgColor}"},fontText:{type:"font","default":"normal normal normal 1.1em/1.1em [font] {siteBgColor}"},fontSmallText:{type:"font","default":"normal normal normal 0.5em/0.7em [font] {siteBgColor}"},borderContainer:{type:"border","default":"0.15em solid [borderColor]"},borderThumb:{type:"border","default":"0.15em solid [borderColor]"},borderButton:{type:"border","default":"0.15em solid [borderColor]"},borderIcon:{type:"border","default":"0.15em solid [borderColor]"},radiusContainer:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusThumb:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusButton:{type:"radius","default":"0.6em 0.6em 0.6em 0.6em"},radiusIcon:{type:"radius","default":"0.6em 0.0em 0.0em 0.6em"},padding1:{type:"padding","default":"1em 1em 1em 1em"},padding2:{type:"padding","default":"0.0em 0.5em 0.0em 0.5em"},padding3:{type:"padding","default":"1.0em 0.0em 1.0em 0.0em"},iconSize:{type:"number","default":"3.2"},bulletSize:{type:"number","default":"1.5"},headerSpacing:{type:"number","default":"0em"},componentSpacing:{type:"number","default":"0.45em"},itemSpacing:{type:"number","default":"0.75em"},thumbSpacing:{type:"number","default":"0.23em"},iconSpacing:{type:"number","default":"0.75em"}}),define.dataSchema("Header",{title:"string",imageSize:{type:"string","default":"medium"},image:"ref"}),define.dataSchema("Image",{"extends":"Link",title:"string",uri:"string",description:"string",height:"number",width:"number",borderSize:"string",alt:"string",originalImageDataRef:{type:"ref",description:"Original Image before edit","default":null}}),define.dataSchema("ImageList",{items:"refList"}),define.dataSchema("Link",{linkType:{type:"string","default":"FREE_LINK"},href:"string",text:"string",target:"string",icon:"string"}),define.dataSchema("TextLink",{linkType:{type:"string","default":"FREE_LINK"},href:"string",text:"string",target:"string",icon:"string"}),define.dataSchema("LinkList",{items:"refList",subType:"string"}),define.dataSchema("MediaItem",{componentType:"string",dateCreated:"string",description:"",fileName:"string",fileSize:"number",height:"number",width:"number",iconURL:"string",mediaType:"string",mimeType:"string",originalFileName:"string",sourceURL:null,tags:null,title:"",version:null}),define.dataSchema("MenuItem",{text:"string",refId:"ref",items:"list"}),define.Class("core.datatypes.NavigationTreeDataClass",function(a){var b=a;b.inherits("core.managers.data.DataItemBase"),b.resources(["W.Data"]),b.methods({initialize:function(a,b){var c=a.items,d=[];c&&this._convertRawItemsToMenuItems(c,d),a.items=d,this.parent(a,b)},_convertRawItemsToMenuItems:function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e={refId:d.refId,items:[],type:"MenuItem"},f=this.resources.W.Data.createDataItem(e);b.push(f),d.items&&d.items.length>0&&this._convertRawItemsToMenuItems(d.items,f.get("items"))}},getItems:function(){return this._data.items||(this._data.items=[]),this._data.items},getAllItems:function(){var a=this.getItems(),b=[];return this._collectInternalItems(a,b)},getSubItems:function(a){var b=a.get("items"),c=[];return this._collectInternalItems(b,c)},_collectInternalItems:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];b.push(d),this._collectInternalItems(d.get("items"),b)}return b},getItemByRefId:function(a){var b=this.getItems();return this._getItemFromItemsByRefId(b,a)},_getItemFromItemsByRefId:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.get("refId")==b)return d;if(d.get("items")&&d.get("items").length>0){var e=this._getItemFromItemsByRefId(d.get("items"),b);if(e)return e}}},addItem:function(a,b,c){b?this._addSubItem(a,b,c):"number"==typeof c?this.getItems().splice(c,0,a):this.getItems().push(a)},_addSubItem:function(a,b,c){var d=this.getItemByRefId(b),e=d.get("items");"number"==typeof c?e.splice(c,0,a):e.push(a)},_createNavigationItem:function(a){var b={refId:a,items:[],type:"MenuItem"};return this.resources.W.Data.createDataItem(b)},createAndAddNavigationItem:function(a,b,c){var d=this._createNavigationItem(a),e=this.getItemByRefId(b);this.addItem(d,b,c),this.fireDataChangeEvent({cause:"CREATED_AND_ADDED",parentItem:e,item:d})},deleteNavigationItem:function(a){var b=this.getItemByRefId(a),c=this.getItemParent(b,this),d=c.get("items"),e=b.get("items"),f=d.indexOf(b);if(e)for(var g=0;e.length>0;){var h=e[0];this._moveItem(h,c,f+g),g++}d.erase(b),this.fireDataChangeEvent({cause:"DELETE",item:b})},getItemLevel:function(a,b,c){var d;d=b?b.get("items"):this.getItems(),c||(c=0);for(var e=0;e<d.length;e++){var f=d[e];if(f==a)return c;if(f.get("items")&&f.get("items").length>0){var g=this.getItemLevel(a,f,c+1);if("number"==typeof g)return g}}},moveItemToParentAtIndex:function(a,b,c){this._moveItem(a,b,c),this.fireDataChangeEvent({cause:"MOVE",parentItem:b,item:a,newIndex:c})},_moveItem:function(a,b,c){var d=b?b.get("refId"):null,e=this.getItemParent(a,this),f=e.get("items");this._addBIonMovedPageToBeSubPage(d,e),f.erase(a),this.addItem(a,d,c)},_addBIonMovedPageToBeSubPage:function(a,b){!a||b&&b.get("refId")||LOG.reportEvent(wixEvents.MOVED_PAGE_TO_BE_SUB_PAGE)},getItemParent:function(a,b){b=b||this;for(var c=b.get("items"),d=0;d<c.length;d++){var e=c[d];if(e==a)return b;if(e.get("items")&&e.get("items").length>0){var f=this.getItemParent(a,e);if(f)return f}}},isSubItemByRefId:function(a){var b=this.getItemByRefId(a),c=this.getItemParent(b);return c==this?!1:!0},getItemParentByRedId:function(a){var b=this.getItemByRefId(a);return this.getItemParent(b)},fireDataChangeEvent:function(a){this._dataManager.markDirtyObject(this),this._dataManager.flagDataChange(),this.fireEvent(Constants.DataEvents.DATA_CHANGED,a)},cloneData:function(){var a={},b=[];return a.type=this._dataType,a.metaData=this._data.metaData,a.id="MAIN_MENU",this.cloneItems(this.getItems(),b),a.items=b,a},cloneItems:function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=this.cloneSingleItem(d);b.push(e),d.get("items")&&d.get("items").length>0&&this.cloneItems(d.get("items"),e.items)}},cloneSingleItem:function(a){return{refId:a.get("refId"),items:[]}},isReady:function(){if(this._isReady)return!0;var a=this.getWaitingForReadyList();return this._isReady=a.length>0?!1:!0,this._isReady},getWaitingForReadyList:function(){var a=[],b=this.getAllItems();this.getDataManager();for(var c=0;c<b.length;c++){var d=b[c],e=d.get("refId"),f=this.resources.W.Data.isDataAvailable(e);f||a.push(e)}return a}})}),define.dataSchema("Menu",{dataClassRef:"core.datatypes.NavigationTreeDataClass"}),define.dataSchema("Page",{title:"string",hideTitle:"boolean",icon:"string",windowTitle:"string",descriptionSEO:"string",metaKeywordsSEO:"string",pageTitleSEO:"string",pageUriSEO:"string",hidePage:"boolean",underConstruction:"boolean",tpaApplicationId:"number",pageSecurity:{type:"object","default":{requireLogin:!1,passwordDigest:""}}}),define.dataSchema("RichText",{text:"string",defaultStyle:"string"}),define.dataSchema("RichTextImage",{text:"ref",image:"ref"}),define.dataSchema("Service",{title:"string",description:"string",image:"ref"}),define.dataSchema("ServiceList",{serviceType:"string",items:"refList"}),define.dataSchema("Text",{text:{type:"string","default":"asdf"}}),define.dataSchema("Theme",{properties:"object"}),define.dataSchema("TopLevelStyle",{skin:"string",style:"object",styleType:{type:"string","enum":["system","custom","userDefined"],description:"type of the style, defaults to system style","default":"system"},pageId:{type:"string",description:"for custom styles - id of the page where the component is"},compId:{type:"string",description:"for custom styles - id of the component that has the custom style"},componentClassName:{type:"string",description:"class name of the component type this style applies to"}}),define.dataSchema("TwitterFollow",{accountToFollow:{type:"string","default":"wix"}}),define.dataSchema("TwitterTweet",{defaultText:"string",accountToFollow:"string"}),define.dataSchema("WFlatTheme",{THEME_DIRECTORY:{type:"themeUrl","default":"base"},BG_DIRECTORY:{type:"themeUrl","default":"base"},CONTACT_DIRECTORY:{type:"themeUrl","default":"base"},NETWORKS_DIRECTORY:{type:"themeUrl","default":"base"},EXTERNAL_LINKS_DIRECTORY:{type:"themeUrl","default":"base"},PAGES_DIRECTORY:{type:"themeUrl","default":"base"},WEB_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},BASE_THEME_DIRECTORY:{type:"webThemeUrl","default":"base"},siteBg:{type:"background","default":"none 0 0 center center auto repeat no-repeat fixed {color_2}"},color:{type:"array",itemType:"color",defaultItems:["#000000","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#333333","#666666","#999999","#AAAAAA","#DCDCDC","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},font:{type:"array",itemType:"font",defaultItems:["normal normal normal 24px/1.2em Arial {color_5}","normal normal bold 16px/1.1em Arial {color_5}","italic normal bold 18px/1.1em Lobster {color_5}","normal normal bold 22px/1.1em Arial {color_5}","normal normal bold 20px/1.1em Arial {color_5}","normal normal normal 18px/1.3em Arial {color_5}","normal normal normal 16px/1.2em Arial {color_6}","normal normal normal 14px/1.3em Arial {color_6}","normal normal normal 12px/1.3em Arial {color_6}","normal normal normal 10px/1.3em Arial {color_6}","normal normal normal 8px/1.3em Arial {color_6}"]},border:{type:"array",itemType:"border",defaultItems:["0.15em solid [color_0]","0.15em solid [color_0]","0.15em solid [color_0]"]},padding1:{type:"padding","default":"0 0 0 0"},padding2:{type:"padding","default":"0.0em 0.5em 0.0em 0.5em"},padding3:{type:"padding","default":"1.0em 0.0em 1.0em 0.0em"},iconSize:{type:"number","default":"3.2"},bulletSize:{type:"number","default":"1.5"},headerSpacing:{type:"number","default":"0em"},componentSpacing:{type:"number","default":"0.45em"},itemSpacing:{type:"number","default":"0.75em"},thumbSpacing:{type:"number","default":"0.23em"},iconSpacing:{type:"number","default":"0.75em"}}),define.dataSchema("testType",{}),define.dataSchema("TemplateList",{id:"string",name:"string",previewSource:"string"}),define.dataSchema("PhotoProperties",{imageSize:{type:"string","enum":["small","medium","large"],"default":"medium",description:"size of the image in runtime"}}),define.Class("core.managers.ConfigurationManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["core.managers.configuration.MobileConfigurationManager"]),b.methods({initialize:function(){this.mobileConfig=new this.imports.MobileConfigurationManager},_getEditorModel:function(){return window.editorModel},getEditorModelProperty:function(a){var b=this._getEditorModel();return b&&b[a]},getRendererModelProperty:function(a){return window.rendererModel&&window.rendererModel[a]},getEditedSiteLoadTimeVersion:function(){return this._getEditorModel().siteHeader.version},getLocationMapProperty:function(a){return window.serviceTopology&&window.serviceTopology.scriptsLocationMap&&window.serviceTopology.scriptsLocationMap[a]},getServiceTopologyProperty:function(){return function(a){var b={scriptsRoot:this.getLocationMapProperty("web")+"/",staticSkinUrl:this.getLocationMapProperty("skins")+"/",staticThemeUrl:this.getLocationMapProperty("web")+"/images/mobile/core/themes",staticThemeUrlWeb:this.getLocationMapProperty("skins")+"/images/wysiwyg/core/themes"};return window.serviceTopology&&(b[a]||window.serviceTopology[a])}}(),getImagesUrl:function(){var a=window.serviceTopology&&window.serviceTopology.scriptsLocationMap;return(a.web||a["html-wysiwyg"])+"/images"},getCoreThemesUrl:function(){var a=window.serviceTopology&&window.serviceTopology.scriptsLocationMap;return(a.core||a["html-client-core"])+"/images/core/themes"},getHelpServerUrl:function(){var a=this.getServiceTopologyProperty("helpServer")||"http://help.wixpress.com/support/main/html5";return window.wixEditorLangauge&&"en"!==window.wixEditorLangauge&&(a=a.replace("www",window.wixEditorLangauge)),a},setServiceTopologyProperty:function(a,b){window.serviceTopology[a]=b},getUserPublicUrl:function(){return this.getEditorModelProperty("publicUrl")},getUserDomainListUrl:function(){var a=this.getServiceTopologyProperty("premiumServerUrl");return a+"/wix/api/domainConsole"},getSiteId:function(){return window.siteId},getMetaSiteId:function(){return this.getEditorModelProperty("metaSiteId")||this.getRendererModelProperty("metaSiteId")},isMetaSiteTemplate:function(){return this.getEditorModelProperty("metaSiteTemplate")||!1},siteNeverSavedBefore:function(){return this.getEditorModelProperty("firstSave")},setMetaSiteId:function(a){window.editorModel.metaSiteId=a},userHasFacebookSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_FACEBOOK)},userHasMobileSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_MOBILE)},userHasWebSite:function(){return this._userHasAppType(Constants.WEditManager.SITE_TYPE_WEB)},_userHasAppType:function(a){var b=this.getEditorModelProperty("serviceMappings");if(!b)return!1;for(var c in b)if(b[c].applicationType==a)return!0;return!1},isPremiumUser:function(){var a=this.getEditorModelProperty("metaSiteData");return a&&a.premiumFeatures?a.premiumFeatures.length>0:!1},getCreateMobileSiteLink:function(){var a=this.getServiceTopologyProperty("createMobileUrl"),b=this.getEditorModelProperty("metaSiteData").siteName,c=this.getMetaSiteId(),d=a+b+"?flashSiteId="+c;return d},getCreateFacebookSiteLink:function(){return this._getCreateWysiwygSiteLink(Constants.WEditManager.SITE_TYPE_FACEBOOK)},getCreateWebsiteLink:function(){return this._getCreateWysiwygSiteLink(Constants.WEditManager.SITE_TYPE_WEB)},_getCreateWysiwygSiteLink:function(a){var b=a==Constants.WEditManager.SITE_TYPE_WEB?this.getServiceTopologyProperty("createWebsiteUrl"):this.getServiceTopologyProperty("createFacebookUrl"),c=this.getMetaSiteId(),d=b+"?metasite="+c;return d},isInDebugMode:function(){return"nodebug"!==this.getDebugMode()},isFacebookSite:function(){var a=this.getApplicationType();return a&&"htmlfacebook"===a.toLowerCase()},getDebugMode:function(){return this.isEditorMode()?window.editorModel.mode:window.rendererModel.debugMode},getApplicationType:function(){return window.rendererModel&&window.rendererModel.applicationType||window.siteHeader&&window.siteHeader.applicationType},getDocumentType:function(){return window.siteHeader&&window.siteHeader.documentType},getMediaStaticUrl:function(a){var b=this.getServiceTopologyProperty("staticMediaUrl")+"/";return"ico"==/[^.]+$/.exec(a)[0]&&(b=b.replace("media","ficons")),b},getResourcesStaticUrl:function(){var a=this.getServiceTopologyProperty("resourcesRoot");return a||this.getServiceTopologyProperty("scriptsRoot")+"/resources/wysiwyg/bundles/"},getLanguage:function(){return window.wixEditorLangauge||this.getEditorModelProperty("languageCode")},isReady:function(){return!0},clone:function(a){return this.parent(a)},createPackage:function(){},getCurrentOrigin:function(){var a="http://"+window.location.host;return a},getMetaSiteData:function(){return this.getEditorModelProperty("metaSiteData")},getPremiumFeatures:function(){var a=this.getRendererModelProperty("premiumFeatures");if(!a){var b=this.getMetaSiteData();a=b&&b.premiumFeatures}return a},getRunningExperiments:function(){return this.getEditorModelProperty("runningExperiments")||this.getRendererModelProperty("runningExperiments")},isPublicMode:function(){return!!window.publicModel},isPreviewMode:function(){return!this.isPublicMode()&&!this.isEditorMode()},isEditorMode:function(){return!!window.editorModel}})}),define.Class("core.managers.LinkTypesManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.fields({langFlag:!1,_allTypes:{FACEBOOK:{target:"http://www.facebook.com/wix",text:"Facebook",linkType:["EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},LINKEDIN:{target:"http://www.linkedin.com/wix",text:"LinkedIn",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},TWITTER:{target:"http://www.twitter.com/wix",text:"Twitter",linkType:["EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},CALL:{target:"212.000.0000",text:"Call Me",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"tel:",tip:"call"},SMS:{target:"212.000.0000",text:"Text Me",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"sms:",tip:"text"},EMAIL:{target:"feedback@wix.com",text:"Email",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"mailto:",tip:"send an email to"},MAP:{target:"wix offices new york",text:"Address",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"http://maps.google.com/maps?f=q&source=s_q&hl=en&q=",tip:"open map for address "},BLOGGER:{target:"http://www.blogger.com/wix",text:"Blogger",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},YOUTUBE:{target:"http://www.youtube.com/wix",text:"Youtube",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},FREE_LINK:{target:"http://www.wix.com",text:"Any link",linkType:["CONTACT","EXTERNAL_LINKS","NETWORKS"],protocol:"http://",tip:"navigate to"},FLICKR:{target:"http://www.flickr.com/wix",text:"Flickr",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},SKYPE:{target:"http://www.skype.com/wix",text:"Skype",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},MYSPACE:{target:"http://www.myspace.com/wix",text:"MySpace",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},VIMEO:{target:"http://www.vimeo.com/wix",text:"Vimeo",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"},DELICIOUS:{target:"http://www.delicious.com/wix",text:"Delicious",linkType:["NETWORKS"],protocol:"http://",tip:"navigate to"}}}),b.methods({getLinkTypesByMeta:function(a){var b;if(this.langFlag===!1){for(b in this._allTypes)this._allTypes[b].text=W.Resources.get("EDITOR_LANGUAGE",b+"_TITLE");this.langFlag=!0}var c=[],d={},e=!0;for(b in this._allTypes)c=this._allTypes[b].linkType,c.indexOf(a)>=0&&(d[b]=this._allTypes[b],e=!1);return 1==e&&LOG.reportError(wixErrors.LT_LINK_UNKNOWN,"LinkTypesManager","getLinkTypesByMeta",a+""),d},getNewLink:function(a){this._allTypes[a]||LOG.reportError(wixErrors.LT_INVALID_LINK_TYPE,"LinkTypesManager","getNewLink",a+"");var b=Object.clone(this._allTypes[a]);return b.metaData={isPreset:!0},b.linkType=a,b.type="Link",delete b.tip,delete b.protocol,b},getLinkIcon:function(a){return a.toLowerCase()+".png"},gotoLink:function(a){if(!W.Viewer.isScrollLock()){var b=a.get("linkType"),c=a.get("target");if(W.Viewer.getPreviewMode())W.Viewer.getLinkTipFunc()&&W.Viewer.getLinkTipFunc()(a,this);else{var d=!this._skipForceFlash(c.toLowerCase())&&this._matchCurrentUrl(c.toLowerCase());d&&this.setForceFlashCookie();var e=0===c.toLowerCase().indexOf("https://");e?c=c.replace("https://",""):0===c.toLowerCase().indexOf("http://")&&(c=c.replace("http://",""));var f=this._allTypes[b].protocol;"http://"==f&&e&&(f="https://");var g=f+c;this._changeLocation(g)}}},_changeLocation:function(a){document.location.href=a},showLinkTip:function(a){var b=a.get("linkType"),c=this._allTypes[b].tip+" "+a.get("target");W.Preview.showPreviewTip("Link will",c)},isReady:function(){return!0},clone:function(a){return this.parent(a)},stripUrl:function(a){var b=a.replace(/(\w+:\/\/)*([\w\-_]+\.)*([\w\-_]+\.[\w\-_]+).*/,"$3"),c={com:!0,org:!0,net:!0,edu:!0,gov:!0,mil:!0,info:!0,co:!0,ac:!0},d=b.split("."),e=d[0];return c[e]?a.replace(/(\w+:\/\/)*([\w\-_]+\.)*([\w\-_]+\.[\w\-_]+\.[\w\-_]+).*/,"$3"):b},setForceFlashCookie:function(){var a=new Date;a.setTime(a.getTime());var b=20,c=new Date(a.getTime()+60*1e3*b);document.cookie="forceFlashSite=true;path="+window.location.pathname+";domain=."+this.stripUrl(window.location.hostname)+";expires="+c.toGMTString()},_skipForceFlash:function(a){return window.location.href.toLowerCase()==a},_matchCurrentUrl:function(a){return this.stripUrl(window.location.href.toLowerCase())==this.stripUrl(a)}})}),define.Class("core.managers.configuration.MobileConfigurationManager",function(a){var b=a;b.statics({MOBILE_MAX_WIDTH:600,TABLET_MAX_WIDTH:1100}),b.methods({_getScreenWidth:function(){var a=this.isAppleMobileDevice();return a?screen.width:screen.width/window.devicePixelRatio},isAppleMobileDevice:function(){return/iphone|ipod|ipad/i.test(navigator.userAgent.toLowerCase())},isAndroidMobileDevice:function(){return/android/i.test(navigator.userAgent.toLowerCase())},getMobileScreenWidth:function(){var a=Math.min(screen.width,screen.height);return a},isMobile:function(){if("boolean"==typeof this._isMobile)return this._isMobile;var a=this.getMobileScreenWidth();return this.isAppleMobileDevice()||(a/=window.devicePixelRatio),this._isMobile=a<this.MOBILE_MAX_WIDTH&&this.isTouchScreen(),this._isMobile},isTablet:function(){if("boolean"==typeof this._isTablet)return this._isTablet;var a=this._getScreenWidth();return this._isTablet=a>=this.MOBILE_MAX_WIDTH&&a<this.TABLET_MAX_WIDTH&&this.isTouchScreen(),this._isTablet},isMobileOrTablet:function(){return this.isMobile()||this.isTablet()},isTouchScreen:function(){return this._isTouch=this._isTouch||Modernizr.touch,this._isTouch},isPortrait:function(){return 0===window.orientation||180===window.orientation},getZoom:function(){var a=90===Math.abs(window.orientation)?Math.max(screen.height,screen.width):Math.min(screen.height,screen.width);return a/window.innerWidth}})}),define.Class("core.managers.ResourceManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.resources(["scriptLoader","topology","W.Utils","W.Config","W.Experiments"]),b.fields({_bundleMap:{EDITOR_LANGUAGE:"/resources/editor/bundles/html_editor_",WIXAPPS_LANGUAGE:"/resources/editor/wixapps/wixapps_",WIXAPPS2_LANGUAGE:"/resources/editor/wixapps2/wixapps2_"}}),b.statics({STABLE_LANGUAGES:["en","de","es","fr","it","pl","pt","ru","ja","ko","tr"],EXPERIMENTAL_LANGUAGES:[]}),b.methods({initialize:function(){this.bundles={},this._currentBundle="EDITOR_LANGUAGE",this.langSymbol=this.getLanguageSymbol()},get:function(a,b,c){var d=this.getBundle(a,b);return d?d.hasOwnProperty(b)?d[b]:c?c:"localized item not found: [ "+b+"] in bundle: [ "+a+" ] ":c?c:"bundle wasn't loaded yet: [ "+a+" ] when requesting [ "+b+" ]"},getCur:function(a,b){return this.get(this._currentBundle,a,b)},getBundle:function(a,b){var c=this.bundles[a];return c||LOG.reportError(wixErrors.RESOURCE_MANAGER_BUNDLE_NOT_FOUND,"mobile.editor.managers.ResourceManager","getBundle",[a,b]),c},getUrlForLanguage:function(a,b){b=b||this.langSymbol;var c=this.resources.topology.langs;return c+(this._bundleMap[a]||this._bundleMap.EDITOR_LANGUAGE)+b+".json"},setBundle:function(a,b){this.bundles[a]=b},replacePlaceholders:function(a,b){if("string"!=typeof b)return"";var c=this.getBundle(a,b);return b.replace(/\[.+?\]/g,function(a){var b=a.substring(1,a.length-1),d=c[b];return void 0!==d?d:a})},loadLanguageBundle:function(a,b,c){var d=this.getUrlForLanguage(a),e=this;this.resources.scriptLoader.loadResource({url:d},{onLoad:function(d){e.setBundle(a,d),e.define.resource(a,d),b.call(e,d,a,c)},onFailed:function(f){e.setBundle(a,{}),e.define.resource(a,{}),b.call(e,f,a,c),LOG.reportError(wixErrors.LANGUAGE_PACK_FAILED_TO_LOAD,{c1:a,c2:d,language:c})}})},getLanguageSymbol:function(){var a="en",b=this.resources.W.Utils.getQueryParam("lang"),c=String(b||this.resources.W.Config.getLanguage()||a).toLowerCase();this.resources.W.Config.getRunningExperiments();var d=c.toLowerCase(),e="lang_"+d;return(this.STABLE_LANGUAGES.contains(c)||this.EXPERIMENTAL_LANGUAGES.contains(c)&&(W.Experiments.isExperimentOpen("multilang")||W.Experiments.isExperimentOpen(e)))&&(a=c),window.wixEditorLangauge=a},clone:function(a){var b=this.parent(a);return b.bundles=this.bundles,b._currentBundle=this._currentBundle,b}})}),define.Class("core.managers.components.BCComponentDeserializer",function(a){var b=a;b.utilize(["core.managers.components.ComponentBuilder"]),b.methods({initialize:function(){},deserializeComponents:function(a,b,c){var d=a.map(this._createBuilderFromCompDescription.bind(this)),e=[];d.forEach(function(a){a.onCreated(function(a,f){e.push(a),e.length===d.length&&b(e),(c||function(){})(a,f)}).create()})},deserialize:function(a,b){this._createBuilderFromCompDescription(a).onCreated(b).create()},_createBuilderFromCompDescription:function(a){var b=a.node,c=this._initBuilder(a,b),d=a.components||[];return this._createChildren(d).each(this._attchToBuilder(c)),c},_createChildren:function(a){return a.map(this._createBuilderFromCompDescription.bind(this))},_attchToBuilder:function(a){return function(b){a.data.node.appendChild(b.data.node),a.withChild(b)}},_initBuilder:function(a,b){var c=new this.imports.ComponentBuilder(b);return c.withType(a.comp||a.componentType).withSkin(a.skin)._with("htmlId",a.htmlId||a.id).withUid(a.uId)._with("propertyQuery",a.propsID)._with("styleId",a.styleId).withData(a.dataQuery).withArgs(a.argObject)._with("layout",a.layout)._with("paddingBottom",a.paddingBottom)._with("minHeight",a.minHeight)}})}),define.Class("core.managers.component.BaseCompSchemaGenerator",function(a,b){var c=a,d=b;c.statics({generateComponentSchema:function(a,b){if(a){var c=this._aggregateSchema(a,b);a.$compSchema=c,a.prototype.$compSchema=c}},_aggregateSchema:function(a,b){b=b||{};for(var c={},d=this._getTraitsWithNewSchemaField(a),e=0;e<d.length;++e){var f=d[e],g=f._definitionFieldName_,h=f._fieldName_,i=f._aggregateSchema_,j=b[g];c[h]=this._aggregateSchemaField(a,j,i,g,h)}return c},_aggregateSchemaField:function(a,b,c,e,f){var g;switch(d.getInheritStrategy(b)){case d.STRATEGIES.INHERIT:g=this._aggregateInheritSchema(a,c,f),g=this._aggregateTraits(a,g,c,e);break;case d.STRATEGIES.MERGE:g=this._aggregateInheritSchema(a,c,f),g=this._mergeFieldData(g,b,c),g=this._aggregateTraits(a,g,c,e);break;case d.STRATEGIES.OVERRIDE:g=c(b),g=this._aggregateTraits(a,g,c,e)}return g},_aggregateInheritSchema:function(a,b,c){var d=a.prototype.Extends;return d.$compSchema&&d.$compSchema[c]||null},_aggregateTraits:function(a,b,c,e){for(var f=this._getClassTraitsWithoutParentTraits(a),g=0;g<f.length;++g){f[g].prototype;var h=f[g]._classDef_,i=h[e];d.getInheritStrategy(i)===d.STRATEGIES.MERGE&&(b=this._mergeFieldData(b,i,c))}return b},_mergeFieldData:function(a,b,c){var d=b.include||null,e=b.exclude||null;return c(a,d,e)},_getClassTraitsWithoutParentTraits:function(a){var b=a.prototype.Implements,c=a.prototype.Extends;if(c){var d=c.prototype.Implements;b=b.filter(function(a){return d.contains(a)?void 0:a})}return b},_getTraitsWithNewSchemaField:function(a){var b=a.prototype.Implements;return b.filter(function(a){return"string"==typeof a._fieldName_&&"function"==typeof a._aggregateSchema_?a:void 0})}})}),define.Class("mobile.core.components.base.BaseComponent",function(a){var b=a;b.utilize(["core.components.base.SizeLimits"]),b.inherits("bootstrap.utils.Events"),b.binds(["getComponentProperties","_setSkinPartElements","_onDataChange","_onDefaultAction","_replaceSkin","_replaceSkinAsync","_onRenderingTriggerEvent","_onComponentWixified","_onEditModeChanged","_skinParamsChange"]),b.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),b.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[]}}),b.methods({_renderTriggers:[],initialize:function(a,b,c){this._onRender=this._onRender.bind(this),this.initComponentLayout=this.initComponentLayout.bind(this),this._layoutInitialized=!1,this._anchors=[],this._$x=this._$y=0,this._$width=this._$height=100,this._reverseAnchors=[],this._actualHeight=-1,this._autoSizeTimerIntervals=-1,this.addEvent("render",this._onRender),this.addEvent("autoSized",this._onAutoSized),this.addEvent("autoSizedAnimation",this._onAutoSizedAnimation),this._baseComponentOriginalInitialize(a,b,c),this._showOnAllPagesChangeability=!0,this._wysiwygMode=!0,this._resizableSides=[Constants.BaseComponent.ResizeSides.TOP,Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.BOTTOM,Constants.BaseComponent.ResizeSides.RIGHT],this._moveDirections=[Constants.BaseComponent.MoveDirections.HORIZONTAL,Constants.BaseComponent.MoveDirections.VERTICAL],this._view.setStyle("visibility","hidden"),this.addEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout)},isDraggable:function(){return!0},_baseComponentOriginalInitialize:function(a,b,c){this._compId=a,this._view=b,this.$view=b,this._styleNameSpace=c&&c.styleNameSpace,this._isEnabled=!b.disabled,this._view.setProperty("id",c&&c.id||a),this._allComponentPartsReady=!1,this._componentReady=!1,this._isRenderNeeded=!0,this._autoBoundParts=null,this._isDisposed=!1,this._isRendered=!1,this._editorMode="CURRENT_PAGE";
var d=c&&c.command||b.getAttribute("command");this._commandParameter=c&&c.commandParameter||b.getAttribute("commandParameter"),this._command=null,this._commandName=null,this._usesExternalData=!1,this._callLaterIDs=[],this._stateGrpDict={},this._sizeLimits=this.getSizeLimits(),this._minimumTimeBetweenRenders=this._minimumTimeBetweenRenders||0,this._lastRenderTime=-9999,this._renderDelayed=!1,d&&this.setCommand(d,this._commandParameter),this._isDisplayed=!1,b.addEvent(Constants.ComponentEvents.WIXIFIED,this._onComponentWixified),this.injects().Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditModeChanged)},toString:function(){return"[Component "+this.className+" #"+this._compId+"]"},getComponentId:function(){return this._compId},getComponentType:function(){return this._view.get("comp")},_getDataManager:function(){return this._data.getDataManager()},getViewNode:function(){return this._view},getStyleNameSpace:function(){return this._styleNameSpace||this.getOriginalClassName()},getSizeLimits:function(){return void 0===this._sizeLimits&&(this._sizeLimits=new this.imports.SizeLimits,this._sizeLimits.minW=this._sizeLimits.minW||this.MINIMUM_WIDTH_DEFAULT,this._sizeLimits.minH=this._sizeLimits.minH||this.MINIMUM_HEIGHT_DEFAULT,this._sizeLimits.maxW=this._sizeLimits.maxW||this.MAXIMUM_WIDTH_DEFAULT,this._sizeLimits.maxH=this._sizeLimits.maxH||this.MAXIMUM_HEIGHT_DEFAULT,this._originalSizeLimits=this._sizeLimits.clone()),this._sizeLimits},_initSizeLimits:function(){},setMinW:function(a){this.getSizeLimits().minW=a,this._originalSizeLimits.minW=a,this._applySizeLimitsIfNeeded()},setMinH:function(a){this.getSizeLimits().minH=a,this._originalSizeLimits.minH=a,this._applySizeLimitsIfNeeded()},setMaxW:function(a){this.getSizeLimits().maxW=a,this._originalSizeLimits.maxW=a,this._applySizeLimitsIfNeeded()},setMaxH:function(a){this.getSizeLimits().maxH=a,this._originalSizeLimits.maxH=a,this._applySizeLimitsIfNeeded()},_applySizeLimitsIfNeeded:function(){(this._$width<this.getSizeLimits().minW||this._$width>this.getSizeLimits().maxW)&&this.setWidth(this._$width),(this._$height<this.getSizeLimits().minH||this._$height>this.getSizeLimits().maxH)&&this.setHeight(this._$height)},getAcceptableDataTypes:function(){return[""]},getRawData:function(){return this._data?this._data.getData():void 0},getDataItem:function(){return this._data},isUsingExternalData:function(){return this._usesExternalData},setDataItem:function(a){var b=this._data;try{b&&(b.removeComponentWithInterest(this),b.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange))}catch(c){}this._data=a,a&&a!=b&&(this._data.addComponentWithInterest(this),this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._view.setAttribute("dataquery","#"+this._data.get("id"))),this._onDataChange(a),this._tryCreatingComponentParts()},setDataByQuery:function(a,b){this.injects().Data.getDataByQuery(a,function(a){this.setDataItem(a),b&&b()}.bind(this))},_setSkinPartElements:function(a){this._validateSkinParts(a),this._skinPartElements=a,this._tryCreatingComponentParts()},_validateSkinParts:function(a){var b;for(var c in this._skinPartsSchema)b=this._skinPartsSchema[c],a[c]||b.optional||b.autoCreate===!1||b.repeater||LOG.reportError(wixErrors.SKIN_PART_MISSING,"BaseComponent","_validateSkinParts",{c1:this.$className,c2:this._skin.$className+":"+c})},_tryCreatingComponentParts:function(){this._skinPartElements&&(this._data||this.getAcceptableDataTypes().indexOf("")>=0)&&this._loadComponentParts()},_loadComponentParts:function(){this._allComponentPartsReady=!1,this._skinParts=this._skinPartElements;var a={},b=[],c={};for(var d in this._skinPartsSchema)if("view"!=d){var e=this.getSkinPartDefinition(d),f=this._doesSkinPartNeedAutoWixification(d,!0,e);if(f){var g=this._skinParts[d]||new Element("div");a[d]=g,c[d]=e,b.push(g)}}delete this._skinPartElements;var h=this;if(0!==b.length){new Async.Bulk(b,null,{completeEvent:Constants.ComponentEvents.READY,onComplete:function(){if(!h._isDisposed){for(var b in a){var c=a[b];b=c.get("skinPart"),b&&(h._skinParts[b]=c.getLogic())}h._setAllPartsReady()}}});for(d in a)this._createInnerComponent(d,a[d],!0,c[d])}else this._setAllPartsReady()},_doesSkinPartNeedAutoWixification:function(a,b,c){return c=c||this.getSkinPartDefinition(a),c.type==Constants.ComponentPartTypes.HTML_ELEMENT||c.repeater?!1:b&&c.autoCreate===!1?!1:!0},_createInnerComponent:function(a,b,c,d){return d=d||this.getSkinPartDefinition(a),d.type==Constants.ComponentPartTypes.HTML_ELEMENT||d.repeater||c&&d.autoCreate===!1?void 0:(d.skin=d.skin||b.getProperty("skin"),this._createComponentbyDefinition(d,b))},_createComponentbyDefinition:function(a,b,c){b=b||new Element("div"),b.setProperty("skinPart",a.id);var d;if(a.dataQuery)d=a.dataQuery;else if(a.dataRefField){var e=a.dataRefField;d="*"==e?this._data:this._data.get(e)}else if(a.dataItem)d=a.dataItem;else if(a.dataType){var f=this._data?this._data.getDataManager():W.Data;d=f.addDataItemWithUniqueId("",{type:a.dataType}).dataObject,d.setMeta("isPersistent",!1)}this._data&&this._data.getDataManager()!=W.Data?b.set("dataQuerySource","preview"):a.dataQuerySource&&b.set("dataQuerySource",a.dataQuerySource),a.argObject=a.argObject||{};var g;a.styleGroup&&this._style&&(g="inherit"==a.styleGroup?this._style:this._style.getStyleByGroupName(a.styleGroup));var h;return(c||g)&&(h=function(a){c&&c(a)}),this.injects().Components.createComponent({compNode:b,type:a.type,skin:a.skin,data:d,args:a.argObject,componentReadyCallback:h,innerStyle:g})},getSkinPartDefinition:function(a){var b=this._skinPartsSchema[a];if(!b)return LOG.reportError(wixErrors.CM_NO_PART,this.className,"getSkinPartParams",skinPartName),ret;var c=this._skinPartsSchema[a]||{},d=this._skin&&this._skin.getCompPartsDefinition()[a]||{},e=Object.merge({id:a},d,c);return e.hookMethod&&"function"==typeOf(this[e.hookMethod])&&(e.argObject=e.argObject||{},e=this[e.hookMethod](e)),e},_setAllPartsReady:function(){this._allComponentPartsReady||(this._allComponentPartsReady=!0,this._registerDataBindings(),this._registerSkinPartCommands(),this._applySizeLimitsIfNeeded(),this._onAllSkinPartsReady(this._skinParts),this._renderIfReady())},setTextContent:function(){W.Utils.debugTrace("")},setSkin:function(a){if(this._skin&&this._skin.unRegister(),this._skinParts&&this._skinParts.inlineContent){var b=this._skin.getInlineContent();this._view.empty(),this._view.adopt(b)}this._skin=a;var c=this.getSizeLimits(),d=this._originalSizeLimits;c.minW=this._skin.minW||d.minW,c.minH=this._skin.minH||d.minH,c.maxW=this._skin.maxW||d.maxW,c.maxH=this._skin.maxH||d.maxH,this._skin.register(this._view,this._setSkinPartElements,this._skinParamsChange)},initSkinAndStyle:function(a,b){if(!this._skin){this._skin=a,this._style=b;var c=this.getSizeLimits(),d=this._originalSizeLimits;c.minW=this._skin.minW||d.minW,c.minH=this._skin.minH||d.minH,c.maxW=this._skin.maxW||d.maxW,c.maxH=this._skin.maxH||d.maxH,this._skin.applyStyle(b),this._updateViewAttributes(),this._style.addEvent("skinChange",this._replaceSkinAsync),this._skin.register(this._view,this._setSkinPartElements,this._skinParamsChange),this._onStyleReady()}},setStyle:function(a){a!==this._style&&(this._style&&this._style.removeEvent("skinChange",this._replaceSkinAsync),this._style=a,a.getSkin()!=this._skin.getOriginalClassName()?this._skin.injects().Skins.getSkin(a.getSkin(),this._replaceSkin):this._skin.applyStyle(a),this._updateViewAttributes(),this._style.addEvent("skinChange",this._replaceSkinAsync),this._onStyleReady())},_onEditModeChanged:function(a){var b=this._editorMode;this._editorMode=a,this._editModeChanged(a,b)},_editModeChanged:function(){},_onStyleReady:function(){},getStyle:function(){return this._style},_replaceSkinAsync:function(){this._skin.injects().Skins.getSkin(this._style.getSkin(),this._replaceSkin)},_replaceSkin:function(a){var b=new a;b.applyStyle(this._style),this.setSkin(b)},_updateViewAttributes:function(){this._view.removeAttribute("styleId"),this._view.setAttribute("skin",this._skin.$className),this._style&&(this._view.removeAttribute("skin"),this._view.setAttribute("styleId",this._style.getId()))},render:function(){},_onAllSkinPartsReady:function(){},_onDataChange:function(a,b,c){this._preventRenderOnDataChange(a,b,c)||this._renderIfReady()},_preventRenderOnDataChange:function(){},_renderIfReady:function(){this._componentReady?this._tryRender(!0):this._testComponentReady()},renderIfNeeded:function(){this._componentReady?this._tryRender(!1):this._testComponentReady()},_tryRender:function(a){if(this._isRenderNeeded=this._isRenderNeeded||!!a,!this._componentReady||!this._needsRender()||!this._allComponentPartsReady)return this._componentReady&&this._allComponentPartsReady;var b=!1;if(0===this._minimumTimeBetweenRenders||this._timeSinceLastRender()>this._minimumTimeBetweenRenders)this._prepareForRender()&&(b=!0,this.fireEvent(Constants.ComponentEvents.READY_FOR_RENDER),!this._skipRender&&this._isDisplayed&&(this._isRenderNeeded=!1,this._newlyDisplayed=!1,this._lastRenderTime=(new Date).getTime(),this.render(),this._isRendered=!0,this._refreshDataBindings(),this._areRenderingTriggersAttached||(this._areRenderingTriggersAttached=!0,this._attachRenderTriggers()),this.fireEvent(Constants.ComponentEvents.RENDER),this._view.fireEvent(Constants.ComponentEvents.RENDER)));else if(!this._renderDelayed){this._renderDelayed=!0;var c=Math.max(10,this._minimumTimeBetweenRenders-this._timeSinceLastRender());this.callLater(this._delayedRenderCB,[a],c)}return b},_delayedRenderCB:function(a){this._renderDelayed=!1,this._tryRender(a)},_timeSinceLastRender:function(){return(new Date).getTime()-this._lastRenderTime},_needsRender:function(){return this._isRenderNeeded},isReady:function(){return this._componentReady},isRendered:function(){return this._isRendered},setCollapsed:function(a){a?this.collapse():this.uncollapse()},callLater:function(a,b,c){if(!this._isDisposed){var d=this.injects().Utils.callLater(a,b,this,c);return d&&this._callLaterIDs.push(d),d}},callRenderLater:function(a){this._isDisposed||(a=a||100,this._renderDelayed||(this._renderDelayed=!0,this.callLater(function(){this._renderDelayed=!1,this._renderIfReady()}.bind(this),[],a)))},collapse:function(){this._view&&this._view.collapse()},uncollapse:function(a){this._view&&this._view.uncollapse(a)},setState:function(a,b){this._processStates(),this._currentState,b||(b=this._stateGrpDict[a]||"DEFAULT"),b=b.toUpperCase();var c=this._stateMap[b];c?c.indexOf(a)<0?LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,this.$className,"setState",b+":"+a):(this._currentStateMap[b]=a,this._syncState()):LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,this.$className,"setState",b)},hasState:function(a,b){this._processStates(),b||(b=this._stateGrpDict[a]||"DEFAULT"),b=b.toUpperCase();var c=this._stateMap[b];return c?c.indexOf(a)<0?!1:!0:!1},removeState:function(a,b){this._processStates(),b=(b||"DEFAULT").toUpperCase();var c=this._stateMap[b];if(c){var d=this._currentStateMap[b];d==a&&delete this._currentStateMap[b],this._syncState()}else LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,this.$className,"removeState",b)},_syncState:function(){var a=[];for(var b in this._stateMap)this._currentStateMap[b]&&a.push(this._currentStateMap[b]);var c=a.join(" "),d=this._view,e=this._currentState||"";this._currentState=c,null!==d&&(d.setProperty("state",c),d.addClass("FOCRE_REFLOW_PLEASE"),d.removeClass("FOCRE_REFLOW_PLEASE"),c!=e&&(this._onStateChange(c,e),this.fireEvent("stateChange",{newState:c,oldState:e}),d.triggerDisplayChanged()))},getState:function(a){var b;return a?(this._currentStateMap||this._processStates(),b=this._currentStateMap[a.toUpperCase()]):b=this._view.getProperty("state"),b||""},_processStates:function(){if(!this._stateMap){var a,b;this._currentStateMap={},this._stateMap={DEFAULT:[]};var c=this._states||[],d={};if(c instanceof Array)for(a=0;a<c.length;++a)b=c[a],"string"!=typeof b?LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",c):this._stateMap.DEFAULT.push(b);else if("object"==typeof c)for(var e in c){var f=c[e];if(f instanceof Array){var g=e.toUpperCase();for(this._stateMap[g]=f.concat(),a=0;a<f.length;++a)b=f[a],b in d&&LOG.reportError(wixErrors.CM_DUPLICATE_STATE_NAME,this.$className,"_processStates",b),d[b]=!0,this._stateGrpDict[b]=g}else LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",e)}else LOG.reportError(wixErrors.CM_MALFORMED_STATES,this.$className,"_processStates",c)}},dispose:function(){if(W.Layout&&W.Layout.deleteSavedAnchorsById(this.getID()),this._isDisposed)return LOG.reportError(wixErrors.COMPONENT_ALREADY_DISPOSED,this.className,"dispose",this._compId);for(this._view&&(this._view.cleanup(),this._view.destroy(),this._view=null,this.$view=null,this._isDisposed=!0),this._data&&(this._data.removeComponentWithInterest(this),this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._data.getDataManager().removeDataItem(this._data),delete this._data),this._properties&&(this._properties.removeComponentWithInterest(this),this._properties.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this._properties.getDataManager().removeDataItem(this._properties),delete this._properties);this._callLaterIDs.length>0;){var a=this._callLaterIDs.pop();a&&this.injects().Utils.clearCallLater(a)}this.removeEvents();var b=this.injects().Commands;if(b&&b.unregisterListener(this),this.getSkin()&&this.getSkin().dispose(),this._skinParts){for(var c in this._skinParts){var d=this._skinParts[c];if(d)if(d._compId)try{d.dispose()}catch(e){}else try{d.cleanup(),d.destroy()}catch(f){}}this._skinParts=null}},getIsDisposed:function(){return this._isDisposed},_onComponentWixified:function(){var a=this._view;this._canFocus&&(a.addEvent(Constants.CoreEvents.FOCUS,this._onFocus.bind(this)),a.addEvent(Constants.CoreEvents.BLUR,this._onBlur.bind(this))),this._isDisplayed=a.isNodeDisplayed(),this._areRenderingTriggersAttached=!1;var b=this._triggers;if(b)for(var c=b.length-1;c>=0;--c){var d=b[c];a.addEvent(d,this._onDefaultAction)}var e=Constants.DisplayEvents,f=this._onRenderingTriggerEvent;for(var g in Constants.DisplayEvents)a.addEvent(e[g],f)},_onComponentReady:function(){this._view},_attachRenderTriggers:function(){for(var a=this._renderTriggers||[],b=this._view,c=a.length-1;c>=0;--c)b.addEvent(a[c],this._onRenderingTriggerEvent)},_testComponentReady:function(){if(!this._componentReady)if(this._view.getLogic)this._isBaseComponentReady()&&(this._componentReady=!0,this._isEnabled?this._handleEnabled():this._handleDisabled(),this._tryRender()?(this.fireEvent(Constants.ComponentEvents.READY),this._view.fireEvent(Constants.ComponentEvents.READY)):this._componentReady=!1);else{var a=function(){this._view.removeEvent(Constants.ComponentEvents.WIXIFIED,a),this._testComponentReady()}.bind(this);this._view.addEvent(Constants.ComponentEvents.WIXIFIED,a)}},_isBaseComponentReady:function(){return this._allComponentPartsReady&&!!this._skinParts&&(!!this._data||this.getAcceptableDataTypes().indexOf("")>=0)},_prepareForRender:function(){return!0},_onStateChange:function(){},fancify:function(a){var b=this.injects().Components.createComponent("mobile.editor.components.FancyItem","mobile.editor.skins.FancyItemSkin",void 0,{},null,function(){var c=this;b.getLogic().createGui({dataPanel:this,upClickHandler:a.upCallback,downClickHandler:a.downCallback,deleteHandler:a.deleteCallback,showHideToggleHandler:a.isHiddenCallback,isHidden:a.initialIsHidden},this._skinParts.fancyContainer),b.getLogic()._skinParts.view.insertInto(c._skinParts.view),this._tryRender(!0),a.readyCallback&&a.readyCallback()}.bind(this))},_refreshDataBindings:function(){var a=this._autoBoundParts;if(a&&a.length)for(var b=this._data&&this._data.getData(),c=this.injects(),d=c.Resources,e=c.Utils,f=this._skinParts,g=a.length-1;g>=0;--g){var h,i=a[g],j=f[i.skinPart];if(j){if(i.bindToData){if(h=b&&b[i.bindToData],null===h||void 0===h){LOG.reportError(wixErrors.CM_NO_DATA,this.className,"refreshDataBindings",i.bindToData);continue}}else if(i.bindToDictionary){if(h=d.get("EDITOR_LANGUAGE",i.bindToDictionary),null===h||void 0===h){LOG.reportError(wixErrors.CM_NO_DICTIONARY_DATA,this.className,"refreshDataBindings",i.bindToDictionary);continue}}else i.bindToSelf&&(h=this[i.bindToSelf]);if(i.dictionaryFallback&&h.match(/^\s*$/)&&(h=d.get("EDITOR_LANGUAGE",i.dictionaryFallback)),i.isView){var k=i.viewType;if(""===k){var l=j.nodeName;if("input"==l.toLowerCase()){var m=j.getAttribute("type").toLowerCase();"text"==m?k="textinput":("checkbox"==m||"radio"==m)&&(k="check")}else k="text";i.viewType=k}if("textinput"==k)j.setAttribute("value",h);else if("check"==k){var n=e.stringToBoolean(h);n?j.setAttribute("checked",!0):j.removeAttribute("checked")}else j.innerHTML=h}else j.setTextContent(h)}}},hide:function(){this._view&&this._view.hide()},show:function(){this._view&&this._view.show()},_disableLinks:function(a){var b=this;a.addEvent("click",function(a){var c=b.injects().Viewer;if(c.getPreviewMode()&&(a.preventDefault(),W.Viewer.getLinkTipFunc())){var d=$(this).getProperty("href")||"",e=b.injects().Data.createDataItem({type:"Link",target:d,linkType:"FREE_LINK"});W.Viewer.getLinkTipFunc()(e)}})},_sanitizeLinks:function(a){for(var b=0;b<a.length;++b){var c=a[b];this._sanitizeLink(c)}},_sanitizeLink:function(a){var b=a.get("href");b&&0!==b.indexOf("http://")&&0!==b.indexOf("https://")&&0!==b.indexOf("telnet://")&&0!==b.indexOf("ftp://")&&0!==b.indexOf("mailto:")&&(b.indexOf("@")>0?a.set("href","mailto:"+b):(0===b.indexOf("www")||0!==b.indexOf("www")&&0!==b.indexOf("#"))&&a.set("href","http://"+b))},_onFocus:function(){},_onBlur:function(){},_onDefaultAction:function(){this.executeCommand()},executeCommand:function(a){if(!this._command&&this._commandName){var b;b="WEditorCommands.AddComponent"==this._commandName?W.CommandsNew.getCommand(this._commandName):W.Commands.getCommand(this._commandName),b&&this.setCommand(b,this._commandParameter)}if(this._command){var c=arguments.length>0?a:this._commandParameter;c&&(c=this._parseDataReference(c)),this._command.execute(c,this)}},enable:function(){this._isEnabled||(this._isEnabled=!0,this._view.removeAttribute("disabled"),this._handleEnabled())},disable:function(){this._isEnabled&&(this._isEnabled=!1,this._view.setAttribute("disabled","disabled"),this._handleDisabled())},isEnabled:function(){return this._isEnabled},setCommand:function(a,b){var c=this.injects().Commands;if(("WEditorCommands.AddComponent"==this._commandName||"WEditorCommands.AddComponent"==a)&&(c=this.injects().CommandsNew),"string"==typeof a)this._commandName=a,a=c.getCommand(a);else if(!a instanceof c.Command&&!c.isCommandInstance(a))return LOG.reportError(wixErrors.BAD_COMMAND,this.className,"setCommand",a),void 0;this._commandParameter=b,this._command&&(this._command.unregisterListener(this),this._command=null),a?(this._command=a,a.registerListener(this,null,this._onCommandStatusChanged),this._commandName&&delete this._commandName):this._commandName&&c.registerCommandListenerByName(this._commandName,this,null,this._onCommandStatusChanged)},getCommandName:function(){return this._command?this._command.getName():this._commandName},getCommandParameter:function(){return this._commandParameter},_onCommandStatusChanged:function(a){a.isEnabled()?this.enable():this.disable()},_onEnabled:function(){},_handleEnabled:function(){var a=this._view,b=a.tabIndex,c=a._savedTabIndex;(null===b||void 0===b)&&(b=-1),-1==b&&(void 0!==c?a.tabIndex=c:this._canFocus&&(a.tabIndex=0)),this._canFocus&&a.addClass("focusable"),this._componentReady&&this._onEnabled()},_onDisabled:function(){},_handleDisabled:function(){var a=this._view,b=a.tabIndex;(null===b||void 0===b)&&(b=-1),b>=0&&(a._savedTabIndex=b,a.tabIndex=-1),document.activeElement==a&&a.blur(),this._canFocus&&a.removeClass("focusable"),this._componentReady&&this._onDisabled()},_onRenderingTriggerEvent:function(a){var b=this._view.isNodeDisplayed();switch(a){case Constants.DisplayEvents.COLLAPSED:case Constants.DisplayEvents.REMOVED_FROM_DOM:this._isDisplayed=!1,this._newlyDisplayed=!1;break;case Constants.DisplayEvents.SKIN_CHANGE:this._renderTriggers.contains(Constants.DisplayEvents.SKIN_CHANGE)&&(b?this._renderIfReady():this._componentInvalidated=!0);break;case Constants.DisplayEvents.MOVED_IN_DOM:this._view.isNodeDisplayed()&&this._renderTriggers.contains(Constants.DisplayEvents.MOVED_IN_DOM)&&this._renderIfReady(),this._skin.renderCssIfNeeded();break;default:var c=this._isDisplayed;this._isDisplayed=b,this._newlyDisplayed=this._newlyDisplayed||!c&&this._isDisplayed;var d=this._renderTriggers.contains(a)||this._renderTriggers.contains(Constants.DisplayEvents.DISPLAY_CHANGED);this._newlyDisplayed&&(d||!this._areRenderingTriggersAttached||this._componentInvalidated)&&(this._componentInvalidated=!1,this._renderIfReady()),this._skin.renderCssIfNeeded(),this._addedToDom()}},invalidateComponent:function(){this._componentInvalidated=!0},getIsDisplayed:function(){return this._isDisplayed},_addedToDom:function(){},checkVisibility:function(){return this._isDisplayed=this._view.isNodeDisplayed(),this._isDisplayed},_setDataField:function(a,b){this._data.set(a,b,!0)},_setMetaDataField:function(a,b){this._data.setMeta(a,b)},getFocusNode:function(){var a=this._skinParts.view;for(var b in this._skinPartsSchema)this._skinPartsSchema[b].focus&&(a=this._skinParts[b]||a);return a},getSkinPart:function(a){return this._skinParts[a]},getSkin:function(){return this._skin},setComponentProperties:function(a){var b=this._properties;this._properties=a,a.addComponentWithInterest(this),a&&a!=b&&this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)},getComponentProperty:function(a){return this._properties||this._createComponentProperties(),this._properties.get(a)},setComponentProperty:function(a,b,c){this._properties||this._createComponentProperties(),this._properties.set(a,b,c)},_createComponentProperties:function(){if(this._view){var a=this._compId,b=this._propertiesSchemaName;if(!b)return null;this._properties=W.ComponentData.addDataItem(a,{type:b},this),this._properties.addComponentWithInterest(this),this._view.setProperty("propertyQuery",a),this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)}},deleteComponentProperty:function(){},_onComponentPropertyChange:function(){},_loadComponentProperties:function(){},getComponentProperties:function(){return this._properties||this._createComponentProperties(),this._properties},_registerSkinPartCommands:function(){var a=this._skinPartsSchema,b=this.injects().Commands;for(var c in a){var d=a[c],e=this._skinParts[c],f=this._parseDataReference(d.command);if(e&&f){var g;if(g="string"==typeof f?b.getCommand(f):f,"view"==c||d.type==Constants.ComponentPartTypes.HTML_ELEMENT){var h=this._parseDataReference(d.commandParameter);g?e._command=g:e._commandName=f,e._commandParameter=h;var i=e.nodeName.toLowerCase();"select"==i?e.addEvent(Constants.CoreEvents.CHANGE,this._elementChangeExecuteCommand):e.addEvent(Constants.CoreEvents.CLICK,this._elementExecuteCommand)}else e.setCommand(g||f,d.commandParameter)}}},_registerDataBindings:function(){var a=[],b=this._skinPartsSchema;for(var c in b){var d=b[c],e=this._skinParts[c];if(e){var f=d.type==Constants.ComponentPartTypes.HTML_ELEMENT,g=f?e:e.getViewNode(),h=null,i=d.autoBindData||g&&g.getAttribute("autoBindData");i?h={bindToData:i}:(i=d.autoBindDictionary||g&&g.getAttribute("autoBindDictionary"),i?h={bindToDictionary:i}:(i=d.autoBindThis||g&&g.getAttribute("autoBindThis"),i&&(h={bindToSelf:i}))),h&&(h.skinPart=c,h.isView=f,h.viewType="",h.dictionaryFallback=d.dictionaryFallback,a.push(h))}}a.length&&(this._autoBoundParts=a)},_parseDataReference:function(a){if(!a||"string"!=typeof a)return a;var b=a;try{var c=a.indexOf("this.");if(0===c){try{b=this[a.substring(5)]}catch(d){b=null}b||W.Utils.debugTrace(this.className+" unknown part data reference "+a)}else c=a.indexOf("data."),0===c&&(this._data&&(b=this._data.get(a.substring(5)))||W.Utils.debugTrace(this.className+" missing data for skinpart "+a))}catch(e){W.Utils.debugTrace(this.className+" error processing partData "+a)}return b},_elementExecuteCommand:function(a){var b=W.Commands;"WEditorCommands.AddComponent"==this._commandName&&(b=W.CommandsNew);var c=this._command||(this._command=b.getCommand(this._commandName));c&&c.execute(this._commandParameter||a,this)},_elementChangeExecuteCommand:function(){var a=this.value,b=W.Commands;"WEditorCommands.AddComponent"==this._commandName&&(b=W.CommandsNew);var c=this._command||(this._command=b.getCommand(this._commandName));c&&c.execute(a)},hasChildren:function(){return!1},onPageVisibilityChange:function(){},initComponentLayout:function(){this._view.setStyle("visibility","visible"),this.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout),this._valueFetchingRegex=/[-\d\.]+/;for(var a=["x","y","width","height"],b=!1,c=0;c<a.length;c++){var d=a[c],e=this._view.get(d);if(null!=e&&""!=e){b=!0;var f="set"+d.capitalize();this[f](e,!0)}}if(this._layoutInitialized=!0,b&&this._view.hasAttribute("pos")===!1)"relative"!=this._view.getStyle("position")&&this._view.setStyle("position","absolute");else{var g=this._view.getAttribute("pos");g&&this._view.setStyle("position",g)}this.saveCurrentDimensions(),this.saveCurrentCoordinates()},_onRender:function(){this._intervalID&&clearInterval(this._intervalID),this._wCheckForSizeChangeAndFireAutoSized(5),this.flushMinPhysicalHeightCache()},_wCheckForSizeChangeAndFireAutoSized:function(a){if(this._view){this._autoSizeTimerIntervals=Math.max(a,this._autoSizeTimerIntervals);var b=function(){try{this._autoSizeTimerIntervals>1&&requestAnimFrame(b),this._autoSizeTimerIntervals>-1&&this._onAutoSized()}catch(a){}finally{this._autoSizeTimerIntervals--}}.bind(this);window.requestAnimFrame(b)}},_addedToDom:function(){this._pendingAutoSize&&(this._onAutoSized(this._pendingAutoSizeArgs),delete this._pendingAutoSize,delete this._pendingAutoSizeArgs)},_onAutoSized:function(a){if(!this._view||!this._isDisplayed||0==this.getPhysicalHeight())return this._pendingAutoSize=!0,this._pendingAutoSizeArgs=a,void 0;var b=this._actualWidth;this.flushPhysicalHeightCache();var c,d=this.getPhysicalHeight(),e=this.getWidth();if(c=this._lastHeightOnAutoSize?this._lastHeightOnAutoSize:0,(d!=c||b!=e&&b)&&(this._actualWidth=e,!a||!a.ignoreLayout)){var f=!0;null==this.getAnchors()||W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getAnchors())?f=!1:null!=this.getHorizontalGroup()&&W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getHorizontalGroup())?f=!1:this._areAnchorsAlreadySet||(f=!1),this._anchorTargetsReady||f?(this._anchorsInvalidated=!1,this._anchorTargetsReady=!0,W.Layout&&W.Layout.enforceAnchors([this])):this._anchorsInvalidated=!0}this._lastHeightOnAutoSize=d,this.fireEvent("autoSizeChange")},isAnchorsInvalidated:function(){return this._anchorsInvalidated===!0},_onAutoSizedAnimation:function(){this._wCheckForSizeChangeAndFireAutoSized(20)},_skinParamsChange:function(){this._view&&this._view.fireEvent(Constants.DisplayEvents.SKIN_CHANGE,Constants.DisplayEvents.SKIN_CHANGE),this._onAutoSized()},saveCurrentCoordinates:function(){this._lastCoords={x:this.getX(),y:this.getY()}},getCurrentCoordinates:function(){return this._lastCoords={x:this.getX(),y:this.getY()},this._lastCoords},getLastCoordinates:function(){return this._lastCoords||this.saveCurrentCoordinates(),this._lastCoords},saveCurrentDimensions:function(){this._lastDimensions={w:this.getWidth(),h:this.getHeight()}},getCurrentDimensions:function(){return this._lastDimensions={w:this.getWidth(),h:this.getHeight()},this._lastDimensions},getLastDimensions:function(){return this._lastDimensions||this.saveCurrentDimensions(),this._lastDimensions},getX:function(){return this._$x},setX:function(a){if(this._$x!=parseInt(a,10)){if(isNaN(parseInt(a,10)))return W.Utils.debugTrace("WbaseComp","setX","NaN passed as value"),void 0;this._$x=parseInt(a,10),this._view.setStyle("left",a+"px"),this.onMovement()}},getY:function(){return this._$y},setY:function(a){if(this._$y!=parseInt(a,10)){if(isNaN(parseInt(a,10)))return W.Utils.debugTrace("WbaseComp","setY","NaN passed as value"),void 0;this._$y=parseInt(a,10),this._view.setStyle("top",a+"px"),this.onMovement()}},getWidth:function(){return this._$width},setWidth:function(a,b,c){return 0!=c&&(c=!0),a=parseInt(a,10),isNaN(a)?(W.Utils.debugTrace("WbaseComp","setWidth","NaN passed as value"),void 0):(a=this._limitWidth(a),(this._$width!=a||b)&&(this._$width=a,this._view.setStyle("width",a+"px"),c&&this._onResize(),this.flushMinPhysicalHeightCache(),this.flushPhysicalHeightCache()),void 0)},setHeight:function(a,b,c){return 0!=c&&(c=!0),a=parseInt(a,10),isNaN(a)?(W.Utils.debugTrace("WbaseComp","setHeight","NaN passed as value"),void 0):(a=this._limitHeight(a),(this._$height!=a||b)&&(this._$height=a,this._view.setStyle("min-height",this._$height+"px"),this.flushPhysicalHeightCache(),c&&this._onResize()),void 0)},isInstanceOfClass:function(a){if(this.className==a)return!0;for(var b=this.$parentPrototype;b;){if(b.className==a)return!0;b=b.$parentPrototype}return!1},isFixedPositioned:function(){return!1},getSelectableX:function(){return this.getX()},getSelectableY:function(){return this.getY()},getSelectableWidth:function(){return this.getWidth()},getSelectableHeight:function(){return this.getPhysicalHeight()},_limitWidth:function(a){return this._limitDimension(a,this.getSizeLimits().minW,this.getSizeLimits().maxW)},_limitHeight:function(a){return this._limitDimension(a,this.getSizeLimits().minH,this.getSizeLimits().maxH)},_limitDimension:function(a,b,c){return Math.min(Math.max(a,b),c)},getHeight:function(){return this._$height},_onResize:function(){this.fireEvent("resize")},onMovement:function(){this.fireEvent("componentMoved")},getPosition:function(){var a=this.getViewNode().getSize();return{y:this.getY(),x:this.getX(),height:a.y,width:a.x}},getGlobalPosition:function(){return this._view.getPosition()},getGlobalPositionRefNode:function(){return this._getEditBoxReferenceNode().getPosition()},getSizeRefNode:function(){return this._getEditBoxReferenceNode().getSize()},getID:function(){return this._view.getProperty("id")},getMinPhysicalHeight:function(){if(!this._minPhysicalHeight){var a=this.getHeight();this.setHeight(1),this._minPhysicalHeight=this.getPhysicalHeight(),this.flushPhysicalHeightCache(),this.setHeight(a)}return this._minPhysicalHeight},getPhysicalHeight:function(){return this._actualHeight=this._actualHeight||this.getViewNode().getSize().y,this._actualHeight=Math.max(this.getHeight(),this._actualHeight),this._actualHeight},getExtraPixels:function(a){return this.getDivExtraPixels(this._view,a)},getDivExtraPixels:function(a,b){var c=Number.from(a.getStyle("border-top"))+Number.from(a.getStyle("padding-top")),d=Number.from(a.getStyle("border-bottom"))+Number.from(a.getStyle("padding-bottom")),e=Number.from(a.getStyle("border-left"))+Number.from(a.getStyle("padding-left")),f=Number.from(a.getStyle("border-right"))+Number.from(a.getStyle("padding-right"));return b&&(c+=Number.from(a.getStyle("margin-top")),d+=Number.from(a.getStyle("margin-bottom")),e+=Number.from(a.getStyle("margin-left")),f+=Number.from(a.getStyle("margin-right"))),{top:c,bottom:d,left:e,right:f,height:c+d,width:e+f}},flushPhysicalHeightCache:function(){delete this._actualHeight},flushMinPhysicalHeightCache:function(){delete this._minPhysicalHeight},getAnchors:function(){return this._anchors},setAnchors:function(a){this._areAnchorsAlreadySet=!0,this._anchors=a,a.forEach(this.addReverseAnchor)},addAnchor:function(a){this._anchors.push(a),this.addReverseAnchor(a)},addReverseAnchor:function(a){a.toComp===this?this._reverseAnchors.include(a):a.toComp.addReverseAnchor(a)},getReverseAnchors:function(){return this._reverseAnchors},getHorizontalGroup:function(){return this._horizontalGroup
},setHorizontalGroup:function(a){this._horizontalGroup=a},getLayoutMode:function(){return"NORMAL"},getMinDragY:function(a){return W.Layout&&W.Layout.getComponentMinDragY(this,a)},getParentComponent:function(){var a=this.getViewNode().getParent("[comp]");return a&&a.getLogic?a.getLogic():null},getResizableSides:function(){return this._resizableSides},isResizable:function(){return this._resizableSides.length>0},isHorizResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.RIGHT)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.LEFT)},isVertResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.TOP)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.BOTTOM)},isHorizontallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.HORIZONTAL)},isVerticallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.VERTICAL)},allowHeightLock:function(){return this.isVertResizable()},useLayoutOnDrag:function(){return!1},useLayoutOnResize:function(){return!1},isEditableInPlace:function(){return!1},getEditedContent:function(){return null},isContainable:function(){return!0},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD},from:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD}}},isSelectable:function(){return!0},isContainer:function(){return!1},isDeleteable:function(){return!0},isDuplicatable:function(){return!0},isDeleteableRecurse:function(){if(!this.isDeleteable())return!1;for(var a=this.getViewNode().getElements("[comp]"),b=0;b<a.length;b++)if(a[b].getLogic&&!a[b].getLogic().isDeleteable())return!1;return!0},isMultiSelectable:function(){return!0},_createClickOverlay:function(){if(this.injects().Viewer.isPublicMode()||this._debugMode)return this._socialOverlayElement&&this._socialOverlayElement.clear(),void 0;if(!this._socialOverlayElement){var a={};this._socialOverlayElement=new Element("A",a);var b=W.Config.getServiceTopologyProperty("staticThemeUrlWeb")+"/transparent.gif";this._socialOverlayElement.setStyles({position:"absolute",top:"0",left:"0",height:"100%",width:"100%",background:"transparent url("+b+") repeat top left;"}),this._socialOverlayElement.addEvent("click",function(a){a.stopPropagation();var b={component:this};this.injects().Commands.executeCommand("socialWidget.interact",b,this)}.bind(this)),this.getViewNode().adopt(this._socialOverlayElement)}},_getEditBoxReferenceNode:function(){return this._view},getShowOnAllPagesChangeability:function(){return this._showOnAllPagesChangeability},setShowOnAllPagesChangeability:function(a){this._showOnAllPagesChangeability=a},isSiteSegment:function(){return this.isInstanceOfClass("wysiwyg.viewer.components.SiteSegmentContainer")},_addToolTipToSkinPart:function(a,b){a&&a.getViewNode&&(a=a.getViewNode()),a.addEvent("mouseenter",function(){W.Commands.executeCommand("Tooltip.ShowTip",{id:b},a)}.bind(this)),a.addEvent("mouseleave",function(){W.Commands.executeCommand("Tooltip.CloseTip")}.bind(this))},canMoveToOtherScope:function(){return!0},disableReportLayoutChange:function(){},enableReportLayoutChange:function(){}})}),define.Class("core.managers.components.ComponentBuilder",function(a){var b=a;b.methods({initialize:function(a){this.data={},this.data.children=[],this.withNode(a)},_with:function(a,b){return this.data[a]=b,void 0===b&&delete this.data[a],this},withType:function(a){return this._with("type",a)._with("comp",a)},withData:function(a){var b="string"==typeof a?"dataQuery":"dataObject",c="string"!=typeof a?"dataQuery":"dataObject";return this._with(b,a)._with(c,void 0)},withChild:function(a){return this.data.children.push(a),this._appendChild(a),this},_appendChild:function(a){this.data.node.appendChild(a.data.node)},withNode:function(a){return this._with("node",this._createNodeWithUidSoMooToolsWouldNotStackEventsOnAllNodes(a)),0!=this.data.children.length&&this.data.children.forEach(function(a){this._appendChild(a)}.bind(this)),this},_createNodeWithUidSoMooToolsWouldNotStackEventsOnAllNodes:function(a){if(a||(a=W.Preview&&W.Preview.getPreviewSite?W.Preview.getPreviewSite().document.createElement("div"):document.createElement("div")),!a.uid){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"==a?b:8|3&b;return c.toString(16)});a.uid=b}return a},withUid:function(a){return this._with("uid",a)},withSkin:function(a){return this._with("skin",a)},withParentLogic:function(a){return this._with("parentLogic",a)},withSkinParamMapper:function(a){return this._with("skinParamMapper",a)},withDomIdPrefix:function(a){return this._with("domIdPrefix",a)},withArgs:function(a){return this._with("args",a)},onSkinRequest:function(a){return this.skinProvider=a,this},onCreated:function(a){return this.onCreatedCallback=a,this},create:function(){this._validate()&&this._setCreatedEvent()._wixifyNodeWithChildren()},_wixifyNodeWithChildren:function(){var a=this.data.children.filter(function(a){return!a._isWixified()}),b=a.map(function(a){return a.data.node});0!=a.length?(new Async.Bulk(b,null,{completeEvent:Constants.ComponentEvents.WIXIFIED,onComplete:function(){this._wixifyNode()}.bind(this)}),a.each(function(a){a.onError(this.onErrorCallback).create()}.bind(this))):this._wixifyNode()},onError:function(a){return this.onErrorCallback=a,this},_wixifyNode:function(){this._setNodeAttribute("comp")._setNodeAttribute("skin")._setNodeAttribute("dataQuery")._setNodeAttribute("propertyQuery")._setNodeAttribute("styleId")._setNodeAttribute("paddingBottom")._setNodeAttribute("minHeight"),this._setNodeLayout()._setNodeIds(),this.data.node.wixify(this.data.args,this.data.dataObject,this.data.domIdPrefix,void 0,this.data.skinParamMapper,this.data.parentLogic)},_setNodeIds:function(){return this.data.node.uid=this.data.uid||this.data.node.uid,this.data.node.id=this.data.htmlId||this.data.node.id,this},_setNodeLayout:function(){return this.data.layout?(this.data.node.setAttribute("x",this.data.layout.x),this.data.node.setAttribute("y",this.data.layout.y),this.data.node.setAttribute("width",this.data.layout.width),this.data.node.setAttribute("height",this.data.layout.height),this):this},_setNodeAttribute:function(a){return this.data[a]&&this.data.node.setAttribute(a,this.data[a]),this},_setCreatedEvent:function(){if("function"==typeof this.onCreatedCallback){var a=this.onCreatedCallback;this.data.node.addEvent(Constants.ComponentEvents.READY,function(){a(this.$logic,this)})}return this},_validate:function(){return this._validateType()&&this._validateSkin()&&this._validateNotWixified()},_validateType:function(){return this.data.type?!0:(this._callErrorHandler("you must set type before creating a component!"),!1)},_validateSkin:function(){return this.data.skin?!0:"function"==typeof this.skinProvider?this._validateSkinWithProvider():(this._callErrorHandler("you must set skin or set a skin-provider before creating a component!"),!1)},_validateSkinWithProvider:function(){var a=this.skinProvider();return a?(this.withSkin(a),!0):(this._callErrorHandler("skin-provider did not supply any skin"),!1)},_isWixified:function(){return!!this.data.node.$logic},_validateNotWixified:function(){return this._isWixified()?(this._callErrorHandler("you cannot create component on a wixified element"),!1):!0},_callErrorHandler:function(a){if("function"!=typeof this.onErrorCallback)throw a;this.onErrorCallback(a)}})}),define.Class("core.managers.component.ComponentDefinition",function(a){var b=a;b.inherits(a.constructor),b.methods({initialize:function(){a.constructor.apply(this),this._skinParts_=void 0,this._dataTypes_=void 0,this._states_=void 0,this._propertiesSchemaType_=void 0},skinParts:function(a){this._skinParts_=a},dataTypes:function(a){this._dataTypes_=a},states:function(a){this._states_=a},propertiesSchemaType:function(a){this._propertiesSchemaType_=a}})}),define.Class("core.managers.component.ComponentManager",function(a){var b=a;b.utilize(["bootstrap.utils.Queue","core.managers.component.ComponentDefinition","mobile.core.components.base.BaseComponent","core.managers.component.BaseCompSchemaGenerator"]),b.resources(["W.Classes"]),b.inherits("bootstrap.managers.BaseManager"),b.binds(["_onClassReady","getComponent"]),b.methods({initialize:function(){this._componentQue=new this.imports.Queue,this._componentMap={},this._componentDefinitions={},this._pendingComponentClassMap={},this.resource.getResources(["W.Classes","W.Experiments"],function(a){this._experimentManager=a.W.Experiments,this._classManager=a.W.Classes,this._classManager.addClassNamespaceHook(this.getComponent),this._classManager.addClassReadyHandler(this._onClassReady)}.bind(this)),this._componentMap["mobile.core.components.base.BaseComponent"]=this.imports.BaseComponent,this.define.component.definitionModifier=this._onCompDefineCallBack.bind(this)},_onCompDefineCallBack:function(a,b){var c=this._componentQue.getQueue(a);return c&&c.length>0&&this.registerNewComponent(a,b),b},registerNewComponent:function(a,b){var c=new this.imports.ComponentDefinition;b(c,c._inheritStrategy_),c=this._experimentManager.applyExperiments(a,c),c=this._fixCompDefinition(a,c),this._validateNewComponent(a,c),this._pendingComponentClassMap[a]="pending",this._componentDefinitions[a]=c,this._classManager.registerClassDefinition(a,c)},_validateNewComponent:function(a){return this._componentMap[a]?(LOG.reportError(wixErrors.CM_NAME_ALREADY_EXIST,this.className,"newComponent",a)(),void 0):void 0},_fixCompDefinition:function(a,b){var c=b._imports_||[];if(b._skinParts_){var d=b._skinParts_||{};for(var e in d)if(d[e]){var f=d[e].type;if(f&&f!=Constants.ComponentPartTypes.HTML_ELEMENT&&c.indexOf(f)<0){var g=this.getNameOverride(f);c.push(g)}}b._fields_._skinPartsSchema=d}b.utilize(c),b._fields_._propertiesSchemaName=b._propertiesSchemaType_,b._dataTypes_&&(b._methods_.getAcceptableDataTypes=function(){return b._dataTypes_}),b._states_&&(b._fields_._states=b._states_);var h=b._methods_.onComponentReady;return h&&this._componentQue.add(a,h),b},newComponent:function(a){this.define.oldComponent(a)},_buildCompClassData:function(a,b,c,d){return{name:a,traits:b(),imports:c(),Class:d()}},_validateComponent:function(a,b,c,d,e){if(this._componentMap[a])return LOG.reportError(wixErrors.CM_NAME_ALREADY_EXIST,this.className,"_validateComponent > is new",a)(),!1;var f=e().Extends;return instanceOf(f,String)?!0:(LOG.reportError(wixErrors.CM_NO_EXTEND,this.className,"_validateComponent > has inherits",a)(),void 0)},_addImportsToCompClass:function(a,b){var c=b.imports||[],d=a&&a.skinParts||{};for(var e in d){var f=d[e].type;f&&f!=Constants.ComponentPartTypes.HTML_ELEMENT&&c.indexOf(f)<0&&c.push(f)}b.imports=c},override:function(a,b){if(!a)throw new Error("null/undefined component name for override");this._componentMap[a]=b},getComponent:function(a,b){if(a=this.getNameOverride(a),this._componentMap[a])return W.Utils.callLater(b,[this._componentMap[a]]),this._componentMap[a];var c=this.define.getDefinition("component"),d=nsUtil.getNameSpace(c,a),e=this._componentQue.hasQueue(a)===!1;return this._componentQue.add(a,b),e&&(d?this.registerNewComponent(a,d):this._classManager.getClass(a,function(){})),null},getNameOverride:function(a){return this.define.Class.$nameOverrides[a]||a},_onClassReady:function(a,b){return this._pendingComponentClassMap[a]?(this._onComponentClassReady(b,a),void 0):(this._componentQue.removeKey(a),void 0)},_onComponentClassReady:function(a,b){b=a.$originalClassName,this._componentMap[b]=a;var c=this._componentDefinitions[b];this.imports.BaseCompSchemaGenerator.generateComponentSchema(a,c);var d=this._componentQue.getQueue(b);d.forEach(function(a){a&&a(this._componentMap[b])}.bind(this)),this._componentQue.removeKey(b)},createComponent:function(a,b,c,d,e,f,g,h,i,j){if(a&&"object"==typeOf(a)){var k=a;a=k.type,b=k.skin||b,c=k.data||c,d=k.args||d,e=k.wixifyCallback||e,f=k.componentReadyCallback||f,g=k.domIdPrefix||g,h=k.compNode||h,j=k.innerStyle||k.skinParamMapper}if(!a||"string"!=typeOf(a))return LOG.reportError(wixErrors.CM_LOGIC_TYPE,this.className,"createComponent","created from:"+this.className),new Element("span");var l={comp:a,skin:b};if(c){var m=typeof c;"string"==m?(l.dataQuery=c,c=null):"object"==m&&(c._dataType||LOG.reportError(wixErrors.WIXIFY_MISSING_DATA_TYPE,this.className,"createComponent","created from:"+this.className))}return h?h.setProperties(l):h=new Element("div",l),e&&"function"==typeof e&&h.addEvent("wixified",function(){e(h.getLogic())}),f&&"function"==typeof f&&h.addEvent(Constants.ComponentEvents.READY,function(){h.removeEvent(Constants.ComponentEvents.READY,arguments.callee),f(h.getLogic())}),c&&c._dataType?h.wixify(d,c,g,i,j):h.wixify(d,null,g,i,j),h},isReady:function(){return!0}})}),define.experimentPlugin("ExperimentComponentPlugin",function(a){function b(a,b){resource.getResourceValue("W.Classes",function(a){a.getClass("core.managers.component.ComponentDefinition",function(a){d=a})});var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),e=a;"function"==typeof a&&(e=new d,a(e));var f=new d;return b(f,c),e.inherits(f._extends_||e._extends_),e.resources(c._mergeField_(e._resources_,f._resources_)),e.binds(c._mergeField_(e._binds_,f._binds_)),e.traits(c._mergeField_(e._traits_,f._traits_)),e.utilize(c._mergeField_(e._imports_,f._imports_)),e.statics(c._mergeObjects_(e._statics_,f._statics_)),e.fields(c._mergeObjects_(e._fields_,f._fields_)),e.methods(c._mergeObjects_(e._methods_,f._methods_)),e.skinParts(c._mergeField_(e._skinParts_,f._skinParts_)),e.states(c._mergeField_(e._states_,f._states_)),e.dataTypes(c._mergeField_(e._dataTypes_,f._dataTypes_)),e.propertiesSchemaType(f._propertiesSchemaType_||e._propertiesSchemaType_),e}function c(a,b){define.component(a,b)}var d,e=a;e.init("component","newComponent",b,c)}),define.Const("components",{DEFAULT_PREFIX:"c",BASE_LIST_ITEM_PREFIX:"bli"}),define.Class("core.managers.componentlifecyclemanager.ComponentInfo",function(a){var b=a;b.statics({STATES:{INITIATED:"initiated",MEASURED:"measured",READY:"ready",ERROR:"error_in_comp",PAUSED:"paused"}}),b.fields({component:null,state:"",isDisplayed:!1,isDisplayedBefore:!1,error:null,parentComp:null,childComps:{}}),b.methods({initialize:function(a){this.component=a,this.state=this.STATES.INITIATED,this.childComps={}}})}),define.Class("core.managers.componentlifecyclemanager.ComponentLifecycleManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["core.managers.componentlifecyclemanager.ReflowTimer","core.managers.componentlifecyclemanager.ComponentMeasurer","core.managers.componentlifecyclemanager.ComponentRenderer","core.managers.componentlifecyclemanager.ComponentInfo"]),b.binds(["_beforeReflow","_afterReflow"]),b.statics({PHASES:{MEASURE_INITIATED:"measureInitiatedComps",MEASURE:"measure",COLLECT_RENDER_COMPS:"collectCompsForRender",RENDER:"render"}}),b.methods({initialize:function(){this._registeredComponents={};var a=this.imports.ReflowTimer;this._reflowTimer=new a,this._reflowTimer.on(a.REFLOW_EVENTS.BEFORE_REFLOW,this,this._beforeReflow),this._reflowTimer.on(a.REFLOW_EVENTS.AFTER_REFLOW,this,this._afterReflow),this._reflowTimer.on(a.REFLOW_EVENTS.IDLE,this,this._onIdle),this._forceReflowsXMoreTimes=0,this._compMeasurer=new this.imports.ComponentMeasurer(this),this._compRenderer=new this.imports.ComponentRenderer(this),this.ComponentInfo=this.imports.ComponentInfo,this.run()},run:function(){this._reflowTimer.run()},pause:function(){this._reflowTimer.stop()},forceRender:function(a){a||0===a||(a=5),this._forceReflowsXMoreTimes=Math.max(a-1,this._forceReflowsXMoreTimes),this._reflowTimer.forceReflow()},_beforeReflow:function(){this._compRenderer.updateLayoutForDisplayedComps(),this._compRenderer.renderComponents()},_afterReflow:function(){this._compMeasurer.invalidateDisplayAndMeasureAllDisplayedComponents()},_onIdle:function(){this._forceReflowsXMoreTimes>0&&(this._forceReflowsXMoreTimes--,this.forceRender(this._forceReflowsXMoreTimes))},registerComponent:function(a,b){var c=a.getComponentId();if(this._registeredComponents[c])return LOG.reportError(wixErrors.COMPONENT_ALREADY_REGISTERED_IN_LIFECYCLE,"ComponentLifecycleManager","registerComponent",c),void 0;var d=new this.ComponentInfo(a);return this._registeredComponents[c]=d,a.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._componentExterminated),b&&this._renderImmediate(d),this.forceRender(),d},_renderImmediate:function(){},getComponentInfo:function(a,b){var c=a.getComponentId();return this._registeredComponents[c]?this._registeredComponents[c]:(!b&&LOG.reportError(wixErrors.COMPONENT_NOT_REGISTERED_IN_LIFECYCLE,"ComponentLifecycleManager",c),null)},getAllComponentsInfo:function(){return this._registeredComponents},setParentComponentProcess:function(a,b){var c=a.getComponentId(),d=this.getComponentInfo(a,!0),e=this.getComponentInfo(b,!0);e&&d&&(this.removeChildComponentProcess(a),e.childComps[c]=d,d.parentComp=e)},removeChildComponentProcess:function(a){var b=this.getComponentInfo(a,!0),c=b&&b.parentComp;if(c){var d=a.getComponentId();delete c.childComps[d],b.parentComp=null}},getComponentChildList:function(a,b,c){c=c||[];var d=a.childComps;for(var e in d){var f=d[e];f&&(b&&this.getComponentChildList(f,!0,c),c.push(f))}return c},_onComponentError:function(a,b,c){a.component,a.state=a.STATES.ERROR,a.error=b,this._errorHandler&&this._errorHandler(a,b,c)},_componentExterminated:function(a){var b=a.target,c=b.getComponentId(),d=this._registeredComponents[c];d&&(this.removeChildComponentProcess(d.component),delete this._registeredComponents[c])},setComponentErrorHandler:function(a){this._errorHandler=a},clone:function(a){return this._reflowTimer.stop(),this.parent(a)},"@testRenderNow":function(a){if(!a)throw'specified null for required arg "component"';this._compRenderer.runRender([a])}})}),define.Class("core.managers.componentlifecyclemanager.ComponentMeasurer",function(a){var b=a;b.methods({initialize:function(a){this._compLC=a},invalidateDisplayAndMeasureAllDisplayedComponents:function(){this._markAllCompsAsNotDisplayed(),this._runMeasureForFirstTimeInitiatedComps();var a=this._getDisplayedCompList(document.body);this.measureComponents(a),this._invalidateAllDisplayModifiedComps()},measureComponents:function(a){var b,c,d;if(a.length)try{for(b=0;b<a.length;++b)c=a[b],d=this._compLC.getComponentInfo(c),d.isDisplayed=!0,this._measureComponent(d)}catch(e){a.splice(0,b+1),this._compLC._onComponentError(d,e,this._compLC.PHASES.MEASURE),a.length>0&&this.measureComponents(a)}},_measureComponent:function(a){var b=a.component;if(b._skinParts){b._invalidations_.clearInvalidationType(b.INVALIDATIONS.SIZE),b._invalidations_.clearInvalidationType(b.INVALIDATIONS.POSITION);for(var c in b._skinParts){var d=this._getNodeForMeasure(b._skinParts[c]);if(d){var e=this._getOldMeasure(d),f=this._getNewMeasure(d);d.$measure=f,this._invalidateSizeIfChanged(b,c,d,f,e),this._invalidatePositionIfChanged(b,c,d,f,e)}}b.isInvalidated([b.INVALIDATIONS.SIZE,b.INVALIDATIONS.POSITION])&&b.reportLayoutChange()}b.trigger(Constants.LifecycleSteps.MEASURE)},_getNodeForMeasure:function(a){return a instanceof HTMLElement?a:a.getViewNode instanceof Function?a.getViewNode():null},_getOldMeasure:function(a){return a.$measure||{width:0,height:0,top:0,left:0}},_getNewMeasure:function(a){var b=a.getSize(),c=a.getPosition(a.parentNode);return{width:b.x,height:b.y,top:c.y,left:c.x}},_invalidateSizeIfChanged:function(a,b,c,d,e){if(d.width!==e.width||d.height!==e.height){var f="view"===b?a.INVALIDATIONS.SIZE:a.INVALIDATIONS.PART_SIZE;a.invalidate(f,{current:d,old:e,partName:b,reference:c},!0)}},_invalidatePositionIfChanged:function(a,b,c,d,e){if(d.top!==e.top||d.left!==e.left){var f="view"===b?a.INVALIDATIONS.POSITION:a.INVALIDATIONS.PART_POSITION;a.invalidate(f,{current:d,old:e,partName:b,reference:c},!0)}},_markAllCompsAsNotDisplayed:function(){var a=this._compLC.getAllComponentsInfo();for(var b in a){var c=a[b];c.isDisplayedBefore=c.isDisplayed,c.isDisplayed=!1}},_runMeasureForFirstTimeInitiatedComps:function(){var a=this._compLC.getAllComponentsInfo();for(var b in a){var c=a[b];if(c.state===c.STATES.INITIATED)try{c.state=c.STATES.MEASURED,this._measureComponent(c)}catch(d){this._compLC._onComponentError(c,d,this._compLC.PHASES.MEASURE_INITIATED),this._runMeasureForFirstTimeInitiatedComps()}}},_invalidateAllDisplayModifiedComps:function(){var a=this._compLC.getAllComponentsInfo();for(var b in a){var c=a[b];if(c.isDisplayedBefore!==c.isDisplayed){var d=c.component;d.invalidate(d.INVALIDATIONS.DISPLAY,{current:c.isDisplayed})}}},_getDisplayedCompList:function(a,b){b=b||[];var c=this._isNodeDisplayed(a);if(c)for(var d=a.childNodes,e=0;e<d.length;++e)this._getDisplayedCompList(d[e],b);if(c&&a.$logic){var f=a.$logic,g=f.getComponentId(),h=this._compLC.getAllComponentsInfo(),i=h[g];i&&b.push(f)}return b},_isNodeDisplayed:function(a){if(!a.style)return!1;var b=a.style.display,c=a._displayed_;if(b)return"none"!==b.toLowerCase();if(a.classList.contains("hidden"))return!1;if(c)return c;var d=a.getComputedStyle("display");return"none"!==d.toLowerCase()}})}),define.Class("core.managers.componentlifecyclemanager.ComponentRenderer",function(a){var b=a;b.methods({initialize:function(a){this._compLC=a},renderComponents:function(){this._collectCompListForRender(),this.runRender(this._compsForRender)},runRender:function(a){var b,c,d;if(a.length)try{for(b=0;b<a.length;++b)c=a[b],d=this._compLC.getComponentInfo(c),this._renderComponent(d)}catch(e){a.splice(0,b+1),this._compLC._onComponentError(d,e,this._compLC.PHASES.RENDER),a.length>0&&this.runRender(a)}},_renderComponent:function(a){var b=a.component,c={invalidations:b._invalidations_};b._invalidations_=new b.imports.InvalidationCollector,b.trigger(Constants.LifecycleSteps.RENDER,c),a.state===a.STATES.MEASURED&&(a.state=a.STATES.READY,b.trigger(Constants.LifecycleSteps.FIRST_RENDER,c))},updateLayoutForDisplayedComps:function(){var a=this._compLC.getAllComponentsInfo();for(var b in a){var c=a[b];c.isDisplayed&&this._updateCompLayout(c.component)}},_updateCompLayout:function(a){var b=this._getComponentResizeData(a);if(b)for(var c in b){var d=b[c];switch(c){case"width":a._setWidth_(d);break;case"height":a._setHeight_(d);break;case"x":a._setX_(d);break;case"y":a._setY_(d)}}},_getComponentResizeData:function(a){return this._getLayoutChangeData({width:a.getLastInvalidationByType(a.INVALIDATIONS.WIDTH_REQUEST),height:a.getLastInvalidationByType(a.INVALIDATIONS.HEIGHT_REQUEST),x:a.getLastInvalidationByType(a.INVALIDATIONS.X_REQUEST),y:a.getLastInvalidationByType(a.INVALIDATIONS.Y_REQUEST)})},_getLayoutChangeData:function(a){var b;for(var c in a){var d=a[c];d&&!d._used_&&(d._used_=!0,b=b||{},b[c]=d[c])}return b},_collectCompListForRender:function(a){var b,c=a?a.compList:[],d=a?a.checkedCompIds:{},e=function(a){b=a;var e=a.component,f=e.getComponentId();d[f]=!0,this._isComponentReadyForRender(b)&&c.push(e)}.bind(this);try{var f=this._compLC.getAllComponentsInfo();for(var g in f)if(!d[g]){var h=f[g],i=this._compLC.getComponentChildList(h,!0);i.forEach(e),e(h)}}catch(j){this._compLC._onComponentError(b,j,this.PHASES.COLLECT_RENDER_COMPS),this._collectCompListForRender({compList:c,checkedCompIds:d})}this._compsForRender=c},_isComponentReadyForRender:function(a){var b=a.component;return a.state===a.STATES.MEASURED||a.state===a.STATES.READY&&b.isRenderNeeded(b._invalidations_)}})}),define.Class("core.managers.componentlifecyclemanager.ReflowTimer",function(a){var b=a;b.inherits("bootstrap.managers.events.EventDispatcher"),b.resources(["W.Utils"]),b.binds(["_beforeReflow","_onIdleDone"]),b.statics({REFLOW_EVENTS:{IDLE:"idle",BEFORE_REFLOW:"beforeReflow",AFTER_REFLOW:"afterReflow"}}),b.methods({initialize:function(){this._isRunning=!1,this._isInIdleMode=!1,this._idleFPS=.2},run:function(a){this._isRunning||(this._idleFPS=a||this._idleFPS,this._isRunning=!0,this._listenForNextReflow())},stop:function(){this._isRunning=!1,this._stopListening(),this._removeTestNode()},forceReflow:function(){this._isInIdleMode&&(this._stopListening(),this._isInIdleMode=!1,this._forceReflowTimeoutIndex=this.resources.W.Utils.callLater(this._onIdleDone,[],this,0))},_listenForNextReflow:function(){this._beforeReflowTimoutIndex=this.resources.W.Utils.callOnNextRender(this._beforeReflow)},_listenForAfterReflow:function(){this._isReflowTestNodeValid()?this._afterReflow():this._checkReflowTimoutIndex=this.resources.W.Utils.callLater(this._listenForAfterReflow,[],this,0)},_stopListening:function(){this.resources.W.Utils.clearOnNextRender(this._beforeReflowTimoutIndex),this.resources.W.Utils.clearCallLater(this._checkReflowTimoutIndex),this.resources.W.Utils.clearCallLater(this._idleTimoutIndex),this.resources.W.Utils.clearCallLater(this._forceReflowTimeoutIndex)},_beforeReflow:function(){this._isRunning&&(this.trigger(this.REFLOW_EVENTS.BEFORE_REFLOW),this._updateReflowTestNode(),this._setIdleDelay())},_afterReflow:function(){this._isRunning&&(this.trigger(this.REFLOW_EVENTS.AFTER_REFLOW),this._listenForNextReflow())},_setIdleDelay:function(){var a=1e3/this._idleFPS;this._isInIdleMode=!0,this._idleTimoutIndex=W.Utils.callLater(this._onIdleDone,[],this,a),this.trigger(this.REFLOW_EVENTS.IDLE)},_onIdleDone:function(){this._stopListening(),this._isInIdleMode=!1,this._listenForAfterReflow()},_updateReflowTestNode:function(){this._textNode||(this._reflowTestConNode=new Element("div",{id:"ReflowTestContainer"}).setStyles({width:"1px",height:"1px",overflow:"hidden"}),this._textNode=new Element("div",{id:"ReflowTestNode"}).setStyles({width:"10px",height:"0px"}),this._textNodeInnerDiv=new Element("div",{id:"ReflowTextInnerNode"}).setStyles({width:"10%"}),this._textNode.adopt(this._textNodeInnerDiv),this._reflowTestConNode.adopt(this._textNode),document.body.adopt(this._reflowTestConNode));var a=parseInt(this._textNode.getStyle("width"),10)+10;this._reflowTextExpectedWidth=.1*a,this._textNode.setStyle("width",a+"px")},_removeTestNode:function(){this._textNode&&(this._textNode.parentNode&&this._textNode.parentNode.removeChild(this._textNode),this._reflowTestConNode.parentNode&&this._reflowTestConNode.parentNode.removeChild(this._reflowTestConNode),delete this._textNode,delete this._reflowTestConNode,delete this._reflowTextExpectedWidth)},_isReflowTestNodeValid:function(){return this._textNodeInnerDiv.offsetWidth==this._reflowTextExpectedWidth}})}),define.Const("LifecycleSteps",{FIRST_RENDER:"firstRender",RENDER:"render",MEASURE:"measure"}),function(){var a=null;define.Class("core.managers.css.CssManager",function(b){var c=b;c.inherits("bootstrap.managers.BaseManager"),c.binds(["_onThemePropertyChange","updateAllThemeCss"]),c.statics({GLOBAL_THEME_CSS_TYPES:["font","color"],FONT_SERVICE_URL:"http://fonts.googleapis.com/css?family="}),c.methods({initialize:function(){this._themeStyleSheet=this._generateThemeStylesSheet(),this._addWixSiteOnlyFonts(),this._configureSystemFonts(),this._configureCustomFonts(),this.resource.getResourceValue("W.Theme",function(a){this._themeManager=a,a.addEvent("propertyChange",this._onThemePropertyChange),a.isDataReady()?this.updateAllThemeCss():a.addEvent("dataReady",this.updateAllThemeCss)}.bind(this))},_configureSystemFonts:function(){this._systemFontsCssDefinition={},this._systemFontsNames=[];for(var a in Constants.CSS.SYSTEM_FONTS)for(var b=Constants.CSS.SYSTEM_FONTS[a],c=0;c<b.length;++c){var d=b[c],e="array"==typeOf(d)?d[0]:d;this._systemFontsNames.push(e);var f="array"==typeOf(d)?d.concat().reverse():[d];f.push(a),this._addQuoteToArrayElementsIfContainSpaces(f),this._systemFontsCssDefinition[e]=f.join(",")}},_configureCustomFonts:function(){this._customFontsCssDefinition={},this._customFontsNames=[];for(var a in Constants.CSS.CUSTOM_FONTS)for(var b=Constants.CSS.CUSTOM_FONTS[a],c=0;c<b.length;++c){var d=b[c],e="array"==typeOf(d)?d[0]:d;this._customFontsNames.push(e);var f="array"==typeOf(d)?d.concat().reverse():[d];f.push(a),this._addQuoteToArrayElementsIfContainSpaces(f),this._customFontsCssDefinition[e]=f.join(",")}},_addQuoteToArrayElementsIfContainSpaces:function(a){for(var b=0;b<a.length;++b)a[b].indexOf(" ")&&(a[b]='"'+a[b]+'"')},_onThemePropertyChange:function(a){var b=this._themeManager.getPropertyType(a.name);this.GLOBAL_THEME_CSS_TYPES.contains(b)&&this._updateThemeGlobalCssByPropertyName(a.name,b)},updateAllThemeCss:function(){for(var a=0;a<this.GLOBAL_THEME_CSS_TYPES.length;++a)for(var b=this.GLOBAL_THEME_CSS_TYPES[a],c=this._themeManager.getPropertiesAccordingToType(b),d=0;d<c.length;++d)this._updateThemeGlobalCssByPropertyName(c[d],b)},_updateThemeGlobalCssByPropertyName:function(a,b){var c=this.getThemeGlobalPropertyCssRules(a,b);if(c.forEach(function(a){this._themeStyleSheet.updateRule(a.selector,a.rules)},this),"font"==b){var d=this._themeManager.getProperty(a).getFontFamily(),e=this.getFontType(d);"custom"==e&&this.loadFont(d)}},getThemeGlobalPropertyCssRules:function(a,b,c){b=b||this._themeManager.getPropertyType(a);var d=this._themeManager.getProperty(a),e=[];switch(b){case"font":var f="."+a,g="";g=c?"font: "+d.getCssValue():d.getCssRule(),e.push({selector:f,rules:g});break;case"color":var h="."+a,i="color:"+d.getHex(!1),j=".back"+a,k="background-color:"+d.getHex(!1);e.push({selector:h,rules:i}),e.push({selector:j,rules:k})}return e},getThemeGlobalPropertyCssDefinition:function(a,b,c){b=b||this._themeManager.getPropertyType(a);var d,e=this._themeManager.getProperty(a),f="";switch(b){case"font":d="."+a,f=c?"font: "+e.getCssValue():e.getCssRule();break;case"color":d="."+a,f="color:"+e.getHex(!1)}return{selector:d,rules:f}},_generateThemeStylesSheet:function(){return a||(a=W.Utils.createStyleSheet("WIX_THEME_STYLES")),this._themeStyleNodeId=a.styleNode.get("id"),a},getCssNodeId:function(){return this._themeStyleNodeId},getDefaultFont:function(){var a=Constants.CSS.SYSTEM_FONTS["sans-serif"][0];return a="array"===typeOf(a)?a[0]:a},getFontFallbacksCss:function(a){return this._systemFontsCssDefinition[a]||this._customFontsCssDefinition[a]||'"'+a+'"'},getFontList:function(){return[].concat(this._systemFontsNames,this._customFontsNames).sort()},getFontsListSpriteUrl:function(){return"richtext/fonts.png"},getFontType:function(a){return-1!=this._systemFontsNames.indexOf(a)?"system":-1!=this._customFontsNames.indexOf(a)?"custom":null},getUsedFontsUrl:function(){for(var a=this._themeManager.getPropertiesAccordingToType("font"),b={},c=0;c<a.length;++c){var d=this._themeManager.getProperty(a[c]).getFontFamily();"custom"==this.getFontType(d)&&(b[d]=d)}return this.FONT_SERVICE_URL+this._getFontsQuery(b)},loadFont:function(a){this._readyFonts=this._readyFonts||{},this._loadedFonts=this._loadedFonts||{};var b=-1!=this._customFontsNames.indexOf(a),c=this._readyFonts[a],d=this._loadedFonts[a];!b||c||d||(this._loadedFonts[a]=a,this._fontLoadCallLater||(this._fontLoadCallLater=W.Utils.callLater(this._loadFonts,void 0,this,50)))},_loadFonts:function(){delete this._fontLoadCallLater;var a=this._getFontsUrl(this._loadedFonts);for(var b in this._loadedFonts)this._readyFonts[b]=b,delete this._loadedFonts[b];this._addFontsLoaderCssTag(a)},getCustomUsedFontsUrl:function(){return this._readyFonts&&0!=Object.keys(this._readyFonts).length?{missingFontsNames:this._readyFonts,missingFontsUrl:this._getFontsUrl(this._readyFonts)}:null},getFontUrl:function(a){if(this._customFontsNames.indexOf(a)<0)return null;var b={};return b[a]=1,this._getFontsUrl(b)},_getFontsUrl:function(a){return this.FONT_SERVICE_URL+this._getFontsQuery(a)},_getFontsQuery:function(a){fontQuery="";for(var b in a)fontQuery+=b.split(" ").join("+"),fontQuery+=":n,b,i,bi|";return fontQuery},_addFontsLoaderCssTag:function(a){if(0===$$("[href="+a+"]").length){var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.href=a;var c=document.getElementsByTagName("link")[0];c.parentNode.insertBefore(b,c)
}},_addWixSiteOnlyFonts:function(){if(window.rendererModel&&"WixSite"===rendererModel.documentType){this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Meiryo","メイリオ","ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Italic"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["Helvetica Neue Medium"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-UltLt"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-UltLt"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-25UltL"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-35Thin"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-45Ligh"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-65Medi"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-75Bold"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW01-95Blac"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW02-95Blac"]),this._pushUnique(Constants.CSS.SYSTEM_FONTS["sans-serif"],["HelveticaNeueW10-95Blac"]);var a=this.getHelveticaCssUrl();a&&this._addFontsLoaderCssTag(a)}},getHelveticaCssUrl:function(){return window.rendererModel&&"WixSite"===rendererModel.documentType?window.serviceTopology.publicStaticsUrl+"/css/Helvetica/fontFace.css":null},_pushUnique:function(a,b){var c=this._doesArrayExistInArrayOfArrays(a,b);c||a.push(b)},_doesArrayExistInArrayOfArrays:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.length===b.length)for(var e=0;e<b.length&&d[e]===b[e];e++)if(e===b.length-1)return!0}return!1},clone:function(a){return this.parent(a)},isReady:function(){return!0}})})}(),define.Const("CSS",{COLORS:["transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],SYSTEM_FONTS:{"sans-serif":[["Arial","Helvetica"],["Arial Black","Gadget"],["Impact","Charcoal"],["Lucida Sans Unicode","Lucida Grande"],["Tahoma","Geneva"],["Verdana","Geneva"]],serif:["Georgia",["Palatino Linotype","Book Antiqua","Palatino"],["Times New Roman","Times"]],cursive:["Comic Sans MS"],monospace:["Courier New",["Lucida Console","Monaco"]]},CUSTOM_FONTS:{"sans-serif":["Anton","Basic","Jockey One","Jura","Open Sans","Overlock","Play","Signika","Spinnaker","Chelsea Market"],serif:["Caudex","EB Garamond","Enriqueta","Forum","Noticia Text","Fredericka the Great","Kelly Slab","Josefin Slab"],cursive:["Lobster","Niconne","Marck Script","Mr De Haviland","Patrick Hand","Sarina","Corben"],monospace:[]}}),define.Const("FONT_METADATA",{fonts:{"Abril Fatface":{typeface:"serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Alex Brush":{typeface:"cursive",provider:"google",characterSets:["latin"],permissions:"all"},"Amatic SC":{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Anton:{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Arial:{typeface:"sans-serif",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Courier New":{typeface:"monospace",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Arial Black":{typeface:"sans-serif",provider:"system",characterSets:["latin","cyrillic"],permissions:"all"},Bangers:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Basic:{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Black Ops One":{typeface:"fantasy",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Caudex:{typeface:"serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Chelsea Market":{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},"Comic Sans MS":{typeface:"cursive",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Cookie:{typeface:"cursive",provider:"google",characterSets:["latin"],permissions:"all"},Corben:{typeface:"serif",provider:"google",characterSets:["latin"],permissions:"all"},Cutive:{typeface:"serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"EB Garamond":{typeface:"serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Enriqueta:{typeface:"serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Fjalla One":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},Forum:{typeface:"serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Fredricka the Great":{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Georgia:{typeface:"serif",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Glegoo:{typeface:"serif",provider:"google",characterSets:["latin"],permissions:"all"},"Gravitas One":{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Impact:{typeface:"sans-serif",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Jockey One":{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Josefin Slab":{typeface:"serif",provider:"google",characterSets:["latin"],permissions:"all"},Jura:{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Kelly Slab":{typeface:"fantasy",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Lato Normal 400":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Lato Ultra-Light 100":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Lucida Console":{typeface:"monospace",provider:"system",characterSets:["latin","latin-ext"],permissions:"all"},"Lucida Sans Unicode":{typeface:"sans-serif",provider:"system",characterSets:["latin"],permissions:"all"},"Marck Script":{typeface:"cursive",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Lobster:{typeface:"cursive",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Megrim:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Monoton:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},"Montserrat Alternates":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Mr De Haviland":{typeface:"cursive",provider:"google",characterSets:["latin"],permissions:"all"},Niconne:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},"Nixie One":{typeface:"cursive",provider:"google",characterSets:["latin"],permissions:"all"},"Noticia Text":{typeface:"serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},"Open Sans":{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Open Sans Condensed Book 300":{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Oranienbaum:{typeface:"serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"orbitron normal 400":{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Overlock:{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Palatino Linotype":{typeface:"serif",provider:"system",characterSets:["latin","latin-ext"],permissions:"all"},"Patrick Hand":{typeface:"cursive",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Play:{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Raleway Ultra-bold 900":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Raleway Ultra-Light 100":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Roboto Slab Ultra-Light 100":{typeface:"serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Rye:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Sacramento:{typeface:"cursive",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Sarina:{typeface:"cursive",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Signika:{typeface:"sans-serif",provider:"google",characterSets:["latin","latin-ext"],permissions:"all"},Spinnaker:{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},Tahoma:{typeface:"sans-serif",provider:"system",characterSets:["latin","latin-ext"],permissions:"all"},"Times New Roman":{typeface:"serif",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},"Roboto Slab Normal 400":{typeface:"serif",provider:"google",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Ultra:{typeface:"fantasy",provider:"google",characterSets:["latin"],permissions:"all"},Verdana:{typeface:"sans-serif",provider:"system",characterSets:["latin","latin-ext","cyrillic"],permissions:"all"},Voltaire:{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Wire One":{typeface:"sans-serif",provider:"google",characterSets:["latin"],permissions:"all"},"Helvetica 45 Light":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica 65 Med":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica 75 Bold":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica 95 Black":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica Thin":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica UltLt":{typeface:"sans-serif",provider:"monotype",characterSets:["latin"],permissions:"studio"},"Helvetica 45 Light Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica 65 Med Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica 75 Bold Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica 95 Black Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica Thin Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica UltLt Latin Ext":{typeface:"sans-serif",provider:"monotype",characterSets:["latin-ext"],permissions:"studio"},"Helvetica 45 Light Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},"Helvetica 65 Med Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},"Helvetica 75 Bold Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},"Helvetica 95 Black Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},"Helvetica Thin Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},"Helvetica UltLt Cyrillic":{typeface:"sans-serif",provider:"monotype",characterSets:["cyrillic"],permissions:"studio"},Meiryo:{typeface:"sans-serif",provider:"system",characterSets:[],permissions:"studio"}}}),define.Class("core.managers.data.ComponentDataManager",function(a){var b=a;b.utilize(["core.managers.data.PropertiesItem"]),b.inherits("core.managers.data.DataManager"),b.fields({DEFINE_NAMESPACE:"dataPropertyItem"}),b.methods({initialize:function(){this._PropertiesItem=this.imports.PropertiesItem,this.parent()},addDataItem:function(a,b,c){var d=this.createDataItem(b,c);return d._data.id=a,this.dataMap[a]=d,this._runCallbacks(a,d),this.markDirtyObject(d),d},createDataItem:function(a,b){var c=a.type,d=this.getDataTypeSchema(c);return d?new this._PropertiesItem(d,a,this,b):new this._DataItemBase(a,this)}})}),define.Class("core.managers.data.DataItemBase",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.binds(["fireDataChangeEvent"]),b.statics({METADATA_DEFAULTS:{isPreset:!1,isHidden:!1,description:"",isPersistent:!0},getFieldsFilterArray:function(a){return"array"==typeOf(a)?a:Object.keys(a)}}),b.methods({initialize:function(a,b){if(this._data=a,a.type&&"string"!=typeof a.type)throw"invalid data type. must be string";this._dataType=a.type,this._dataManager=b||this.injects().Data,this.componentsWithInterest=[]},setData:function(a,b){var c=this._data,d=this._data!==a;this._data=a,this._dataType=a.type,d&&!b&&this.fireDataChangeEvent(void 0,a,c)},setFields:function(a,b){var c={},d={},e=this._data;Object.forEach(a,function(a,b){e[b]!==a&&(c[b]=e[b],d[b]=a),this.set(b,a,!0)}.bind(this)),Object.keys(c).length>0&&this.fireDataChangeEvent(d,d,c,b)},setMeta:function(a,b,c){if(a in this.METADATA_DEFAULTS){if(this._data.metaData=this._data.metaData||{},this._data.metaData[a]=b,c){var d={key:b},e={};this.fireDataChangeEvent(d,e)}}else LOG.reportError(wixErrors.INVALID_METADATA_FIELD,"DataItemBase","setMeta",a)()},set:function(a,b,c,d,e){if(b=this.injects().Utils.sanitizeUnicode(b),this._data[a]!==b){var f=this._getDataOldValue(a,e);if(this._data[a]=b,this.setMeta("isPreset",!1),!c){var g={};g[a]=b,this.fireDataChangeEvent(a,g,f,d)}}},_getDataOldValue:function(a,b){if(!b){var b={};b[a]=this._data[a]}return b},getFields:function(a){var b={},c=this.getFieldsFilterArray(a);return c.forEach(function(a){b[a]=this.get(a)}.bind(this)),b},getData:function(){return this._data},getType:function(){return this._data.type},getMeta:function(a){if(a in this.METADATA_DEFAULTS){var b=this._data.metaData&&this._data.metaData[a];return void 0!==b?b:this.METADATA_DEFAULTS[a]}LOG.reportError(wixErrors.INVALID_METADATA_FIELD,"DataItemBase","getMeta",a)()},get:function(a){var b=this._data[a];return"string"==typeof b&&(b=this._sanitizeString(b)),b},_sanitizeString:function(a){return a.replace(/[\u0080\u0099\u009C]/g,"")},fireDataChangeEvent:function(a,b,c,d,e){this.markDataAsDirty();var f=void 0!==a?[this,a,b,c]:[this];this.fireEvent(Constants.DataEvents.DATA_CHANGED,f),this._dataManager.reportDataItemChangeEvent(this,b,c,d,e)},markDataAsDirty:function(){this.getMeta("isPersistent")!==!1&&(this._dataManager.markDirtyObject(this),this._dataManager.flagDataChange())},toString:function(){return"[Data Object]"},getDataManager:function(){return this._dataManager},addComponentWithInterest:function(a){this.componentsWithInterest.include(a)},removeComponentWithInterest:function(a){this.componentsWithInterest.erase(a)},cloneData:function(){return Object.clone(this.getData())},hasField:function(a){var b=this._data[a];return null!==b&&void 0!=b}})}),define.Class("core.managers.data.DataItemWithSchema",function(a){var b=a;b.inherits("core.managers.data.DataItemBase"),b.utilize(["core.utils.css.Color"]),b.traits(["bootstrap.utils.Events"]),b.statics({FIELD_TYPE_DEFAULTS:{refList:[],ref:"",number:Number.NaN,string:"",color:"255,255,255,1","boolean":!1,object:{},list:[]}}),b.methods({initialize:function(a,b,c,d){this._schema=a,this._schemaType=d,this._snapshot={},this.parent(b,c),this._setSchemaDefaults()},reset:function(){for(var a in this._schema){var b=this._getDefaultValue(a);this._data[a]!=b&&this.set(a,b)}},removeField:function(a){delete this._data[a]},takeSnapshot:function(){var a={};this._cloneBySchema(a,this._data),this._snapshot=a},restoreSnapshot:function(a){this._snapshot?(this._cloneBySchema(this._data,this._snapshot),this.discardSnapshot(),a!==!1&&this.fireDataChangeEvent()):LOG.reportError(wixErrors.DATA_MISSING_SNAPSHOT,"DataItem","restoreSnapshot",this._dataType)},discardSnapshot:function(){this._snapshot=null},getSchemaType:function(){return this._schemaType},getSchema:function(){return this._schema},setSchema:function(a){this._schema=a},getFieldSchema:function(a){return this._schema[a]},_setSchemaDefaults:function(){for(var a in this._schema){var b=this._schema[a];if(b&&b["default"]){var c=this._data[a],d=this.get(a);c||c==d||this.set(a,d)}}},get:function(a){var b=this.parent(a),c=this._schema[a];if(void 0!==b&&null!==b){if(Constants.DataTypes.TYPE_RESOURCE_KEY==c){var d=this.getDataManager().getResourceManager();d&&(b=d.get("EDITOR_LANGUAGE",b,b))}}else b=this._getDefaultValue(a),this._data[a]=b;return"color"==c?new this.imports.Color(value):b},getFieldType:function(a){return this._schema[a]},_getDefaultValue:function(a){var b,c=this._schema[a];return c?(b="string"==typeof c?this.FIELD_TYPE_DEFAULTS[c]:c.hasOwnProperty("default")?c["default"]:this.FIELD_TYPE_DEFAULTS[c.type],this._cloneDefaultObject(b)):void 0},_cloneDefaultObject:function(a){return Array.isArray(a)?a.splice(0,0):"object"==typeof a&&null!==a?Object.clone(a):a},_cloneBySchema:function(a,b){for(var c in this._schema){var d=b[c],e=typeof d;a[c]=instanceOf(d,Array)?d.slice():"object"==e?Object.clone(d):d}return a},copySchemaFieldsFrom:function(a,b){this._cloneBySchema(this._data,a._data),b||this.fireDataChangeEvent()},copySchemaFieldsTo:function(a,b,c){var d=this._cloneBySchemaAndReturnDataChange(a._data,this._data),e=0==Object.keys(d.newValue).length+Object.keys(d.oldValue).length;e||b||a.fireDataChangeEvent(void 0,d.newValue,d.oldValue,c)},_cloneBySchemaAndReturnDataChange:function(a,b){var c,d,e={},f={};for(var g in this._schema){var h=b[g],i=typeof h;c=a[g],instanceOf(h,Array)?(d=h.slice(),a[g]=d):"object"==i?(d=Object.clone(h),a[g]=d):(d=h,a[g]=d),(c||d)&&c!=d&&(f[g]=c,e[g]=d)}return{dataItem:a,newValue:e,oldValue:f}},set:function(a,b,c,d,e){var f=this._validateByPresenceInSchema(a);f?this.parent(a,b,c,d,e):LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"DataItemWithSchema","set",{c1:"key: "+a+", schemaType: "+this._schemaType})},setData:function(a,b){return a!==this._data?this._hasValidType(a.type)?(this._data?this._data.type==a.type&&(a.id=this._data.id,this.parent(a,!1),this._setSchemaDefaults(),b!==!1&&this.fireDataChangeEvent()):this.parent(a,b),void 0):(LOG.reportError(wixErrors.SCHEMA_MISSING,"DataItemWithSchema","setData",{c1:"type: "+a.type+", schemaType: "+this._schemaType}),void 0):void 0},hasField:function(a){var b=this._data[a];return null!==b&&void 0!=b},_hasValidType:function(a){return this._schemaType===a},_hasCheckableSchema:function(){return this._schemaType&&"Document"!==this._schemaType},_isKeyPresentedInSchema:function(a){return void 0!==this._schema[a]},_validateByPresenceInSchema:function(a){return this._hasCheckableSchema()?this._isKeyPresentedInSchema(a):!0}})}),define.Class("core.managers.data.DataManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["core.managers.data.DataItemBase","core.managers.data.DataItemWithSchema","bootstrap.utils.Queue"]),b.resources(["W.Classes","W.Experiments"]),b.fields({DEFINE_NAMESPACE:"dataItem"}),b.methods({initialize:function(){this._classManager=this.resources.W.Classes,this._readyDataSchemaMap={},this.dataMap={},this.dirtyDataObjectsMap={},this.callbackQueue=new this.imports.Queue,this._DataItemBase=this.imports.DataItemBase,this._DataItemWithSchema=this.imports.DataItemWithSchema,this.define[this.DEFINE_NAMESPACE].definitionModifier=this._onDataItemDefineCallBack.bind(this)},flagDataChange:function(){this._dataChanged=!0},clearDataChange:function(){this._dataChanged=!1},isDataChange:function(){return this._dataChanged===!0},_onDataItemDefineCallBack:function(a,b){return this.addDataItem(a,b),b},getDataTypeSchema:function(a){if(!this._readyDataSchemaMap[a]){var b=this.define.getDefinition("dataSchema"),c=b[a];if(!c){var d="/schema=["+a+"]";return LOG.reportError(wixErrors.SCHEMA_MISSING,"DataManager","getSchema"+d,[a])(),null}this._applySchemaInheritance(c),c=this.resources.W.Experiments.applyExperiments(a,c),this._readyDataSchemaMap[a]=c}return this._readyDataSchemaMap[a]},_applySchemaInheritance:function(a){var b=a["extends"];if(b){var c=this.getDataTypeSchema(b);Object.merge(a,c)}},clearDirtyObjectsMap:function(){this.dirtyDataObjectsMap={}},hasDirtyObjects:function(){return W.Utils.objectSizeDelta(this.dirtyDataObjectsMap)},markDirtyObject:function(a){var b=a._data,c=b.id;this.dirtyDataObjectsMap[c]=a},addDataItems:function(a){for(var b in a)this.addDataItem(b,a[b])},addDataItemsForPage:function(a){var b=this.define.getDefinition(this.DEFINE_NAMESPACE);for(var c in a){var d=nsUtil.getNameSpace(b,c);this.dataMap[c]||d||define[this.DEFINE_NAMESPACE](c,a[c])}},addDataItem:function(a,b){b=this.resources.W.Experiments.applyExperiments(a,b);var c=this.createDataItem(b);return c._data.id=a,this.dataMap[a]=c,this._runCallbacks(a,c),this.skipDirtyMarking||this.markDirtyObject(c),c},override:function(a,b){if(!a||!this.dataMap[a])throw new Error("Invalid data id name for override: "+a);this.dataMap[a]=b},addDataItemWithUniqueId:function(a,b){var c;do c=a+Number.random(0,99999).toString(36),c=c.replace(" ","_");while(this.dataMap[c]);var d=this.addDataItem(c,b);return{id:c,dataObject:d}},reportDataItemChangeEvent:function(a,b,c,d,e){this.fireEvent(Constants.DataEvents.DATA_CHANGED,[a,b,c,d]),e||void 0===b||void 0===c||!a._data.id||this.injects().Utils.areObjectsEqual(b,c)||this.fireEvent("undoDataChangedEvent",[a,b,c,d])},_runCallbacks:function(a,b){this.callbackQueue.popQueue(a).forEach(function(a){a&&a(b)})},createDataItem:function(a,b){b=b||a.type;var c;if(b&&(c=this.getDataTypeSchema(b)),c){if(c.dataClassRef){var d;return this._classManager.getClass(c.dataClassRef,function(a){d=a}),d?new d(a,this):(LOG.reportError(wixErrors.SCHEMA_MISSING,"DataManager","getSchema"+c.dataClassRef,[c.dataClassRef])(),null)}return new this._DataItemWithSchema(c,a,this,b)}return new this._DataItemBase(a,this)},isDataItem:function(a){return a&&instanceOf(a,this._DataItemBase)},getDataByQuery:function(a,b){var c=null;if(0===a.indexOf("#")){var d=a.substr(1);if(c=this.dataMap[d])return b&&b(c),c;this.callbackQueue.add(d,b);var e=this.define.getDefinition(this.DEFINE_NAMESPACE),f=nsUtil.getNameSpace(e,d);if(f)return this.addDataItem(d,f)}else LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","getDataByQuery",a),W.Utils.callLater(b,[null])},isDataAvailable:function(a){var b=null;if(0===a.indexOf("#")){var c=a.substr(1);if(!c)return!1;if(b=this.dataMap[c])return!0;var d=this.define.getDefinition(this.DEFINE_NAMESPACE),e=nsUtil.getNameSpace(d,c);return e?!0:!1}return LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","isDataAvailable",a),!1},getDataByQueryList:function(a,b){var c={},d=function(d){return function(e){c[d]=e;for(var f=!0,g=0;g<a.length;++g)if(!c[a[g]]){f=!1;break}f&&b&&b(c)}};if(0===a.length){var e={};W.Utils.callLater(b,[e])}else{for(var f={},g=!0,h=0;h<a.length;++h){var i=this.getDataByQuery(a[h],d(a[h]));i?f[a[h]]=i:g=!1}if(g)return f}},getDataMap:function(){return this.dataMap},getDirtyDataObjectsMap:function(){return Object.filter(this.dirtyDataObjectsMap,function(a){return a.getMeta("isPersistent")})},clone:function(a){var b=this.parent(a);return b},isReady:function(){return!0},_copyData:function(a){for(var b in this.dataMap){var c=Object.clone(this.dataMap[b].getData());a.addDataItem(b,c)}},toString:function(){return"[Data Manager]"},markAllDirty:function(){for(var a in this.dataMap)this.dirtyDataObjectsMap[a]=this.dataMap[a]},getResourceManager:function(){return W.Resources},removeDataItem:function(a){var b="string"==typeof a?a:this.getQueryOfDataItem(a);this._removeIfSafe(b)},_removeIfSafe:function(a){var b=a&&this.dataMap[a.substr(1)];b&&(0!==b.componentsWithInterest.length||this._isReferenced(a)||(b.removeAllEvents(),delete this.dataMap[a.substr(1)]))},_isReferenced:function(a){var b,c;for(b in this.dataMap)if(c=this.dataMap[b].getData(),c&&c.items&&c.items.indexOf&&-1!==c.items.indexOf(a))return!0;return!1},getQueryOfDataItem:function(a){var b;for(b in this.dataMap)if(a===this.dataMap[b])return"#"+b},getDataItem:function(a,b){"string"==typeof a?this.injects().Data.getDataByQuery(a,b):b(a)},getDataItemsList:function(a){a.length>0&&"string"==typeof a[0]},getDataItemsByType:function(a,b){var c=this._getDataItemsByTypeFromMap(a),d=this._getDefinitionsByType(a),e=Object.keys(d),f=e.map(function(a){return"#"+a});this.getDataByQueryList(f,function(a){var d=Object.append(a,c);b(d)})},_getDataItemsByTypeFromMap:function(a){var b=Object.values(this.dataMap),c=b.filter(function(b){return b.getType()==a});return c.toMap(function(a){return"#"+a.get("id")})},_getDefinitionsByType:function(a){var b=Object.filter(this.define.getDefinition(this.DEFINE_NAMESPACE),function(b){return b&&b.type===a});return b}})}),define.experimentPlugin("ExperimentDataItemPlugin",function(a){function b(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),d=b(c),e=c._mergeField_(a,d);return e}function c(a,b){define.dataItem(a,b())}var d=a;d.init("dataItem","newDataItem",b,c)}),define.experimentPlugin("ExperimentDataPropertyItemPlugin",function(a){function b(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),d=b(c),e=c._mergeField_(a,d);return e}function c(a,b){define.dataPropertyItem(a,b())}var d=a;d.init("dataPropertyItem","newDataPropertyItem",b,c)}),define.experimentPlugin("ExperimentDataSchemaPlugin",function(a){function b(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),d=b(c),e=c._mergeField_(a,d);return e}function c(a,b){define.dataSchema(a,b())}var d=a;d.init("dataSchema","newDataSchema",b,c)}),define.Class("core.managers.data.PropertiesItem",function(a){var b=a;b.inherits("core.managers.data.DataItemWithSchema"),b.methods({initialize:function(a,b,c,d){this.parent(a,b,c),this._ownerComponent=d}})}),define.Const("DataEvents",{DATA_CHANGED:"dataChanged",BEFORE_CHANGE:"beforeDataChange",AFTER_CHANGE:"afterDataChange"}),define.Const("DataTypes",{TYPE_RESOURCE_KEY:"resourceKey"}),define.Const("PropertyEvents",{PROPERTY_CHANGED:"propertyChanged"}),define.Const("UrmEvents",{DATA_CHANGE_RECORDED:"dataChanged"}),define.Class("core.managers.serverfacade.CorsRESTClient",function(a){var b=a;b.inherits("core.managers.serverfacade.RESTClient"),b.methods({initialize:function(){},get:function(a,b,c){var d=this._createCorsXhr(a);d.onabort=function(){this._onXhrEvent("abort",d,c)}.bind(this),d.ontimeout=function(){this._onXhrEvent("timeout",d,c)}.bind(this),d.onerror=function(){this._onXhrEvent("error",d,c)}.bind(this),d.onload=function(){this._onXhrEvent("load",d,c)}.bind(this),d.onprogress=function(){},d.send()},_createCorsXhr:function(a,b){var c=b||"GET",d=null;try{d=new XMLHttpRequest}catch(e){}return d&&"withCredentials"in d?d.open(c,a,!0):"undefined"!=typeof XDomainRequest&&(a=-1!=a.indexOf("?")?a+"&":a+"?",a+="ctype=text/plain",d=new XDomainRequest,d.open(c,a),d.setRequestHeader=function(){}),d},_onXhrEvent:function(a,b,c){if("load"!=a||!this._isIExplorer()&&4!=b.readyState)this._onError(b,c);else{var d={};try{d=JSON.parse(b.responseText)}catch(e){}this._onSuccess(d,c)}},_isIExplorer:function(){return-1!=navigator.userAgent.indexOf("MSIE")},post:void 0,jsonp:void 0,jsonrpc:void 0})}),define.Class("core.managers.serverfacade.RESTClient",function(a){var b=a;b.statics({CALLBACK_STATUS:{SUCCESS:"success",ERROR:"error"},REQUEST_OBJECT:{jsonrpc:"2.0",id:1,method:"",params:[]}}),b.resources(["W.Utils"]),b.methods({initialize:function(){},get:function(a,b,c){var d=this._createRequestOptions(a,b,c),e=new Request.JSON(d);b?e.get(JSON.encode(b)):e.get()},post:function(a,b,c){var d=this._createRequestOptions(a,b,c);d.headers={"Content-Type":"application/json; charset=utf-8"};var e=new Request.JSON(d);e.post(JSON.encode(b))},jsonp:function(a,b,c){var d=this._createRequestOptions(a,b,c),e=new Request.JSONP(d);e.send(JSON.encode(b))},jsonrpc:function(a,b,c,d){var e=Object.clone(this.REQUEST_OBJECT);e.method=b,e.params=c,this.post(a,e,{onSuccess:function(a){a.result&&"function"==typeof d.onSuccess?d.onSuccess(a.result):"function"==typeof d.onError&&d.onError({errorDescription:"json-rpc returned an error",errorCode:-9999,payload:a.error})},onError:d.onError})},responseCallback:null,_createRequestOptions:function(a,b,c){var d=function(a){this._onSuccess(a,c)}.bind(this),e=function(a){this._onError(a,c)}.bind(this),f=function(a){this._onComplete(a,c)}.bind(this),g=function(a,b){this._onRequest(a,b,c)}.bind(this),h={url:a,urlEncoded:!1,onSuccess:d,onFailure:e,onComplete:f,onRequest:g};return h},_onSuccess:function(a,b){a?this._executeSuccessCallback(b.onSuccess,a):this._executeFailureCallback(b.onError,Constants.ServerErrors.NO_DATA),this._executeUsersCallback(this.CALLBACK_STATUS.SUCCESS,a)},_onError:function(a,b){if(a){var c=Object.clone(Constants.ServerErrors.SERVER_UNHANDLED_ERROR);c.errorCode=a.status,this._executeFailureCallback(b.onError,c)}else this._executeFailureCallback(b.onError,Constants.ServerErrors.NO_DATA);this._executeUsersCallback(this.CALLBACK_STATUS.ERROR,a)},_onComplete:function(a,b){this._executeSuccessCallback(b.onComplete,a)},_onRequest:function(a,b,c){for(var d=this.resources.W.Utils.getQueryParam("callback",a).split("."),e=window,f=0;f<d.length;f++)e=e[d[f]];"function"==typeof c.onRequest&&c.onRequest(e,a,b)},_executeSuccessCallback:function(a,b){"function"===typeOf(a)&&a(b)
},_executeFailureCallback:function(a,b){"function"===typeOf(a)&&a(b.errorDescription,b.errorCode,b.payload)},_executeUsersCallback:function(a,b){this.responseCallback&&"function"===typeOf(this.responseCallback)&&this.responseCallback(a,b)}})}),define.Class("core.managers.serverfacade.WixRESTClient",function(a){var b=a;b.inherits("core.managers.serverfacade.RESTClient"),b.methods({initialize:function(){},jsonp:function(a,b,c,d){if(d){var e=this._createRequestOptions(a,b,c);e.onSuccess=function(a,b){this._onSuccess(b,c)}.bind(this),e.onComplete=function(){},e.timeout=5e3;var f=new Request.JSONP(e);f.send(JSON.encode(b))}else this.parent(a,b,c)},_onSuccess:function(a,b){this._validateServerSuccessResponse(a),a?a.success?this._executeSuccessCallback(b.onSuccess,a):this._executeFailureCallback(b.onError,a):this._executeFailureCallback(b.onError,Constants.ServerErrors.NO_DATA),this._executeUsersCallback(this.CALLBACK_STATUS.SUCCESS,a.payload)},_onComplete:function(a,b){this._validateServerSuccessResponse(a),this.parent(a,b)},_validateServerSuccessResponse:function(a){a&&a.success!==!1||LOG.reportError(wixErrors.SERVER_RETURNED_ERROR,"RESTClient","_onComplete",a)},_executeSuccessCallback:function(a,b){var c=b&&b.payload||b;this.parent(a,c)},_executeUsersCallback:function(a,b){var c=b&&b.payload||b;this.parent(a,c)}})}),define.Const("ServerErrors",{NO_DATA:{errorDescription:"no data",errorCode:-9999,payload:"no data"},SERVER_UNHANDLED_ERROR:{errorDescription:"server unhandled error",errorCode:-9999,payload:"no data"}}),define.Class("mobile.core.skins.BaseSkin",function(a){var b=a;b.resources(["W.Skins"]),b.binds(["_onStylePropChange"]),b.fields({_comps:[],_params:[{type:"domId",name:"Component ID",id:"compId",inherited:!0}],_html:"<div></div>",_css:["base {}"],_viewNode:null,_updatePartsCallback:null,_skinParts:null,_inlineContainer:null}),b.methods({initialize:function(){this._isDisposed=!1},applyStyle:function(a){a&&this._style!==a&&(this._removeOldStyle(),this._addStyle(a),this._render())},_removeOldStyle:function(){this._style&&this._style.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStylePropChange),delete this._style},_addStyle:function(a){this._style=a,this._style.addEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStylePropChange)},register:function(a,b,c){this._isRegistered()?LOG.reportError(wixErrors.SKIN_MANAGER_RE_REGISTER,"mobile.core.skins.BaseSkin","register",a.getProperty("id")):(this._viewNode=a,this._updatePartsCallback=b,this._skinParamChangeCallback=c,this._render())},unRegister:function(){this._viewNode=null,this.dispose()},_isRegistered:function(){return this._viewNode&&this._updatePartsCallback},getInlineContent:function(){return this._skinParts?this._skinParts.inlineContent?this._skinParts.inlineContent.getChildren():null:this._viewNode.getChildren()},_render:function(){if(this._isRegistered()){var a=this.getInlineContent();if(this._skinParts=this._buildSkin(),this._skinParts.inlineContent&&a){this._skinParts.inlineContent.empty();for(var b=0;b<a.length;b++)a[b].insertInto(this._skinParts.inlineContent,"bottom",Constants.DisplayEvents.MOVED_IN_DOM)}this._updatePartsCallback(this._skinParts)}},_onStylePropChange:function(a){this.resources.W.Skins.stylePropertiesChangedForSkin(this.className,this._style,a.properties),this._skinParamChangeCallback(a.properties)},_informLogicOfParamChanges:function(){},_buildSkin:function(a){return this._renderCss(),this._renderHtml(a)},_renderCss:function(){this.resources.W.Skins.buildSkinCSS(this.className,this._style)},_renderHtml:function(a){var b=this._viewNode;return a&&a.viewNode&&(b=a.viewNode),this.resources.W.Skins.buildSkinHTML(this.className,b,this._style)},renderCssIfNeeded:function(){var a=!0;if(this._style)a=this._style.isStyleRenderedForAllSkins();else{var b=this.getSkinClassData(),c=b.CSSBuildFlags;for(var d in c)if(!c[d]){a=!1;break}}a||this._renderCss()},getStyle:function(){return this._style},getParams:function(){return this._params},getCompPartsDefinition:function(){return this.compParts||{}},getCompPartSkinName:function(a){var b=this.compParts;return b&&b[a].skSin},getUniqueClass:function(a){return this.resources.W.Skins.getUniqueClass(a,this.$className)},dispose:function(){this._isDisposed=!0,this._updatePartsCallback=null,this._removeOldStyle()},getParamValue:function(a){return this.resources.W.Skins.getSkinParamValue(this.$className,a,this._style)}})}),define.Class("core.managers.skin.BaseSkin2",function(a){var b=a;b.inherits("bootstrap.managers.events.EventDispatcher"),b.binds(["_onParamChange","_onParamMapperSkinChange"]),b.resources(["W.Skins"]),b.methods({initialize:function(){},setParamMapper:function(a){this.removeParamMapper(),this._paramMapper=a,this._paramMapper.addEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onParamChange),this._paramMapper.addEvent(Constants.StyleEvents.SKIN_CHANGED,this._onParamMapperSkinChange),this._render()},getParamMapper:function(){return this._paramMapper||null},removeParamMapper:function(){this._paramMapper&&(this._paramMapper.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onParamChange),this._paramMapper.removeEvent(Constants.StyleEvents.SKIN_CHANGED,this._onParamMapperSkinChange),delete this._paramMapper)},_onParamMapperSkinChange:function(){this._paramMapper.getSkinClassName()!==this.$className&&this._logic&&this._logic.setSkinMapper(this._paramMapper)},_onParamChange:function(a){if(this.resources.W.Skins.stylePropertiesChangedForSkin(this.className,this._paramMapper,a.properties),this._logic){var b=this._logic.INVALIDATIONS.STYLE_PARAM_CHANGE;this._logic.invalidate(b,{})}},_setLogic_:function(a){this._logic=a,this._render()},_removeLogic_:function(){delete this._logic},_render:function(){if(this._logic){var a=this._logic.getInlineContent();if(this._skinParts=this._buildSkin(),this._skinParts.inlineContent&&a){this._skinParts.inlineContent.empty();for(var b=0;b<a.length;b++)a[b].insertInto(this._skinParts.inlineContent,"bottom",Constants.DisplayEvents.MOVED_IN_DOM)}this._logic._updateSkinParts_(this._skinParts)}},_buildSkin:function(){return this._renderCss(),this._renderHtml()},_renderCss:function(){this.resources.W.Skins.buildSkinCSS(this.$className,this._paramMapper)},_renderHtml:function(){var a=this._logic.getViewNode();return this.resources.W.Skins.buildSkinHTML(this.$className,a,this._paramMapper)},getCompPartsDefinition:function(){return this.compParts||{}},getParams:function(){return this._params},getCompPartSkinName:function(a){var b=this.compParts;return b&&b[a].skSin},getUniqueClass:function(a){return this.resources.W.Skins.getUniqueClass(a,this.getOriginalClassName())},getParamValue:function(a){return this.resources.W.Skins.getSkinParamValue(this.getOriginalClassName(),a,this._paramMapper)},exterminate:function(){this._removeLogic_(),this.removeParamMapper(),this.parent()}})}),define.Class("core.managers.skin.CssGarbageCollector",function(a){var b=a;b.utilize(["core.managers.skin.GCDomTraverse"]),b.binds(["runGarbageCollector"]),b.methods({initialize:function(a,b,c){this._styleDataMap=a,this._skinDataMap=b,this._skinRenderer=c,this._DomTraverserClass=this.imports.GCDomTraverse},runGarbageCollector:function(){this._domTraverser=new this._DomTraverserClass,this._domTraverser.traverseDomAndCollectUsedStyles(function(a,b){this._runGarbageCollectorOnStyles(a),this._runGarbageCollectorOnSkins(b)}.bind(this))},_runGarbageCollectorOnStyles:function(a){var b=this._findUnusedStyles(a);for(var c in b)if(b[c]){var d=b[c];this._processUnusedStyles(d)}},_findUnusedStyles:function(a){var b=Object.filter(this._styleDataMap,function(b,c){return!a.contains(c)});return b},_runGarbageCollectorOnSkins:function(a){var b=this._findUnusedSkins(a);for(var c in b){var d=this._skinDataMap[c];d&&this._removeUnusedSkinRules(d)}},_findUnusedSkins:function(a){var b=Object.filter(this._skinDataMap,function(b,c){return!a.contains(c)});return b},_processUnusedStyles:function(a){var b=a.getSkinArray(),c=a.getGroups();for(var d in c){var e=c[d];this._processUnusedStyles(e)}for(var f=0;f<b.length;f++){var g=this._skinDataMap[b[f]];g&&this._removeUnusedSkinRules(g,a.getId())}a.setStyleRenderFlag(!1)},_removeUnusedSkinRules:function(a,b){var c=a.css;if(c)for(var d=0;d<c.length;d++){b||(b="");var e=this._skinRenderer.replaceStylePlaceHolder(c[d].selector,b);this._skinRenderer.removeCssRule(e),a.CSSBuildFlags[b]=!1}}})}),define.experimentPlugin("ExperimentSkinPlugin",function(a){function b(a,b){resource.getResourceValue("W.Classes",function(a){a.getClass("core.managers.skin.SkinDefinition",function(a){d=a})});var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),e=a;"function"==typeof a&&(e=new d,a(e));var f=new d;return b(f,c),e.inherits(f._extends_||e._extends_),e.utilize(c._mergeField_(e._imports_,f._imports_)),e.fields(c._mergeObjects_(e._fields_,f._fields_)),e.compParts(c._mergeField_(e._compParts_,f._compParts_)),e.skinParams(c._mergeField_(e._skinParams_,f._skinParams_)),e.html(f._html_||e._html_),e.css(c._mergeField_(e._css_,f._css_)),e}function c(a,b){define.skin(a,b)}var d,e=a;e.init("skin","newSkin",b,c)}),define.Class("core.managers.skin.GCDomTraverse",function(a){var b=a;b.methods({initialize:function(){this._usedStyles=[],this._usedSkins=[]},traverseDomAndCollectUsedStyles:function(a){this._traverseElementAndCollect($(document.body)),a(this._usedStyles,this._usedSkins)},_traverseElementAndCollect:function(a){var b=a.isDisplayed();if(b){this._collectElementStylesSkins(a);var c=a.getChildren();if(c&&c.length)for(var d=0;d<c.length;d++)this._traverseElementAndCollect(c[d])}},_collectElementStylesSkins:function(a){var b=a.getAttribute("styleId");b&&this._usedStyles.push(b);var c=a.getAttribute("skin");c&&this._usedSkins.push(c);var d=a.getLogic&&a.getLogic().getSkin&&a.getLogic().getSkin().$className;d&&this._usedSkins.include(d)}})}),define.Class("core.managers.skin.SkinDefinition",function(a){var b=a;b.inherits(a.constructor),b.methods({initialize:function(){a.constructor.apply(this),this._compParts_={},this._skinParams_=[],this._html_="",this._css_=[]},compParts:function(a){this._compParts_=a},skinParams:function(a){this._skinParams_=a},html:function(a){this._html_=a},css:function(a){this._css_=a}})}),define.Class("core.managers.skin.SkinManager",function(a){var b=a;b.utilize(["core.managers.skin.SkinDefinition","core.managers.skin.SkinParser","core.managers.skin.SkinRenderer","core.managers.skin.CssGarbageCollector","bootstrap.utils.Queue"]),b.inherits("bootstrap.managers.BaseManager"),b.resources(["W.Classes","W.Theme","W.Utils","W.Experiments"]),b.binds(["_onClassReady","getSkin","buildSkinCSS","_onThemeChange","_checkThemePropChanges","_checkStylePropChanges","_onSkinDefineCallBack"]),b.methods({initialize:function(){this._SkinParserClass=this.imports.SkinParser,this._SkinRendererClass=this.imports.SkinRenderer,this._CssGarbageCollectorClass=this.imports.CssGarbageCollector,this._skinParser=new this._SkinParserClass,this._skinRenderer=new this._SkinRendererClass,this._skinQue=new this.imports.Queue,this._skinClassMap={},this._pendingSkinClassMap={},this._skinDataMap={},this._styleDataMap={},this._cssGarbageCollector=new this._CssGarbageCollectorClass(this._styleDataMap,this._skinDataMap,this._skinRenderer),this._classManager=this.resources.W.Classes,this._classManager.addClassNamespaceHook(this.getSkin),this._classManager.addClassReadyHandler(this._onClassReady),this.resources.W.Theme.addEvent("propertyChange",this._onThemeChange),this.define.skin.definitionModifier=this._onSkinDefineCallBack.bind(this)},_onSkinDefineCallBack:function(a,b){var c=this._skinQue.getQueue(a);return c&&c.length>0&&this.registerNewSkin(a,b),b},registerNewSkin:function(a,b){if(!this._isSkinRegister()){var c=new this.imports.SkinDefinition;b(c),c=this.resources.W.Experiments.applyExperiments(a,c),this._fixSkinDefinition(a,c),this._validateNewSkin(a),this._addSkinDependencies(a,c),this._pendingSkinClassMap[a]="pending",this._classManager.registerClassDefinition(a,c)}},_isSkinRegister:function(a){return this._pendingSkinClassMap[a]||this._skinDataMap[a]},_fixSkinDefinition:function(a,b){var c=b._fields_;c._html=b._html_,c._css=b._css_,c._params=b._skinParams_,c.compParts=b._compParts_},_validateNewSkin:function(a){return this._skinClassMap[a]||this._skinDataMap[a]?(LOG.reportError(wixErrors.SKIN_ALREADY_EXIST,this.className,"newSkin",a+""),void 0):void 0},_addSkinDependencies:function(a,b){var c=b._imports_||[],d=b._compParts_||{};for(var e in d){var f=d[e].skin;if(f&&c.indexOf(f)<0){var g=this.getNameOverride(f);c.push(g)}}b.utilize(c)},newSkin:function(a){this.define.oldSkin(a)},override:function(a,b){if(!a)throw new Error("null/undefine skin name to override: ");this.getSkin(a,function(){this._skinClassMap[a]=b}.bind(this))},getSkin:function(a,b){if(a=this.getNameOverride(a),this._skinClassMap[a])return this.resources.W.Utils.callLater(b,[this._skinClassMap[a]]),this._skinClassMap[a];var c=this._skinQue.hasQueue(a)===!1;if(this._skinQue.add(a,b),c){var d=this.define.getDefinition("skin"),e=nsUtil.getNameSpace(d,a);e?this.registerNewSkin(a,e):this._classManager.getClass(a,function(){})}return null},getNameOverride:function(a){return this.define.Class.$nameOverrides[a]||a},_onClassReady:function(a,b){return this._pendingSkinClassMap[a]?(this._onSkinClassReady(a,b),this._skinQue.getQueue(a).forEach(function(a){a&&a(b)}.bind(this)),void 0):(this._skinQue.removeKey(a),void 0)},_onSkinClassReady:function(a,b){var c=this._skinParser.parseSkinData(a,b);this._skinDataMap[a]=c,b.prototype.getSkinClassData=function(){return c},this._onSkinReady(b,a)},_onSkinReady:function(a,b){this._skinClassMap[b]=a,this._skinQue.getQueue(b).forEach(function(a){a&&a(this._skinClassMap[b])}.bind(this)),this._skinQue.removeKey(b)},_$getCssId:function(){return this._skinRenderer.getCssNodeId()},isReady:function(){return!this._skinQue.hasQueue()},buildSkinCSS:function(a,b){var c=this._skinDataMap[a];if(!c)return LOG.reportError(wixErrors.SKIN_MANAGER_NO_DATA_FOR_SKIN,"mobile.core.managers.SkinManager","buildSkinCSS",a),void 0;var d=this._skinRenderer.getStyleId(b);c.CSSBuildFlags[d]||b&&b.isStyleRenderedForSkin(a)||(b?(this._styleDataMap[d]=b,b.setStyleRenderFlagForSkin(a,!0)):c.CSSBuildFlags[d]=!0,this._skinRenderer.registerSkinCSSNow(c,b))},buildSkinHTML:function(a,b,c){if(!a||!b){var d=b&&b.getProperty("id");return LOG.reportError(wixErrors.SKIN_MANAGER_MISSING_ARGUMENTS,"mobile.core.managers.SkinManager","buildSkinHTML","skinName="+a+" compId="+d+"compViewNode: "+b),{}}var e=this._skinDataMap[a];return e?this._skinRenderer.buildSkinHTML(e,b,c):(LOG.reportError(wixErrors.SKIN_MANAGER_NO_DATA_FOR_SKIN,"mobile.core.managers.SkinManager","buildSkinHTML",a),{})},stylePropertiesChangedForSkin:function(a,b,c){var d=b&&b.getId();if(a&&d&&c){this._styleChangedProps||(this._styleChangedProps={}),this._styleChangedProps[a]=this._styleChangedProps[a]||{},this._styleChangedProps[a][d]=this._styleChangedProps[a][d]||{style:b,props:{}};for(var e in c)this._styleChangedProps[a][d].props[e]="";this._styleChangeCallLater||(this._styleChangeCallLater=this.resources.W.Utils.callOnNextRender(this._checkStylePropChanges,100))}},_onThemeChange:function(a){var b=a.name;b&&(this._themeChangedProps||(this._themeChangedProps={}),this._themeChangedProps[b]=a,this._themeChangeCallCallLater||(this._themeChangeCallCallLater=this.resources.W.Utils.callOnNextRender(this._checkThemePropChanges,100)))},_checkStylePropChanges:function(){var a,b,c,d,e,f,g,h;delete this._styleChangeCallLater;for(a in this._styleChangedProps){b=this._styleChangedProps[a],c=this._skinDataMap[a];for(d in b)for(e=b[d].style,f=b[d].props,g=c.css,h=0;h<g.length;++h)this._isSkinCssClassContainsPartialParams(g[h],f,"id")&&this._skinRenderer.updateSkinCSSClass(g[h].selector,g[h].rules,g[h].params,c.params,e)}delete this._styleChangedProps},_checkThemePropChanges:function(){if(delete this._themeChangeCallCallLater,this===W.Skins)for(var a in this._skinDataMap)for(var b=this._skinDataMap[a],c=this._skinDataMap[a].css,d=0;d<c.length;++d)this._isSkinCssClassContainsPartialParams(c[d],this._themeChangedProps,"defaultTheme")&&this._skinRenderer.updateSkinCSSClass(c[d].selector,c[d].rules,c[d].params,b.params);delete this._themeChangedProps},_isSkinCssClassContainsPartialParams:function(a,b,c){var d=a.params;for(var e in b)for(var f=0;f<d.length;++f)if(d[f][c]&&d[f][c]==e)return!0;return!1},getSkinParamValue:function(a,b,c){for(var d=this._skinDataMap[a].params,e=0;e<d.length;e++){var f=d[e];if(f.id==b)return this._skinRenderer.getParamValue(f,c)}return null},getUniqueClass:function(a,b){var c=this._skinParser.getSkinCSSName(b),d=this._skinParser.getUniqueClass(a,c);return d.uniqueClass}})}),define.Class("core.managers.skin.SkinParser",function(a){var b=a;b.methods({parseSkinData:function(a,b){var c=b.prototype,d=c._params||[],e=c._html||"",f=c._css||[],g=[],h={},i={},j=this._addStylePlaceHolder(this.getSkinCSSName(a));d=this._processSkinParams(d,a);for(var k=0;k<f.length;++k){var l=f[k];if(l)this._processSkinCssClass(l,d,j,i,h,g);else{var m="";try{m=f.join(",")}catch(n){}LOG.reportError(wixErrors.SKIN_PROBLEM_WITH_RULE,this.className,"_registerSkinData",a+"("+k+") : "+m)}}return{name:a,params:d,html:e,css:g,compParts:c.compParts||{},skinPartClasses:h,skinSpecificClasses:i,skinCSSName:j,CSSBuildFlags:{},canFocus:!!c.canFocus}},getSkinCSSName:function(a){return a.replace(/\./g,"_")},_processSkinParams:function(a,b){for(var c=0;c<a.length;++c){var d=a[c];if(d.defaultParam&&(d.defaultParam=this._getParamById(a,d.defaultParam),d.defaultParam||(LOG.reportError(wixErrors.SKIN_PARAM_REF_NOT_FOUND,b,"_processSkinParams/defaultParam",d.id)(),delete d.defaultParam,d.defaultValue="")),d.sumParams){for(var e=[],f=0;f<d.sumParams.length;++f){var g=this._getParamById(a,d.sumParams[f]);g?e.push(g):LOG.reportError(wixErrors.SKIN_PARAM_REF_NOT_FOUND,b,"_processSkinParams/sumParams",d.sumParams[f])()}d.sumParams=e}}return a},_getParamById:function(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b)return a[c];return null},_processSkinCssClass:function(a,b,c,d,e,f){var g=a.indexOf("{"),h=a.lastIndexOf("}");if(-1!=g&&-1!=h&&h-1>g)for(var i=a.substr(0,g),j=a.substring(g+1,h),k=this._getParamsUsed(j,b),l=i.split(","),m=0;m<l.length;++m)i=this._processSkinCssSelector(l[m],c,d,e),f.push({selector:i,rules:j,params:k})},_processSkinCssSelector:function(a,b,c,d){var e=this._convertCssSelector(a,b,c,d),f=a.length?a.charAt(0):"",g="["==f||":"==f||""===f||"{"==f||"."==f||">"==f;if(g||e==a){var h=g?"":" ";e="."+b+h+e}return e=e.trim().replace(/\s+/g," ")},_convertCssSelector:function(a,b,c,d){var e,f,g=/%(\.?[a-z0-9]+)%/i;for(e=a.match(g);e&&!(e.length<2);){f=e[1];var h=this.getUniqueClass(f,b);"class"==h.type?c[f.substring(1)]=h.uniqueClass:d[f]=h.uniqueClass,a=a.replace(g,"."+h.uniqueClass),e=a.match(g)}return a},getUniqueClass:function(a,b){var c={};if("."==a.charAt(0)){var d=a.substring(1);c.uniqueClass=b+"-c-"+d,c.type="class"}else c.uniqueClass=b+"-"+a,c.type="skinPart";return c},_getParamsUsed:function(a,b){var c=[];if(!a||!b||0===b.length)return c;for(var d=0,e=b.length;e>d;++d)-1!=a.indexOf("["+b[d].id+"]")&&(c[b[d].id]=b[d]);var f={};for(var g in c){var h=c[g];if(h.defaultParam){for(;void 0!==h.defaultParam;)h=h.defaultParam;f[h.id]=h}}return Object.values(Object.merge(c,f))},_addStylePlaceHolder:function(a){return a+Constants.skinManager.STYLE_CSS_PLACEHOLDER}})}),function(){var a=null;define.Class("core.managers.skin.SkinRenderer",function(b){var c=b;c.utilize(["core.utils.css.BorderRadius","core.utils.css.Color","core.utils.css.Size","core.utils.css.Font","core.utils.css.BoxShadow"]),c.methods({initialize:function(){this._stylesheet=this._generateSkinsStylesSheet()},replaceStylePlaceHolder:function(a,b){return a.split(Constants.skinManager.STYLE_CSS_PLACEHOLDER).join(b)},registerSkinCSSNow:function(a,b){for(var c=a.css,d=0;d<c.length;++d)this.updateSkinCSSClass(c[d].selector,c[d].rules,c[d].params,a.params,b)},updateSkinCSSClass:function(a,b,c,d,e){styleId=this.getStyleId(e);for(var f=0;f<c.length;++f){var g=c[f],h=g.id,i=this._getParamValue(g,e),j=this._paramValueToCss(i,g);null===j&&(j=""),b=b.split("["+h+"]").join(j)}if(a=this.replaceStylePlaceHolder(a,styleId),e&&e.isCssRedirectedToStyle())e.updateCssRule(a,b);else try{this._stylesheet.updateRule(a,b)}catch(k){}},getParamValue:function(a,b){return this._getParamValue(a,b)},_getParamValue:function(a,b){var c=null;if(a.defaultParam){var d=a.defaultParam;return this._applyParamMutators(this._getParamValue(d,b),a)}if(b&&b.getProperty(a.id)){var e=b.getPropertySource(a.id);return c=b.getProperty(a.id),"theme"==e&&(c=this.injects().Theme.getProperty(c)),c=this._castToType(c,a),c=this._addExtraToParamByType(a,c,b),this._applyParamMutators(c,a)}if(a.defaultTheme){var f=a.defaultTheme,g=W.Theme.getProperty(f);return g=this._castToType(g,a),this._applyParamMutators(g,a)}if(a.sumParams){var h=a.sumParams;if(h&&"array"==typeOf(h)&&h.length>0){var i=this._getParamValue(h[0],b);if(i.add&&"function"==typeof i.add)for(var j=1;j<h.length;j++)i.add(this._getParamValue(h[j],b));return this._applyParamMutators(i,a)}}return a.defaultValue?(c=this._castToType(a.defaultValue,a),this._applyParamMutators(c,a)):null},_castToType:function(a,b){switch(b.type){case Constants.SkinParamTypes.COLOR:case Constants.SkinParamTypes.COLOR_ALPHA:case Constants.SkinParamTypes.BG_COLOR:a=new this.imports.Color(a);break;case Constants.SkinParamTypes.SIZE:a=new this.imports.Size(a);break;case Constants.SkinParamTypes.BOX_SHADOW:a=new this.imports.BoxShadow(a);break;case Constants.SkinParamTypes.BORDER_RADIUS:a=new this.imports.BorderRadius(a);break;case Constants.SkinParamTypes.FONT:a=new this.imports.Font(a)}return a},_addExtraToParamByType:function(a,b,c){var d=c.getPropertyType(a.id);if("color"==d){var e=c.getPropertyExtraParamValue(a.id,"alpha");b.setAlpha(e)}return"boxShadow"==d&&b.setToggleOn(c.getPropertyExtraParamValue(a.id,"isOn")===!0),b},_applyParamMutators:function(a,b){if(b.mutators)for(var c=0;c<b.mutators.length;c+=2){var d=a[b.mutators[c]];if(d&&"function"==typeof d){var e=b.mutators[c+1];e&&"array"==typeOf(e)||(e=e?[e]:[]),a=d.apply(a,e)}else LOG.reportError(wixErrors.SKIN_PARAM_MUTATOR_FUNC_NOT_FOUND,"SkinRenderer","_applyParamMutators",d)()}return a},_paramValueToCss:function(a,b){var c=Constants.skinManager.FEATURES;if(void 0!==a&&null!==a){switch(b=b||{},b.type){case Constants.SkinParamTypes.BG_COLOR:var d=a,e=d.getAlpha();e>0?Modernizr.rgba===!0&&1>e?a="background-color:rgba("+d.getRgba()+");":(a="background-color:"+d.getHex(!1)+";",c.filter_alpha&&1>e&&(a+="filter:alpha(opacity="+100*e+");")):a="background-color:transparent;";break;case Constants.SkinParamTypes.BORDER_RADIUS:var f=W.Utils.getCSSBrowserFeature("border-radius");a=f?f+":"+a+";":"";break;case Constants.SkinParamTypes.TRANSITION:f=W.Utils.getCSSBrowserFeature("transition"),a=f?f+":"+a+";":"";break;case Constants.SkinParamTypes.BOX_SHADOW:a=W.Utils.getCSSBrowserFeature("box-shadow")?W.Utils.getCSSBrowserFeature("box-shadow")+":"+a.getCssValue()+";":"";break;case Constants.SkinParamTypes.FONT:a="font:"+a.getCssValue()+";";break;case Constants.SkinParamTypes.SIZE:a=a.getCssValue();break;case Constants.SkinParamTypes.COLOR:a=void 0!==a.getHex?a.getHex(!1):a;break;case Constants.SkinParamTypes.COLOR_ALPHA:d=a,e=d.getAlpha(),a=e>0?Modernizr.rgba===!0&&1>e?"rgba("+d.getRgba()+")":d.getHex(!1):"transparent"}return a}return null},buildSkinHTML:function(a,b,c){styleId=this.getStyleId(c);var d=a.html,e=this.replaceStylePlaceHolder(a.skinCSSName,styleId);b.empty(),b.set("html",d),b.set("styleId",styleId),b.set("skin",a.name),a.canFocus?b.tabIndex=0:0===b.tabIndex&&(b.tabIndex=-1),b._wixCSSName&&(b.removeClass(b._wixCSSName),delete b._wixCSSName),e&&(b.addClass(e),b._wixCSSName=e);for(var f={view:b},g=$$(b.getElements("[skinPart]")),h=a.compParts||{},i=a.skinPartClasses||{},j=0;j<g.length;++j){var k=g[j],l=k.getAttribute("skinPart");f[l]=k;var m=i[l];m&&k.addClass(this.replaceStylePlaceHolder(m,styleId));var n=k.getAttribute("skin");!n&&h[l]&&h[l].skin&&(n=h[l].skin,n&&k.setAttribute("skin",n))}var o=a.skinSpecificClasses||{};for(var p in o){var q=$(b).getElements("."+p);q.removeClass(p).addClass(this.replaceStylePlaceHolder(o[p],styleId))}return f},getStyleId:function(a){return a&&a.getId()||""},_skinStyleNodeId:null,_generateSkinsStylesSheet:function(){return a||(a=W.Utils.createStyleSheet("WIX_SKIN_STYLES")),this._skinStyleNodeId=a.styleNode.get("id"),a},getCssNodeId:function(){return this._skinStyleNodeId},removeCssRule:function(a){this._stylesheet.removeRuleBySelector(a)}})})}(),function(){var a={},b=document.createElement("div"),c=function(c,d,e){b.style.cssText=d,a[c]=e(b)};c("filter_alpha","filter:alpha(opacity=0.9);",function(a){return void 0!==a.style.filter&&-1!=a.style.filter.indexOf("alpha")}),c("opacity","opacity:0.7;",function(a){return void 0!==a.style.opacity&&"0.7"==a.style.opacity}),c("background-color_rgba","background-color:rgba(255,0,0,0.5);",function(a){return void 0!==a.style.backgroundColor&&-1!=a.style.backgroundColor.indexOf("rgba")}),c("border-radius","border-top-right-radius:0.1em;",function(a){return void 0!==a.style.borderTopRightRadius&&-1!=a.style.borderTopRightRadius.indexOf("0.1em")}),c("-webkit-border-radius","-webkit-border-top-right-radius:0.2em;",function(a){return void 0!==a.style.webkitBorderTopRightRadius&&-1!=a.style.webkitBorderTopRightRadius.indexOf("0.2em")}),c("-moz-border-radius","-moz-border-radius-topright:0.3em;",function(a){return void 0!==a.style.MozBorderRadiusTopright&&-1!=a.style.MozBorderRadiusTopright.indexOf("0.3em")}),define.Const("skinManager",{STYLE_CSS_PLACEHOLDER:"[STYLE_PH]",FEATURES:a})}(),define.Const("SkinParamCssTypesToGeneralTypesMap",{cssBorderRadius:"radius",cssBgColor:"color",boxShadow:"boxShadow",color:"color",color_alpha:"color",cssFont:"font",size:"size",cssStr:"string",url:"url",transition:"transition"}),define.Const("SkinParamTypes",{BORDER_RADIUS:"cssBorderRadius",BG_COLOR:"cssBgColor",BOX_SHADOW:"boxShadow",COLOR:"color",COLOR_ALPHA:"color_alpha",FONT:"cssFont",SIZE:"size",OTHER:"cssStr",URL:"url",TRANSITION:"transition"}),define.Class("core.managers.style.SkinExtraParamHandler",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.statics({PROPERTY_TYPE_EXTRA_PARAMS:{color:{alpha:{prefix:"alpha",defaultValue:1,type:"number"}},boxShadow:{isOn:{prefix:"boxShadowToggleOn",defaultValue:!0,type:"boolean"}}}}),b.methods({initialize:function(a,b,c){this._properties=a,this._propertiesTypes=b,this._propertiesCounter=c},getPropertyExtraParamValue:function(a,b){var c=this._getPropertyExtraParamDefinition(a,b);if(c){var d=this._getPropertyExtraParamId(a,c.prefix);return this._convertStringToType(this._properties[d],c.type)}},_getPropertyExtraParamDefinition:function(a,b){var c=this._propertiesTypes[a],d=this._getExtraParamDefinitionByType(c,b);return d?d:(LOG.reportError(wixErrors.STYLE_EXTRA_PARAM_DEFINITION_MISSING,"SkinExtraParamHandler","_getPropertyExtraParamDefinition",c+"-"+b)(),void 0)},_getExtraParamDefinitionByType:function(a,b){return this.PROPERTY_TYPE_EXTRA_PARAMS[a]&&this.PROPERTY_TYPE_EXTRA_PARAMS[a][b]},_getPropertyExtraParamId:function(a,b){return b+"-"+a},_convertStringToType:function(a,b){switch(b){case"number":a=Number(a);break;case"boolean":a="true"===String(a).toLowerCase()}return a},setPropertyExtraParamValue:function(a,b,c){var d=this._getPropertyExtraParamDefinition(a,b);if(d){var e=this._getPropertyExtraParamId(a,d.prefix);return this._properties[e]=String(c),e}},setPropertyExtraParams:function(a,b){var c=b.type,d=this.PROPERTY_TYPE_EXTRA_PARAMS[c];if(d){var e=b.styleDefaults;for(var f in d){var g,h=d[f],i=this._getPropertyExtraParamId(a,h.prefix);g=this._properties[i]?this._properties[i]:e&&e[h.prefix]?e[h.prefix]:h.defaultValue,this._properties[i]=g,this._propertiesTypes[i]=c+"-"+f,this._increasePropertyUseCount(i)}}},_increasePropertyUseCount:function(a){this._propertiesCounter[a]?this._propertiesCounter[a]+=1:this._propertiesCounter[a]=1}})}),define.Class("core.managers.style.SkinParamMapper",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.utilize(["bootstrap.utils.BufferFunction","core.managers.style.SkinParamParser","core.managers.style.SkinParamRenderHandler"]),b.binds(["_onThemePropertiesChange"]),b.methods({initialize:function(a,b,c){this.SkinParserClass=this.imports.SkinParamParser,this.SkinParamRenderHandlerClass=this.imports.SkinParamRenderHandler,this._dataItem=a,this._rawData=b,this._mapId=this._dataItem.get("id")+"-"+this.getNewGroupIdCounter(),c="string"==typeof c?W.Skins.getSkin(c):c,this._skin=new c,this._initMapProperties(),this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this._garbageCollection(),this.resource.getResourceValue("W.Theme",function(a){a.getDataItem().addEvent(Constants.DataEvents.DATA_CHANGED,this._onThemePropertiesChange)}.bind(this))},_initMapProperties:function(){this._rawData.properties=this._rawData.properties||{},this._rawData.groups=this._rawData.groups||{},this._rawData.propertiesSource=this._rawData.propertiesSource||{}},setSkin:function(a){var b=new a;return this._skin.$className==b.$className?!1:(this._skin=b,this._dataItem.set("skin",this._skin.$className),this._rawData.properties={},this._rawData.propertiesSource={},this._rawData.groups={},this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY),!0)},getSkin:function(){return this.getSkinClassName()},getSkinClassName:function(){return this._skin.$className},getSkinClass:function(){return this._skin.$class},getDataItem:function(){return this._dataItem},getPropertyExtraParamValue:function(a,b){return this._skinParser.getPropertyExtraParamValue(a,b)},setPropertyExtraParamValue:function(a,b,c,d){var e=this._skinParser.setPropertyExtraParamValue(a,b,c),f={},g={};f[e]=this._skinParser.getProperty(e),this._dataItem.fireDataChangeEvent(a,f,g),d&&this._firePropertyChangesEvent(a,f)},_onThemePropertiesChange:function(a,b){for(var c in b){var d=this._skinParser.getProperties();for(var e in d)this.getPropertySource(e)==Constants.STYLE.SOURCE.THEME&&d[e]==c&&this._firePropertyChangesEvent(e)}},_firePropertyChangesEvent:function(a){this._changes||(this._changes={}),this._changes[a]=this._skinParser.getPropertyType(a),this.injects().Utils.clearCallLater(this._dispatchEventId),this._dispatchEventId=this.injects().Utils.callLater(this._dispatchChangeEventAndResetChanges,[],this,50)},_dispatchChangeEventAndResetChanges:function(){this.fireEvent(Constants.StyleEvents.PROPERTY_CHANGED,{style:this,properties:this._changes}),this._changes={}},updateCssRule:function(a,b){this._changedCssClasses||(this._changedCssClasses={}),this._changedCssClasses[a]=b,this._dispatchCssChanges()},_dispatchCssChanges:function(){this.fireEvent("cssChanged",this._changedCssClasses),this._changedCssClasses={}},setRedirectCssTarget:function(a){this._redirectCssTarget=a===!0},isCssRedirectedToStyle:function(){return this._redirectCssTarget},_garbageCollection:function(){this.setStyleRenderFlag(!1),this._skinParser.garbageCollection()},addInnerSkin:function(a,b,c){this._skinParser.parseSkinByInstance(a,b,c)},getNewGroupIdCounter:function(){return this._groupIdCounter=this._groupIdCounter||0,this._groupIdCounter++,this._groupIdCounter},getMapId:function(){return this._mapId},getId:function(){return this._dataItem.get("id")},getProperty:function(a){return this._skinParser.getProperty(a)},setProperty:function(a,b){this._skinParser.setProperty(a,b);var c={},d={};c[a]=b,d[a]=this.getProperty(a),this._dataItem.fireDataChangeEvent(a,c,d),this._firePropertyChangesEvent(a)
},getProperties:function(){return this._skinParser.getProperties()},getGroups:function(){return this._skinParser.getInnerSkins()},isPropertyAvailable:function(a){return this._skinParser.getProperty(a)?!0:!1},getPropertySource:function(a){return this._skinParser.getPropertySource(a)},getPropertyType:function(a){return this._skinParser.getPropertyType(a)},getStyleByGroupName:function(a){return this._skinParser.getInnerSkin(a)},getSkinArray:function(){return this._skinParser.getUsedSkinArray()},changePropertySource:function(a,b,c){this._skinParser.setPropertySource(a,c),this.setProperty(a,b)},getPropertyLangKey:function(a){return this._skinParser.getPropertyLangKey(a)},isStyleRenderedForSkin:function(a){return this._skinParamRenderHandler.isSkinParamRenderedForSkin(a)},isStyleRenderedForAllSkins:function(){return this._skinParamRenderHandler.isSkinParamRenderedForAllSkins()},setStyleRenderFlag:function(a){this._skinParamRenderHandler.setSkinParamRenderFlag(a)},setStyleRenderFlagForSkin:function(a,b){this._skinParamRenderHandler.setSkinParamRenderFlagForSkin(a,b)},invalidateStyle:function(){this._skinParamRenderHandler.invalidateSkinParamMapper()},getStyleType:function(){return this._dataItem.get("styleType")},setStyleType:function(a){this._dataItem.set("styleType",a)},getIsCustomStyle:function(){return"custom"===this.getStyleType()},setIsCustomStyle:function(a){this.setStyleType(a?"custom":"system")},getCompClassName:function(){return this._dataItem.get("componentClassName")},setCompClassName:function(a){this._dataItem.set("componentClassName",a)},getPageId:function(){return this._dataItem.get("pageId")},setPageId:function(a){this._dataItem.set("pageId",a)},getCompId:function(){return this._dataItem.get("compId")},setCompId:function(a){this._dataItem.set("compId",a)},getRawData:function(){return this._rawData}})}),define.Class("core.managers.style.SkinParamParser",function(a){var b=a;b.utilize(["core.managers.style.SkinParamSourceHandler","core.managers.style.SkinExtraParamHandler"]),b.inherits("bootstrap.utils.Events"),b.statics({STYLE_PROPERTIES_FILTER:{color:[Constants.STYLE.SOURCE.THEME],font:[Constants.STYLE.SOURCE.THEME],radius:[Constants.STYLE.SOURCE.VALUE],size:[Constants.STYLE.SOURCE.VALUE],boxShadow:[Constants.STYLE.SOURCE.VALUE]}}),b.methods({initialize:function(a,b,c,d){this._innerSkinMaps={},this._properties=b.properties||{},this._propertiesTypes={},this._propertiesCounter={},this._propertiesLangKey={},this._usedSkinNamesArray=[],this.SkinMapperClass=d;var e=this.imports.SkinParamSourceHandler,f=this.imports.SkinExtraParamHandler;this._paramSourceHandler=new e(b.propertiesSource),this._extraParamHandler=new f(this._properties,this._propertiesTypes,this._propertiesCounter),this._parseSkinAndData(a,b,c)},parseSkinByInstance:function(a,b,c){var d=new c;this._parseSkinAndData(a,b,d)},_parseSkinAndData:function(a,b,c){this._addUsedSkinName(c.$className),this._saveSkinParams(c.getParams()),this._parseSkinInnerComponents(a,b,c.getCompPartsDefinition(),c.imports)},_addUsedSkinName:function(a){this._usedSkinNamesArray.push(a)},_saveSkinParams:function(a){for(var b=0;b<a.length;b++)this._addProperty(a[b])},_addProperty:function(a){var b=a.id,c=this._createParamDataObj(a);if("unknown"!=c.source&&!c.ignore){this._properties[b]=this._properties[b]||a.defaultTheme||a.defaultValue,this._propertiesTypes[b]=c.type,this._propertiesLangKey[b]=c.langKey;var d=this.getPropertySource(b)||c.source;this.setPropertySource(b,d),this._increasePropertyUseCount(b),this._extraParamHandler.setPropertyExtraParams(b,c)}},_createParamDataObj:function(a){var b={};a.defaultTheme?(b.source=Constants.STYLE.SOURCE.THEME,b.value=a.defaultTheme,b.type=W.Theme.getPropertyType(a.defaultTheme)):a.defaultValue&&(b.source=Constants.STYLE.SOURCE.VALUE,b.value=a.defaultValue,b.type=this._getGeneralTypeFromCssType(a.type)),b.langKey=a.lang||a.id,b.styleDefaults=a.styleDefaults||{};var c=a.noshow===!0,d=this.STYLE_PROPERTIES_FILTER[b.type],e=d&&d.contains(b.source);return b.ignore=c===!0||e!==!0,b.ignore=a.enableEdit===!0?!1:b.ignore,b},_getGeneralTypeFromCssType:function(a){return Constants.SkinParamCssTypesToGeneralTypesMap[a]||"unknown"},_increasePropertyUseCount:function(a){this._propertiesCounter[a]?this._propertiesCounter[a]+=1:this._propertiesCounter[a]=1},garbageCollection:function(){for(var a in this._properties)this._propertiesCounter[a]||delete this._properties[a]},_parseSkinInnerComponents:function(a,b,c,d){for(var e in c){var f=c[e].skin,g=c[e].styleGroup,h=this._findSkinByName(f,d);if(g)if("inherit"==g)this.parseSkinByInstance(a,b,h);else{var i=b.groups&&b.groups[g]?b.groups[g]:{properties:{},groups:{}};if(this._innerSkinMaps[g])this._innerSkinMaps[g].addInnerSkin(a,i,h);else{var j=new this.SkinMapperClass(a,i,h);this._innerSkinMaps[g]=j}}}},_findSkinByName:function(a,b){var c=a.substring(a.lastIndexOf(".")+1),d=Object.filter(b,function(a,b){return b==c});return d[c]},getInnerSkins:function(){return this._innerSkinMaps},getInnerSkin:function(a){return this._innerSkinMaps[a]},getProperties:function(){return this._properties},getProperty:function(a){return this._properties[a]},setProperty:function(a,b){this._properties[a]=b},getPropertiesTypes:function(){return this._propertiesTypes},getPropertySource:function(a){return this._paramSourceHandler.getPropertySource(a)},setPropertySource:function(a,b){return this._paramSourceHandler.setPropertySource(a,b)},getPropertyType:function(a){return this._propertiesTypes[a]},getUsedSkinArray:function(){return this._usedSkinNamesArray},setPropertyExtraParamValue:function(a,b,c){return this._extraParamHandler.setPropertyExtraParamValue(a,b,c)},getPropertyExtraParamValue:function(a,b){return this._extraParamHandler.getPropertyExtraParamValue(a,b)},getPropertyLangKey:function(a){return this._propertiesLangKey[a]}})}),define.Class("core.managers.style.SkinParamRenderHandler",function(a){var b=a;b.methods({initialize:function(a){this._innerSkinMaps=a,this._skinParamRenderFlags={}},isSkinParamRenderedForSkin:function(a){return this._skinParamRenderFlags[a]||!1},isSkinParamRenderedForAllSkins:function(){for(var a in this._skinParamRenderFlags)if(!this._skinParamRenderFlags[a])return!1;return!0},setSkinParamRenderFlag:function(a){for(var b in this._skinParamRenderFlags)this.setSkinParamRenderFlagForSkin(b,a)},setSkinParamRenderFlagForSkin:function(a,b){this._skinParamRenderFlags[a]=b},invalidateSkinParamMapper:function(){this.setSkinParamRenderFlag(!1);for(var a in this._innerSkinMaps)this._innerSkinMaps[a].invalidateStyle()}})}),define.Class("core.managers.style.SkinParamSourceHandler",function(a){var b=a;b.methods({initialize:function(a){this._propertiesSource=a||{}},getPropertiesSource:function(){return this._propertiesSource},getPropertySource:function(a){return this._propertiesSource[a]},setPropertySource:function(a,b){this._isPropertySourceValid(b)?this._propertiesSource[a]=b:LOG.reportError(wixErrors.STYLE_PROP_SRC_UNKNOWN,"SkinParamSourceHandler","setPropertySource",b)()},_isPropertySourceValid:function(a){var b=!1;for(var c in Constants.STYLE.SOURCE)Constants.STYLE.SOURCE[c]===a&&(b=!0);return b}})}),define.Class("core.managers.style.Style",function(a){var b=a;b.inherits("core.managers.style.StyleProperties"),b.methods({initialize:function(a){this._ready=!1,a&&this._setStyleDataItem(a)},_setStyleDataItem:function(a){this._skinName=a.get("skin"),this._resetDataCollection(),a.get("style")||a.set("style",{}),this._configStyle(a.get("style"),a,this._skinName,this)},_resetDataCollection:function(){this._groupIdCounter=0;var a=this._onProcessAllSkins.bind(this);this.unprocessedSkins={map:{},size:0,add:function(a){this.map[a]?this.map[a]=1:this.map[a]++,this.size++},remove:function(b){this.map[b]&&this.map[b]--,this.size--,0===this.size&&a()}}},_onProcessAllSkins:function(){this._garbageCollection(),this._oldSkinName!=this._skinName&&this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY,this),this._ready=!0},isReady:function(){return this._ready},getNewGroupId:function(){return this._groupIdCounter=this._groupIdCounter||0,this._groupIdCounter++,this._groupIdCounter},setSkin:function(a){return this._skinName==a?!1:(this._ready=!1,this._resetUsedSkinNameArray(),this.setStyleRenderFlag(!1),this._oldSkinName=this._skinName,this._skinName=a,this._styleDataItem.set("skin",a),this._styleRawData.properties={},this._styleRawData.propertiesSource={},this._styleRawData.groups={},this._resetData(this._styleRawData.properties,this._styleRawData.propertiesSource,this._styleRawData.groups),this.createStylesAndRawData(this._styleRawData,a),!0)},getSkin:function(){return this._skinName},getId:function(){return this._styleDataItem.get("id")}})}),define.Class("core.managers.style.StyleProperties",function(a){var b=a;b.utilize(["bootstrap.utils.BufferFunction"]),b.inherits("bootstrap.utils.Events"),b.binds(["_onThemePropertiesChange"]),b.statics({STYLE_PROPERTIES_FILTER:{color:[Constants.STYLE.SOURCE.THEME],font:[Constants.STYLE.SOURCE.THEME],radius:[Constants.STYLE.SOURCE.VALUE],size:[Constants.STYLE.SOURCE.VALUE],boxShadow:[Constants.STYLE.SOURCE.VALUE]},PROPERTY_TYPE_EXTRA_PARAMS:{color:{alpha:{prefix:"alpha",defaultValue:1,type:"number"}},boxShadow:{isOn:{prefix:"boxShadowToggleOn",defaultValue:!0,type:"boolean"}}}}),b.methods({initialize:function(a,b,c,d){a&&b&&c&&d&&this._configStyle(a,b,c,d)},setRedirectCssTarget:function(a){this._redirectCssTarget=a===!0},isCssRedirectedToStyle:function(){return this._redirectCssTarget},updateCssRule:function(a,b){this._changedCssClasses[a]=b,this._dispatchCssChanges()},_dispatchCssChanges:function(){this.fireEvent("cssChanged",this._changedCssClasses),this._changedCssClasses={}},_configStyle:function(a,b,c,d){this._redirectCssTarget=!1,this._changedCssClasses={};var e=new this.imports.BufferFunction(this,"_dispatchCssChanges");e.setBufferTime(50),this._resetUsedSkinNameArray(),this.StyleClass=W.Classes.get("core.managers.style.StyleProperties"),this._isStyleRendered={},this._groupId=b.get("id")+"-"+d.getNewGroupId(),this._topLevelStyle=d,this._styleDataItem=b,this._styleRawData=a,a.properties=a.properties||{},a.propertiesSource=a.propertiesSource||{},a.groups=a.groups||{},this._resetData(a.properties,a.propertiesSource,a.groups),this._changes={},this.createStylesAndRawData(a,c),this.resource.getResourceValue("W.Theme",function(a){a.getDataItem().addEvent(Constants.DataEvents.DATA_CHANGED,this._onThemePropertiesChange)}.bind(this))},_resetData:function(a,b,c){this._properties=a||{},this._propertiesSource=b||{},this._groups=c||{},this._propertiesTypes={},this._propertiesCounter={},this._propertiesLangKey={},this._groupsStyleObjects={}},_onThemePropertiesChange:function(a,b){for(var c in b)for(var d in this._properties)this._propertiesSource[d]==Constants.STYLE.SOURCE.THEME&&this._properties[d]==c&&this._firePropertyChangesEvent(d)},_firePropertyChangesEvent:function(a){this._changes[a]=this._propertiesTypes[a],this.injects().Utils.clearCallLater(this._dispatchEventId),this._dispatchEventId=this.injects().Utils.callLater(this._dispatchChangeEventAndResetChanges,[],this,50)},_dispatchChangeEventAndResetChanges:function(){this.fireEvent(Constants.StyleEvents.PROPERTY_CHANGED,{style:this,properties:this._changes}),this._changes={}},isStyleRenderedForSkin:function(a){return this._isStyleRendered[a]||!1},isStyleRenderedForAllSkins:function(){for(var a in this._isStyleRendered)if(!this._isStyleRendered[a])return!1;return!0},setStyleRenderFlag:function(a){for(var b in this._isStyleRendered)this.setStyleRenderFlagForSkin(b,a)},setStyleRenderFlagForSkin:function(a,b){this._isStyleRendered[a]=b},invalidateStyle:function(){this.setStyleRenderFlag(!1);for(var a in this._groupsStyleObjects)this._groupsStyleObjects[a].invalidateStyle()},get:function(a){return this._properties[a]},getStyleByGroupName:function(a){return this._groupsStyleObjects[a]},set:function(a,b){var c={},d={};c[a]=b,d[a]=this._properties[a],this._properties[a]=b,this._styleDataItem.fireDataChangeEvent(a,c,d),this._firePropertyChangesEvent(a)},changePropertySource:function(a,b,c){this._isPropertySourceValid(c)?(this._propertiesSource[a]=c,this.set(a,b)):LOG.reportError(wixErrors.STYLE_PROP_SRC_UNKNOWN,"StyleProperties","changePropertySource",c)()},_isPropertySourceValid:function(a){var b=!1;for(var c in Constants.STYLE.SOURCE)Constants.STYLE.SOURCE[c]===a&&(b=!0);return b},getPropertyExtraParamValue:function(a,b){var c=this.getPropertyType(a),d=this._getExtraParamDefinitionByType(c,b);if(!d)return LOG.reportError("STYLE_EXTRA_PARAM_DEFINITION_MISSING","StyleProperties","setPropertyExtraParamValue",c+"-"+b)(),void 0;var e=this._getPropertyExtraParamId(a,d.prefix);return this._convertStringToType(this._properties[e],d.type)},setPropertyExtraParamValue:function(a,b,c,d){var e=this.getPropertyType(a),f=this._getExtraParamDefinitionByType(e,b);if(!f)return LOG.reportError("STYLE_EXTRA_PARAM_DEFINITION_MISSING","StyleProperties","setPropertyExtraParamValue",e+"-"+b)(),void 0;var g=this._getPropertyExtraParamId(a,f.prefix);this._properties[g]=String(c);var h={},i={};h[g]=this._properties[g],this._styleDataItem.fireDataChangeEvent(a,h,i),d&&this._firePropertyChangesEvent(a,h,i)},_convertStringToType:function(a,b){switch(b){case"number":a=Number(a);break;case"boolean":a="true"===String(a).toLowerCase()}return a},_getExtraParamDefinitionByType:function(a,b){return this.PROPERTY_TYPE_EXTRA_PARAMS[a]&&this.PROPERTY_TYPE_EXTRA_PARAMS[a][b]},_getPropertyExtraParamId:function(a,b){return b+"-"+a},isPropertyAvailable:function(a){return this._propertiesTypes.hasOwnProperty(a)},createStylesAndRawData:function(a,b){this._topLevelStyle.unprocessedSkins.add(b),W.Skins.getSkin(b,function(c){this._addUsedSkinName(b);var d=new c;this._saveSkinParamsAsProperties(d.getParams()),this._parseSkinInnerComponents(a,d.getCompPartsDefinition()),this._topLevelStyle.unprocessedSkins.remove(b)}.bind(this))},_saveSkinParamsAsProperties:function(a){for(var b=0;b<a.length;b++)this._addProperty(a[b])},_addProperty:function(a){var b=a.id,c=this._getParamData(a);"unknown"==c.source||c.ignore||(this._properties[b]=this._properties[b]||a.defaultTheme||a.defaultValue,this._propertiesTypes[b]=c.type,this._propertiesSource[b]=this._propertiesSource[b]||c.source,this._propertiesLangKey[b]=c.langKey,this._increasePropertyUseCount(b),this._setPropertyExtraParams(b,c))},_parseSkinInnerComponents:function(a,b){for(var c in b){var d=b[c].skin,e=b[c].styleGroup;if(e&&"undefined"!=e.toLowerCase())if("inherit"==e)this.createStylesAndRawData(a,d);else{a.groups[e]||(a.groups[e]={properties:{},groups:{}});var f=a.groups[e];if(this._groupsStyleObjects[e])this._groupsStyleObjects[e].createStylesAndRawData(f,d);else{var g=new this.StyleClass(f,this._styleDataItem,d,this._topLevelStyle);this._groupsStyleObjects[e]=g}}}},_getParamData:function(a){var b={source:"unknown"};a.defaultTheme?(b.source=Constants.STYLE.SOURCE.THEME,b.value=a.defaultTheme,b.type=W.Theme.getPropertyType(a.defaultTheme)):a.defaultValue&&(b.source=Constants.STYLE.SOURCE.VALUE,b.value=a.defaultValue,b.type=this._getGeneralTypeFromCssType(a.type)),b.langKey=a.lang||a.id,b.styleDefaults=a.styleDefaults||{};var c=a.noshow===!0,d=a.enableEdit===!0,e=this.STYLE_PROPERTIES_FILTER[b.type],f=e&&e.contains(b.source);return b.ignore=c===!0||f!==!0,b.ignore=d?!1:b.ignore,b},_increasePropertyUseCount:function(a){this._propertiesCounter[a]?this._propertiesCounter[a]+=1:this._propertiesCounter[a]=1},_garbageCollection:function(){for(var a in this._properties)this._propertiesCounter[a]||delete this._properties[a];this.setStyleRenderFlag(!1);for(var b in this._groupsStyleObjects)this._groupsStyleObjects[b]._garbageCollection()},_getGeneralTypeFromCssType:function(a){return Constants.SkinParamCssTypesToGeneralTypesMap[a]||"unknown"},_setPropertyExtraParams:function(a,b){var c=b.type,d=this.PROPERTY_TYPE_EXTRA_PARAMS[c];if(d){var e=b.styleDefaults;for(var f in d){var g=d[f],h=this._getPropertyExtraParamId(a,g.prefix);this._properties[h]=this._properties[h]||e[g.prefix]||g.defaultValue,this._propertiesTypes[h]=c+"-"+f,this._increasePropertyUseCount(h)}}},getId:function(){return this._groupId},getProperties:function(){return this._properties},getGroups:function(){return this._groupsStyleObjects},getPropertyType:function(a){return this._propertiesTypes[a]},getPropertySource:function(a){return this._propertiesSource[a]},getPropertyLangKey:function(a){return this._propertiesLangKey[a]},_addUsedSkinName:function(a){this._usedSkinNamesArray.push(a)},_resetUsedSkinNameArray:function(){this._usedSkinNamesArray=[]},getSkinArray:function(){return this._usedSkinNamesArray}})}),define.Const("SKIN_PARAM",{SOURCE:{THEME:"theme",VALUE:"value"}}),define.Const("STYLE",{SOURCE:{THEME:"theme",VALUE:"value"}}),define.Const("StyleEvents",{SKIN_CHANGED:"skinChange",READY:"styleReady",PROPERTY_CHANGED:"propertyChange"}),define.experimentPlugin("ExperimentDataThemeItemPlugin",function(a){function b(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),d=b(c),e=c._mergeField_(a,d);return e}function c(a,b){define.dataThemeItem(a,b())}var d=a;d.init("dataThemeItem","newDataThemeItem",b,c)}),define.Class("core.managers.theme.ThemeManager",function(a){var b=a;b.inherits("core.managers.data.DataManager"),b.utilize(["core.managers.style.SkinParamMapper","bootstrap.utils.Queue","core.utils.css.BorderRadius","core.utils.css.Color","core.utils.css.Size","core.utils.css.Font","core.utils.css.BoxShadow","core.utils.css.Background"]),b.binds(["_onDataChanged","_onDataReady","_onPropChange","_updateEffectedProps"]),b.statics({INIT_STYLE_RAW_DATA:{type:"TopLevelStyle",skin:"skin-name-place-holder",style:{properties:{},groups:{}}},TEXT_STYLE_SHEET:""}),b.fields({DEFINE_NAMESPACE:"dataThemeItem"}),b.methods({initialize:function(){this.parent(),this.SkinParamMapperClass=this.imports.SkinParamMapper,this._placeHoldersMap={},this._isReady=!0,this._isDataReady=!1,this._styleQueue=new this.imports.Queue,this._styleCache={},this._stylesInProcess={},this._isOperating=!1,this.getDataByQuery("#THEME_DATA",this._onDataReady)},getStyle:function(a,b,c){if(this._styleCache[a])b(this._styleCache[a]);else{if(this._styleQueue.add(a,b),this._styleQueue.getQueue(a).length>1)return;var d=function(b){this._styleCache[a]=b,this._styleQueue.getQueue(a).forEach(function(a){a(b)}),this._styleQueue.removeKey(a)}.bind(this);this.isStyleAvailable(a)?this.getDataByQuery("#"+a,function(a){a.get("style"),W.Skins.getSkin(a.get("skin"),function(b){var c=new this.SkinParamMapperClass(a,a.get("style"),b);d(c)}.bind(this))}.bind(this)):this.createStyle(a,"",c,d)}},isStyleAvailable:function(a){return this.isDataAvailable("#"+a)},invalidateStyle:function(a){this._styleCache[a]&&this._styleCache[a].invalidateStyle()},createStyle:function(a,b,c,d){this._styleCache[a]&&LOG.reportError(wixErrors.STYLE_ALREADY_EXISTS,"ThemeManager","createStyle",a)();var e=Object.clone(this.INIT_STYLE_RAW_DATA);e.skin=c;var f=this.addDataItem(a,e);W.Skins.getSkin(f.get("skin"),function(a){var b=new this.SkinParamMapperClass(f,f.get("style"),a),c=b.getId();this._styleCache[c]=b,d(b)}.bind(this))},createStyleFromData:function(a,b,c){var d=c||a.skin,e=Object.clone(a),f=b?b+"_":"",g=f+Date.now().toString(36),h=this.addDataItem(g,e),i=new this.SkinParamMapperClass(h,h.get("style"),d);return this._styleCache[h.get("id")]=i,i},cloneStyle:function(a,b){var c=a.getDataItem(),d=a.getSkinClass(),e=c.getData(),f=this.createStyleFromData(e,b,d);return f},getPropertyType:function(a){return this._data.getFieldSchema(a).type},_onDataReady:function(a){var b="Theme"===a.get("type");if(b){var c=a;a=this.addDataItem(c.get("id"),{type:this._getThemeSchemaTypeName()});var d=c.get("properties");for(var e in d)a.set(e,d[e].value)}this._setData(a),this._isDataReady=!0,this.fireEvent("dataReady")},isDataReady:function(){return this._isDataReady},_getThemeSchemaTypeName:function(){return"WFlatTheme"},_setData:function(a){this._flattenData(a),this._data&&this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChanged),this._data=a,this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChanged),this._indexAllPlaceholders()},_flattenData:function(a){this._flattenedDataItems={};var b,c,d,e=a.getData(),f=a.getSchema(),g={};for(d in e)if("array"==typeOf(e[d])){b=d;var h=e[d],i=h.length,j=f[d].defaultItems;if(j.length>i)for(var k=i;k<j.length;k++)h.push(j[k]),i++;for(c=0;i>c;c++)g[b+"_"+c]=h[c],this._flattenedDataItems[b+"_"+c]=b}else g[d]=e[d];a.setData(g);var l={};for(d in f)if("array"==f[d].type){b=d;var m=f[d].itemType,n=f[d].defaultItems;for(c=0;c<n.length;c++)l[b+"_"+c]={type:m,"default":n[c]},this._flattenedDataItems[b+"_"+c]||(this._flattenedDataItems[b+"_"+c]=b)}else l[d]=f[d];a.setSchema(l)},_indexAllPlaceholders:function(){this._placeHoldersMap={};var a=this._data.getSchema();for(var b in a)this._updatePlaceholdersInProperty(b,this.getRawProperty(b))},_updatePlaceholdersInProperty:function(a,b,c){var d=this._getPlaceholders(b,!0),e=c?this._getPlaceholders(c,!0):{},f=Object.merge({},e,d);for(var g in f)this._placeHoldersMap[g]=this._placeHoldersMap[g]||{},d[g]&&!e[g]?this._placeHoldersMap[g][a]=a:d[g]||delete this._placeHoldersMap[g][a]},_getPlaceholders:function(a,b){for(var c=/\[([^}]+)\]/g,d=/\{([^}]+)\}|\[([^}]+)\]/g,e=b?d:c,f={},g=e.exec(a);g;){var h=g[1]||g[2];h&&(f[h]=h),g=e.exec(a)}return f},clone:function(a){var b=this.parent(a);return b},isReady:function(){return this._isReady},getProperties:function(){var a={},b=this._data.getSchema();for(var c in b)a[c]={value:this.getRawProperty(c),type:this._data.getFieldSchema(c).type};return a},getProperty:function(a,b,c){var d=this._data.get(a),e="string"===typeOf(d)?d:d.clone?d.clone():Object.clone(d),f=this._data.getFieldSchema(a);if(!f)return LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"ThemeManager","getProperty",[a,this._data.getData(),null]),null;var g=this.getPropertyType(a);if(!b&&"string"==typeOf(e)&&-1!=e.indexOf("["))for(var h in this._data.getSchema())-1!=e.indexOf("["+h+"]")&&(e=e.split("["+h+"]").join(this.getProperty(h)));if(c)return e;switch(g){case"themeUrl":return W.Config.getImagesUrl()+"/web/";case"color":return new this.imports.Color(e);case"background":return new this.imports.Background(e,this);case"font":return new this.imports.Font(e,this);case"radius":return new this.imports.BorderRadius(e);case"webThemeUrl":return W.Config.getServiceTopologyProperty("staticThemeUrlWeb")+"/"+e+"/"}return e},_onDataChanged:function(a,b){if(!this._isOperating){if(this._isOperating=!0,this._indexAllPlaceholders(),"string"==typeof b)this._updateEffectedProps(b);else for(var c in b)this._updateEffectedProps(c);this._isOperating=!1}},reportDataItemChangeEvent:function(a,b,c,d,e){if(this.fireEvent(Constants.DataEvents.DATA_CHANGED,[a,b,c,d]),!e&&void 0!==b&&void 0!==c&&a._data.id&&!this.injects().Utils.areObjectsEqual(b,c)){if(!d)return;this.fireEvent("undoDataChangedEvent",[a,b,c,d])}},getRawProperty:function(a){return this.getProperty(a,!0,!0)},clearOverrides:function(){this._data.reset()},getOverrides:function(){return this.getProperties()},getDataItem:function(){return this._data},setProperty:function(a,b){var c=this._data.getFieldSchema(a);if(!c)return LOG.reportError(wixErrors.SCHEMA_MISSING_KEY,"ThemeManager","setProperty",[a,this._data.getData(),null]),void 0;var d=c.type;"color"==d&&b&&b.getRgba&&(b=b.getRgba()),this._updatePlaceholdersInProperty(a,b,this.getRawProperty(a)),this._data.set(a,b),this._updateEffectedProps(a)},getPropertiesAccordingToType:function(a){var b=[],c=this._data.getSchema();for(var d in c)a==this._data.getFieldSchema(d).type&&b.push(d);return b},_onPropChange:function(a,b){var c=[a];b=b||this.getProperty(a),this.fireEvent("propertyChange",{name:a,newVal:b,type:"propertyChange"});var d=this._placeHoldersMap[a];for(var e in d)c.combine(this._onPropChange(e,this.getProperty(e)));return c},_updateEffectedProps:function(a){var b=this._onPropChange(a),c={};b.forEach(function(a){c[a]=this._data.get(a)}.bind(this)),this._data.fireDataChangeEvent(c)},getDirtyDataObjectsMap:function(){var a=this.parent();if(a&&a.THEME_DATA){a.THEME_DATA=this.createDataItem(Object.clone(a.THEME_DATA.getData()),this._getThemeSchemaTypeName());var b=a.THEME_DATA.getData();for(var c in b)if(this._flattenedDataItems&&this._flattenedDataItems[c]){var d=this._flattenedDataItems[c];b[d]||(b[d]=[]),b[d].push(b[c]),delete b[c]}}return a}})}),define.Const("Theme",{COLOR_PALETTE_INDEX:11,COLOR_SUB_PALETTE_SIZE:5}),define.Class("core.managers.viewmanager.ViewManagerBase",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.binds(["_onTransitionFinished","_onEditModeChanged","_onHashChange"]),b.methods({initialize:function(){this._isReady=!0,this._isSiteReady=!1,this._pages=null,this._pagesData=null,this._mainPageData=null,this._siteStructureData=null,this._currentPageId=null,this._isFullScreen=null,this._fullScreenCallbacks=[],this._scrollLock=!1,this._isPageScrollToTopEnabled=!0,this._stopAnimation=null,this._loadedExtJS={},this._pendingExtJS=[],this._onSiteReady=this._onSiteReady.bind(this),this._loadNextPage=this._loadNextPage.bind(this),this._loadScript=this._loadScript.bind(this),this._onScriptLoaded=this._onScriptLoaded.bind(this);var a=W.Utils.getQueryParam("isEdited");"true"==a&&this.setPreviewMode(!0),this.addEvent("pageTransitionEnded",this._onTransitionFinished)},setPreviewMode:function(a){this._isPreview=a,a&&document&&document.body&&$(document.body).addClass("prevMode")},setStopAnimation:function(a){this._stopAnimation=a},getNewUniquePageId:function(a){var b;do b=W.Utils.getUniqueId(a+"Page");while(void 0!==this._pages[b]);return b},isScrollLock:function(){return this._scrollLock},setLinkTipFunc:function(a){this._linkTipFunc=a},getLinkTipFunc:function(){return this._linkTipFunc},getPreviewMode:function(){return!!this._isPreview},setSite:function(a,b,c){a||LOG.reportError(wixErrors.VM_INVALID_SITE_NODE,this.className,"setSite",""),b||LOG.reportError(wixErrors.VM_INVALID_SITE_DATA,this.className,"setSite",""),this._siteNode=a,this._siteStructureData=b,this.indexPages("#SITE_PAGES"),this._siteNode.addEvent(Constants.ComponentEvents.WIXIFIED,function(){b.addComponentWithInterest(this.getLogic())}),this._isInViewer()?this._wixifySiteLazily(a,c):this._wixifyEntireSite(a);var d=this._siteNode.getProperty("comp");d&&d.contains("components.SiteStructure")&&this._siteNode.wixify()},_isInViewer:function(){return"editor"!==this.getViewMode()},_getUrlSearchParameters:function(){return window.location.search},_wixifyEntireSite:function(a){var b=a.getElements("[comp]");if(window.adData){this.setAdData(window.adData);var c=document.getElementById("wixFooter");c&&b.push(c)}a.get("comp")&&b.push(a),new Async.Bulk(b,null,{timeout:2e4,completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){b.removeClass("initHidden"),this.updatePagesData();for(var a in this._pages){var c=this._pages[a].getLogic();c.setAsWixified()}this._onSiteReady()}.bind(this)}),b.wixify()},_getAllComponents:function(a,b){var c=a.getElements("[comp]");return a.get("comp")&&c.push(a),c.filter(b)},_notChildOfSelector:function(a,b){return null==a.getParent(b)},_notInPage:function(a){return this._notChildOfSelector(a,"[comp=mobile.core.components.Page],[comp=core.components.Page],[comp=wixapps.integration.components.AppPage]")},_getInitComponents:function(a){return this._getAllComponents(a,function(a){return this._notInPage(a)}.bind(this))},_wixifySiteLazily:function(a,b){var c=this._getInitComponents(a);if(window.adData){this.setAdData(window.adData);var d=document.getElementById("wixFooter");d&&c.push(d)}new Async.Bulk(c,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){c.removeClass("initHidden"),this.updatePagesData();var a=[];if(b===!1)for(var d in this._pages)a.push(this._pages[d].getLogic());else{var e=this._getPageDataFromHash(W.Utils.hash.getHash());a.push(this._pages[e.get("id")].getLogic())}new Async.Bulk(a,null,{completeEvent:"contentWixified",completeCallback:function(){this._onSiteReady()}.bind(this)});for(var f=0;f<a.length;++f)a[f].wixifyContent()}.bind(this)}),c.wixify()},_onSiteReady:function(){this.setPreviewMode(this._isPreview),this._isReady=!0,this._isSiteReady=!0,window.scrollTo(0,1),W.Utils.hash.addEvent("change",this._onHashChange),W.Utils.hash.fireHashChangeEvent(),this._loadNextPage(),this._reportBIEvents(),this.fireEvent("SiteReady"),"editor"==window.viewMode&&"#save=1"==window.location.hash&&(window.location.hash="save=0",W.Commands.executeCommand("WEditorCommands.SaveSuccessDialog"))},_reportBIEvents:function(){switch(window.viewMode){case"preview":LOG.reportEvent(wixEvents.PREVIEW_READY);break;case"site":var a=W.Pages&&W.Pages.loadSite&&!window.wixData,b={c1:a};LOG.reportEvent(wixEvents.SITE_READY,b)}},getViewMode:function(){return window.viewMode},_loadNextPage:function(){},createElement:function(a,b){return new Element(a,b)},clone:function(a){return this.parent(a)},isReady:function(){return this._isReady},isSiteReady:function(){return this._isSiteReady},_onHashChange:function(a){if(a=a||{},this.isSiteReady()){var b=a.newHash,c=a.isIdChanged;W.Data.isDataAvailable("#"+b)?(W.Data.getDataByQuery("#"+b,function(a){this._setDataObjectFromHash(a,b,c)}.bind(this)),a.isForSureAfterChange&&LOG.reportPageEvent(window.location.href)):this._changePageFromHash(b)}},_setDataObjectFromHash:function(a,b,c){c&&a.getType&&"Page"===a.getType()&&b&&this._changePageFromHash(b)},_changePageFromHash:function(a){var b=this._getPageDataFromHash(a);if(null!==b){var c=b.get("id");c!=this._currentPageId&&c&&this._pageTransition(c)}},_getPageDataFromHash:function(a){a=a||W.Utils.hash.getHash();var b=this._mainPageData;for(var c in this._pagesData){var d=this._pagesData[c],e=d.getMeta("isHidden")&&!this._isPreview;if(d.get("id")==a&&!e){b=d;break}}return b},_pageTransition:function(a){var b=this.getCurrentPageNode(),c=this._siteNode.getElement("#"+a);if(c){if(W.Utils.clearCallLater(this._setVisiblePageCallId),this._currentPageId=a,this._isFullScreen&&this.exitFullScreenMode(),b)b.getLogic().collapse();else for(var d in this._pages){var e=this._pages[d];e!=c&&e.getLogic().collapse()}c.getLogic().uncollapse(),this._setVisiblePageCallId=W.Utils.callLater(function(){c.getLogic().wixifyContent(function(){W.Editor&&W.Editor.setKeysEnabled(!0),this.fireEvent("pageTransitionEnded"),W.Utils.callLater(function(){})}.bind(this))}.bind(this)),W.Editor&&W.Editor.setKeysEnabled(!1),this.fireEvent("pageTransitionStarted")}},getScrollTop:function(){return document.body.scrollTop},getPagesData:function(){return this._pagesData},_scrollToTopOnPageChange:function(){this._isPageScrollToTopEnabled&&(this._isPreview?(this._siteNode.setStyle("top","0px"),$(document.body).setStyle("background-position","0px 0px")):$(document.body).scrollTo(0,0))},goToPage:function(a){if(!this._scrollLock){null!==this._stopAnimation&&this._stopAnimation.stop(),this._scrollToTopOnPageChange();var b=this._pagesData[a];b&&this._currentPageId!=a&&(("preview"===window.viewMode||"editor"===window.viewMode)&&LOG.reportEvent(wixEvents.USER_REQUESTED_PAGE_MOVE,{c1:b._data&&b._data.pageUriSEO||"no-page-url"}),this._pageTransition(a))}},_onTransitionFinished:function(){this._setUrlHashToPage(this._currentPageId)},_setUrlHashToPage:function(a){var b=this._pagesData[a];b&&W.Utils.hash.setHash(a,b.get("pageUriSEO"))},goToHomePage:function(){this.goToPage(this.getHomePageId())},isHomePage:function(a){return a=a||this._currentPageId,this._isSiteReady?a==this.getHomePageId():!0},getHomePageId:function(){return this._isSiteReady&&this._mainPageData?this._mainPageData.get("id"):void 0},getCurrentPageId:function(){return this._currentPageId},getCurrentPageNode:function(){var a=null;return this._currentPageId&&this._siteNode&&(a=this._siteNode.getElement("#"+this._currentPageId)),a},indexPages:function(a){var b=this._siteNode.getElement(a);
if(!b)return W.Utils.callLater(this.indexPages,[a],this,10);var c={},d=[],e="[comp=mobile.core.components.Page],[comp=core.components.Page]";b.getElements(e).each(function(a){var b=a.get("id")||W.Utils.getUniqueId("page");c[b]=a,a.addClass("sitePage");var e=a.get("dataQuery");e!=this._siteStructureData.get("mainPage")&&d.push(e)}.bind(this));var f=this._siteStructureData.getData().pages;f||(f=[]);for(var g=0;g<f.length;++g){var h=f[g],i=d.indexOf(h);-1!=i&&(d.splice(i,1),d.splice(g,0,h))}var j=W.Data.isDataChange();this._siteStructureData.set("pages",d),j&&W.Data.flagDataChange(),this._pages=c},loadExternalScript:function(a,b,c){return a in this._loadedExtJS?(b(),"ALREADY_LOADED"):a in this._pendingExtJS?(this._pendingExtJS[a].push(b),"PENDING_LOAD"):(this._pendingExtJS[a]=[b],this._loadScript(a,c),"FIRST_LOAD")},_loadScript:function(a){var b=document.createElement("script");b.type="text/javascript",b.async=!1,b.readyState?b.onreadystatechange=function(){("loaded"===b.readyState||"complete"===b.readyState)&&(b.onreadystatechange=null,this._onScriptLoaded(a))}.bind(this):b.onload=function(){this._onScriptLoaded(a)}.bind(this),b.src=a;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)},_onScriptLoaded:function(a){this._loadedExtJS[a]=!0;for(var b=this._pendingExtJS[a],c=0;c<b.length;c++)b[c]();delete this._pendingExtJS[a]},_getSiteViewMode:function(){var a=window.viewMode;return"preview"==a&&window.top===window?"site":a},isPublicMode:function(){return"site"==this._getSiteViewMode()},updatePagesData:function(){this._pagesData={};for(var a in this._pages){var b=this._pages[a].getLogic().getDataItem();this._pagesData[b.get("id")]=b,this._siteStructureData.get("mainPage")=="#"+b.get("id")&&(this._mainPageData=b)}},getSiteNode:function(){return this._siteNode},_onEditModeChanged:function(a){this._editorMode=a},getEditorMode:function(){return this._editorMode}})}),define.Const("ViewEvents",{ORIENTATION_CHANGE:"orientationchange"}),define.Const("ViewManager",{VIEW_MODE_SITE:"site",VIEW_MODE_EDITOR:"editor",VIEW_MODE_PREVIEW:"preview"}),define.component("core.components.BaseList",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.binds(["_onItemReady","_onDataItemsReady","_onChildAutoSized","_onChildAutoSizedAnimation"]),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._itemClassName=c&&c.itemClassName||this._itemClassName,this._itemsNodes=[]},_renderItems:function(a,b){a=a||[],0===a.length?(this.getItemsContainer().empty(),this._onAllItemsReady()):b?this._onDataItemsReady(null,a):this._data.getDataManager().getDataByQueryList(a,function(b){this._onDataItemsReady(a,b)}.bind(this))},_createHiddenItems:function(){return!0},_createItem:function(a,b,c,d){var e=this._skin.itemSkinClassName,f=this.getItemClassName();if(!e)return LOG.reportError(wixErrors.NO_SKIN,"BaseList","_createItem",{c1:this.className}),new Element("b");if(!f)return LOG.reportError(wixErrors.MISSING_METHOD,this.className,"_createItem",""),new Element("b");var g=W.Utils.getUniqueId(Constants.components.BASE_LIST_ITEM_PREFIX),h=new Element("div",{id:g});return this._getParamsToPassToItem(a,function(c){var g=a;this.injects().Data.isDataItem(a)||(g=null),this.injects().Components.createComponent(f,e,g,c,function(){b(h,!0,a,d)},void 0,void 0,h)}.bind(this)),h},getSkinElementByIndex:function(a){var b=this.getItemsContainer().getChildren();return b[a]},_getParamsToPassToItem:function(a,b){b(void 0)},_onItemReady:function(){},_onAllItemsReady:function(){},getItemClassName:function(){return this._itemClassName},getItemsContainer:function(){return this._view},_onChildAutoSizedAnimation:function(){this.fireEvent("autoSizedAnimation")},_onChildAutoSized:function(){this.fireEvent("autoSized")},_onDataItemsReady:function(a,b){var c=this._itemsNodes||[];this._itemsNodes=[],this.getItemsContainer().empty();var d,e,f,g=[],h=0,i=function(a,b,c,d){if(a){var e=a.getLogic();this.fireEvent("itemReady",[e,e.getDataItem(),b]),e.addEvent("autoSizedAnimation",this._onChildAutoSizedAnimation),e.addEvent("autoSized",this._onChildAutoSized),this._onItemReady(e,b,c)}if(++h>=d){var f=this._itemsNodes.clean();f.length>1&&(f[0].addClass("firstItem"),f[f.length-1].addClass("lastItem")),this._itemsNodes=f,this._onAllItemsReady()}}.bind(this),j=this.getItemsContainer(),k=function(a,b,d){if(!this._createHiddenItems()&&a.getMeta("isHidden"))return i(null,!1,a,d),void 0;var e=void 0;this.injects().Data;for(var f=0;f<c.length;++f){var g=c[f];if(g&&g.getLogic&&a===g.getLogic().getDataItem()){e=g,c.splice(f,1);break}}e?i(e,!1,a,d):e=this._createItem(a,i,b,d),this._itemsNodes[b]=e,e.removeClass("firstItem").removeClass("lastItem"),e.insertInto(j)}.bind(this);if(a)for(e=0,d=a.length;d>e;++e)f=b[a[e]],k(f,e,d);else for(e=0,d=b.length;d>e;++e)f=b[e],k(f,e,d);g.length>1&&(g[0].addClass("firstItem"),g[g.length-1].addClass("lastItem"))},_disposeItems:function(a){if(a)for(var b=a.length-1;b>=0;--b){var c=a[b],d=c.getLogic&&c.getLogic();d&&(this._disposeItem(d),d.dispose())}},_disposeItem:function(){}})}),define.component("core.components.BaseRepeater",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.statics({repeaterStates:{INITIATE:"init",LOADING:"loading",READY:"ready"}}),b.fields({_elementPool:[],_usedElementPool:[],_stillLoading:!1}),b.methods({_onDataChange:function(){this._allRepeatersReady=!1,this.parent()},_setSkinPartElements:function(a){this._allRepeatersReady=!1,this.parent(a)},_prepareForRender:function(){return this._data&&0!==this._data.length?(this._allRepeatersReady===!1&&(this._repeaterDefinitions=this._getRepeaterDefinitions(),this._startRepeaterCreations()),this._allRepeatersReady):!0},_getRepeaterDefinitions:function(){var a=[];for(var b in this._skinPartsSchema)if(this._skinPartsSchema[b].repeater&&this._skinPartsSchema[b].autoCreate!==!1){var c=this.getSkinPartDefinition(b);c.hookMethod&&"function"==typeOf(this[c.hookMethod])&&(c=this[c.hookMethod](c)),a.push(c)}return a},_startRepeaterCreations:function(){if(!this._stillLoading){this._usedElementPool=[],this._beforeRepeatersCreation(),this._repeatersDataOld=this._repeatersData,this._repeatersData={},this._stillLoading=!0;for(var a=0;a<this._repeaterDefinitions.length;++a){var b=this._repeaterDefinitions[a],c={};this._repeatersData[b.id]=c,c.definition=b,c.pendingItems=[],c.readyItems=[],c.readyItemsLogic=[],c.state=this.repeaterStates.INITIATE,this._loadRepeater(c)}this._checkIfRepeatersReady()}},_checkIfRepeatersReady:function(){for(var a in this._repeatersData){var b=this._repeatersData[a];if(b.state!=this.repeaterStates.READY)return!1}return!0},_loadRepeater:function(a){if(a.definition.autoCreate!==!1){var b=function(b,c){this._onLoadRepeaterReady(b,c,a)}.bind(this),c=this._getRepeaterContainer(a);c&&c.empty();var d,e=this._getRepeaterDataList(a.definition);if(e=this._processDataRefs(e),a.itemsAmount=e.length,e.length>0)for(var f=0;f<e.length;++f)d=Object.clone(a.definition),d.dataQuery=this._getDataQueryField(a.definition,e[f]),this._createRepeaterItem(d,a,c,b);else this._disposeOldRepeaters(),this._onRepeaterReady(a),this._stillLoading=!1,this._allRepeatersReady=!0,this._renderIfReady()}else a.state=this.repeaterStates.READY},_getDataQueryField:function(a,b){return a.repeaterDataQueryField?b.get(a.repeaterDataQueryField):b},_onLoadRepeaterReady:function(a,b,c){var d=!b,e=a.getViewNode(),f=c.pendingItems.indexOf(e),g=a.getDataItem();c.pendingItems.splice(f,1),c.readyItems.push(e),c.readyItemsLogic.push(a),c.definition.hideHidden&&g.getMeta("isHidden")&&e.collapse(),this._onRepeaterItemReady(c,a,g,d),c.readyItems.length==c.itemsAmount&&(c.state=this.repeaterStates.READY,this._checkIfRepeatersReady()&&(this._disposeOldRepeaters(),this._onRepeaterReady(c),this._stillLoading=!1,this._allRepeatersReady=!0,this._renderIfReady()))},_disposeOldRepeaters:function(){var a=[];this._elementPool.forEach(function(b){this._usedElementPool.contains(b)?a.push(b):b.getLogic().dispose()}.bind(this)),this._elementPool=a},_processDataRefs:function(a){return a},_createRepeaterItem:function(a,b,c,d){var e=this._getOldRepeaterItemMatchingDefinition(b.definition.id,a);if(e){c&&a.moveOldItemsToContainer!==!1&&e.insertInto(c),this._usedElementPool.push(e);var f,g,h=e.getLogic(),i=h.getSkin(),j=!1;if(a.styleGroup&&this._style&&(f="inherit"==a.styleGroup?this._style:this._style.getStyleByGroupName(a.styleGroup),g=i.getStyle(),j=f!==g),j){var k=function(){h.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,k),d(h,!0)};h.addEvent(Constants.ComponentEvents.READY_FOR_RENDER,k),i.applyStyle(f)}else d(h,!0)}else{var l=new Element("div");this._elementPool.push(l),this._usedElementPool.push(l),l.repeaterDefinition=a,b.pendingItems.push(l),c&&l.insertInto(c),this._createComponentbyDefinition(a,l,d)}},_getOldRepeaterItemMatchingDefinition:function(a,b){if(this._repeatersDataOld)for(var c=this._repeatersDataOld[a].readyItems,d=0;d<c.length;++d){var e=c[d].repeaterDefinition;if(e.skin==b.skin&&e.dataQuery===b.dataQuery)return c.splice(d,1)[0]}return null},_getRepeaterContainer:function(a){var b=a.definition.container;return b&&this._skinParts[b]?this._skinParts[b]:null},_getRepeaterDataList:function(a){if(a.dataRefList)return a.dataRefList;if(a.dataRefField){var b=[];return"*"==a.dataRefField||(b=this._data.get(a.dataRefField)),b}return a.inlineDataField?this._data.get(a.inlineDataField):void 0},dispose:function(){this._elementPool.forEach(function(a){a.getLogic().dispose()}),this._elementPool=[],this.parent()},_beforeRepeatersCreation:function(){},_onRepeaterItemReady:function(){},_onRepeaterReady:function(){}})}),define.component("core.components.Button",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.states(["up","over","selected","pressed"]),b.binds(["_onClick","_onOver","_onOut","_onMouseDown","_onMouseUp","render"]),b.dataTypes(["","Button"]),b.skinParts({icon:{type:"htmlElement",optional:"true"},label:{type:"htmlElement"}}),b.fields({_triggers:["click"],_canFocus:!0}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),c=c||{},this.setParameters({label:c.label||b.getAttribute("label"),toggleMode:c.toggleMode||!1,disabled:c.disabled||!1,iconSrc:c.iconSrc||"",command:c.command||null,commandParameter:c.commandParameter||null})},_onDataChange:function(a){a&&"Button"==a.getType()&&this.setParameters({label:a.get("label"),toggleMode:a.get("toggleMode"),disabled:a.get("disabled"),iconSrc:a.get("iconSrc"),command:a.get("command"),commandParameter:a.get("commandParameter")}),this.parent()},render:function(){this._setPreDefinedCommand(),this._skinParts.label.set("html",this._label||""),this._skinParts.icon&&(this._iconSrc?(this._skinParts.icon.setStyle("background","url("+this._iconSrc+") no-repeat 50% 50%"),this._skinParts.icon.uncollapse()):(this._skinParts.icon.setStyle("background",""),this._skinParts.icon.collapse()))},_setPreDefinedCommand:function(){this._tmpCommand&&this.setCommand(this._tmpCommand,this._tmpCommandParameter),this._tmpCommand=null,this._tmpCommandParameter=null},_onEnabled:function(){var a=this._skinParts.view;a.addEvent(Constants.CoreEvents.CLICK,this._onClick),a.addEvent(Constants.CoreEvents.MOUSE_OVER,this._onOver),a.addEvent(Constants.CoreEvents.MOUSE_OUT,this._onOut),a.addEvent(Constants.CoreEvents.MOUSE_DOWN,this._onMouseDown),a.addEvent(Constants.CoreEvents.MOUSE_UP,this._onMouseUp)},_onDisabled:function(){var a=this._skinParts.view;a.removeEvent(Constants.CoreEvents.CLICK,this._onClick),a.removeEvent(Constants.CoreEvents.MOUSE_OVER,this._onOver),a.removeEvent(Constants.CoreEvents.MOUSE_OUT,this._onOut),a.removeEvent(Constants.CoreEvents.MOUSE_DOWN,this._onMouseDown),a.removeEvent(Constants.CoreEvents.MOUSE_UP,this._onMouseUp)},setLabel:function(a){this._label=a,this._renderIfReady()},setIcon:function(a){this._iconSrc=a,this._renderIfReady()},setTextContent:function(a){this.setLabel(a)},setToggleMode:function(a){this._toggleMode=a},setDisabled:function(a){this._disabled=!!a,this._renderIfReady()},setParameters:function(a){a=a||{},this._label=a.label||this._label,this._toggleMode=a.toggleMode||this._toggleMode,this._disabled=a.disabled||this._disabled,this._iconSrc=a.iconSrc||this._iconSrc,this._tmpCommand=a.command||this._tmpCommand,this._tmpCommandParameter=a.commandParameter||this._tmpCommandParameter,this._renderIfReady()},getLabel:function(){return this._label},toggleSelected:function(a){var b=!1;"undefined"!=typeof a?b=a:this.getState().contains("selected")||(b=!0),b?this.setState("selected"):this.removeState("selected")},_onClick:function(a){if(this.isEnabled()&&(this._command||(a=a||{},a.target=this.getViewNode(),this.fireEvent(Constants.CoreEvents.CLICK,a)),this._toggleMode)){var b=this.getState().contains("selected")?"over":"selected";this.setState(b)}},_onOver:function(a){this.isEnabled()&&!this.getState().contains("selected")&&(this.fireEvent("over",a),this.setState("over"))},_onOut:function(a){this.isEnabled()&&!this.getState().contains("selected")&&(this.fireEvent("up",a),this.setState("up"))},_onMouseDown:function(){this.isEnabled()&&!this.getState().contains("selected")&&this.setState("pressed")},_onMouseUp:function(){this.removeState("pressed")}})}),define.component("core.components.Container",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.skinParts({inlineContent:{type:"htmlElement"}}),b.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0}},Z_INDEX_CHANGE_TYPES:{BACK:"BACK",FORWARD:"FORWARD",TOP:"TOP",BOTTOM:"BOTTOM"},_allowDragChildren:!0}),b.methods({initialize:function(a,b,c){c&&null!=c.allowDragChildren&&(this._allowDragChildren=c.allowDragChildren),this.parent(a,b,c),this.setMaxH(8e3)},getInlineContentContainer:function(){return this._skinParts.inlineContent?this._skinParts.inlineContent:this._view},getChildren:function(){return this.getInlineContentContainer().getChildren()},addChild:function(a){var b=a.getParentComponent(),c=b.getChildComponents().map(function(a){return a.getLogic().getComponentId()});a.getViewNode().insertInto(this.getInlineContentContainer()),this._reportComponentsZOrderChanged(a,b,c),this.moveChild(a,this.Z_INDEX_CHANGE_TYPES.TOP)},moveChildFromIndexToIndex:function(a,b,c){var d=this.getChildComponents().map(function(a){return a.getLogic().getComponentId()});W.Utils.setChildIndex(this.getInlineContentContainer(),b,c),this._reportComponentsZOrderChanged(a,this,d)},_reportComponentsZOrderChanged:function(a,b,c){var d=b.getChildComponents().map(function(a){return a.getLogic().getComponentId()}),e={subType:"explicitZOrderChange",changedComponentIds:[a.getComponentId()],oldState:{children:c},newState:{children:d}};this.injects().Commands.executeCommand("WViewerCommands.ComponentZIndexChanged",{editedComponent:a,urmData:e})},removeChild:function(a){var b=a.getViewNode?a.getViewNode():a;this.getInlineContentContainer().removeChild(b)},canMoveForward:function(a){var b=this.getChildren(),c=b.indexOf(a.getViewNode());return-1==c?!1:c<b.length-1},canMoveBack:function(a){var b=this.getChildren().indexOf(a.getViewNode());return-1==b?!1:b>0},moveChild:function(a,b){var c,d=this.getChildren(),e=this._getChildIndex(a);switch(b){case this.Z_INDEX_CHANGE_TYPES.BACK:c=e-1;break;case this.Z_INDEX_CHANGE_TYPES.FORWARD:c=e+1;break;case this.Z_INDEX_CHANGE_TYPES.BOTTOM:c=0;break;case this.Z_INDEX_CHANGE_TYPES.TOP:c=d.length-1}this.moveChildFromIndexToIndex(a,e,c)},_getChildIndex:function(a){var b=this.getChildren(),c=a.getViewNode();return b.indexOf(c)},hasChildren:function(){return!0},isContainer:function(){return this._allowDragChildren},getChildComponents:function(){return this.getInlineContentContainer().getChildren("[comp]")},getContainerComponents:function(a){for(var b=this.getChildComponents(),c=0;c<b.length;c++){var d=b[c].getLogic();a.push(d),d.isInstanceOfClass("core.components.Container")&&a.concat(d.getContainerComponents(a))}return a},getDescendantComponents:function(){return this.getDescendantComponentsRecurse(this,[])},getDescendantComponentsRecurse:function(a,b){for(var c=a.getChildComponents(),d=0;d<c.length;d++)b.push(c[d]),c[d].getLogic&&c[d].getLogic().getChildComponents&&this.getDescendantComponentsRecurse(c[d].getLogic(),b);return b},disposeChildren:function(){for(var a=this.getChildren(),b=0;b<a.length;b++)a[b].getLogic&&a[b].getLogic().dispose()},dispose:function(){this.disposeChildren(),this.parent()}})}),define.component("core.components.Image",function(a){var b=a;b.utilize(["core.components.image.ImageDimensions","core.components.image.ImageUrl"]),b.inherits("mobile.core.components.base.BaseComponent"),b.states(["loading","loaded"]),b.binds(["_onImageLoaded","_onOrientationChange"]),b.dataTypes(["Image",""]),b.statics({unitOptions:{EM:"em",PX:"px",PERCENT:"%"}}),b.skinParts({image:{type:"htmlElement"}}),b.fields({_renderTriggers:[Constants.DisplayEvents.DISPLAY_CHANGED],_invalidProps:{}}),b.methods({initialize:function(a,b,c){this._initGlobalResources(),this.parent(a,b,c),this.lockRefresh(),this._imageDimensions=new this.imports.ImageDimensions,this._imageUrl=new this.imports.ImageUrl,this._setParametersToDefaults(),this._initializeParametersFromArgs(c),this._requestExactSize=this._globals.viewer&&this._globals.viewer.getPreviewMode()!==!0,this._globals.viewer&&this._globals.viewer.addOrientationEvent(this._onOrientationChange)},_initGlobalResources:function(){this._globals={};var a=this.injects();this._globals.viewer=a.Viewer,this._globals.utils=a.Utils},_setParametersToDefaults:function(){this._sizeOfComponentInPx={x:0,y:0},this._units={x:this.unitOptions.PERCENT,y:this.unitOptions.PERCENT},this._sizeOfComponentInUnits={x:100,y:100},this._uri=""},_initializeParametersFromArgs:function(a){a=a||{},this.setCropMode(a.cropMode),this.setAlign(a.align,a.valign),this._passedUnit=this._isValueInObject(this.unitOptions,a.unit)?a.unit:null,this.setSize(a.width,a.height),this._renderDelay=a.renderDelay||1,this._useWebUrl=a.useWebUrl||!1},_onOrientationChange:function(){setTimeout(this.refresh.bind(this,!0),50)},render:function(){this.unLockRefresh(),0===this._renderDelay?this.refresh(!0):this._globals.utils.callLater(this.refresh,[!0],this,this._renderDelay)},_needsRender:function(){var a=this._data&&this._data.get("uri")&&this._uri!==this._data.get("uri"),b=this._getComponentSizeInPx();return a||this._sizeOfComponentInPx.x!=b.x||this._sizeOfComponentInPx.y!=b.y||this._isPropInvalid("size")||this._isPropInvalid("cropMode")},_onAllSkinPartsReady:function(){this._skinParts.image.setStyle("position","absolute"),this._skinParts.view.setStyles({position:"relative",overflow:"hidden"})},lockRefresh:function(){this._isLock=!0},unLockRefresh:function(){this._isLock=!1},refresh:function(a){(a||this._needsRender())&&(0===this._renderDelay?this._onRefresh(a):this._globals.utils.callLater(this._onRefresh,[a],this,this._renderDelay))},_setNewImage:function(a,b){(!a.isSameImage||a.isSameImageWithBiggerPyramidSize)&&this.setState("loading"),this._skinParts.image.addEvent("load",this._onImageLoaded),this._skinParts.image.removeEvents("error"),this._skinParts.image.addEvent("error",this._onImageError.bind(this,b)),this._skinParts.image.set("src",b)},_onRefresh:function(a){if((!this._isLock||a)&&this._data){this._skinParts.image.set("alt",this._data.get("alt"));var b=this._getImageDimensionsAndSetCompSize(a),c=this._validateImageDimensions(b);if(c){var d={isSameImage:null,isSameImageWithBiggerPyramidSize:null},e=this._getImageFullUrl(b.imageRequestSize,d);this.fireEvent("loading",{url:e,imgWidth:b.imageObjectSize.x,imgHeight:b.imageObjectSize.y,requestSize:this._pyramidRequestSize,imgX:b.imagePosition.x,imgY:b.imagePosition.y}),this._skinParts.image.setStyles({width:b.imageObjectSize.x+"px",height:b.imageObjectSize.y+"px",top:b.imagePosition.y+"px",left:b.imagePosition.x+"px"}),e!=this._skinParts.image.get("src")?this._setNewImage(d,e):this._moveImageToBackground()}else this._globals.utils.callLater(this._renderIfReady,[],this,50);this._validate()}},_validateImageDimensions:function(a){if(!a||!a.imageRequestSize)return!1;var b=a.imageRequestSize,c=0===b.x||0===b.y;return c?this._isLastImageRequestZero=!0:(this._isLastImageRequestZero&&LOG.reportError(wixErrors.IMG_VALID_SIZE_AFTER_ZERO,this.$className,"_validateImageDimensions",this._data.get("uri")),this._isLastImageRequestZero=!1),!c},_getImageDimensionsAndSetCompSize:function(a){var b=null,c=parseInt(this._data.get("width"),10),d=parseInt(this._data.get("height"),10);if(c||d||(c=d=128),a||this._isPropInvalid("size")){var e=this._getComponentSizeInUnits();this._skinParts.view.setStyles({width:e.x,height:e.y})}return(a||this._isPropInvalid("size")||this._isPropInvalid("cropMode"))&&(this._sizeOfComponentInPx=this._getComponentSizeInPx(),b=this._imageDimensions.getDimensionsForContainerSize({x:c,y:d},this._sizeOfComponentInPx)),b},_getImageFullUrl:function(a,b){var c=this._uri;this._uri=this._data.get("uri"),b.isSameImage=c===this._uri;var d=this._uri,e=this._uri.test(/(^https?)|(^data)/);if(this._useWebUrl||e)d=d;else if(this._isGIF())d=this._imageUrl.getImageUrlExactSize(this._getOriginalSizeFromData(),this._uri);else if(this._requestExactSize)d=this._imageUrl.getImageUrlExactSize(a,this._uri);else{var f=this._imageUrl.getImageUrlFromPyramid(a,this._uri,b.isSameImage,this._pyramidRequestSize);d=f.url,b.isSameImageWithBiggerPyramidSize=b.isSameImage&&f.pyramidRequestSize>this._pyramidRequestSize,this._pyramidRequestSize=f.pyramidRequestSize}return d},_getOriginalSizeFromData:function(){return{x:this._data.get("width"),y:this._data.get("height")}},_isGIF:function(){return this._data.get("uri").test(/(\.gif$)/)},_onImageLoaded:function(){var a=window.Browser.ie7?7e3:1;this._globals.utils.callLater(this._validateResultImageSize,[],this,a),this.setState("loaded"),this._moveImageToBackground(),this._renderIfReady()},_validateResultImageSize:function(){this._renderIfReady()},_moveImageToBackground:function(){var a=this._skinParts.image;if(0!==this._sizeOfComponentInPx.x&&0!==this._sizeOfComponentInPx.y&&Modernizr.backgroundsize){var b=this._globals.utils.getCSSBrowserFeature("backgroundSize"),c={};c["background-image"]="url('"+a.get("src")+"')",c[b]=a.getStyle("width")+" "+a.getStyle("height"),c["background-position"]=parseInt(a.getStyle("left"),10)+"px "+parseInt(a.getStyle("top"),10)+"px",c["background-repeat"]="no-repeat",this._skinParts.view.setStyles(c),a.setStyles({visibility:"hidden"})}},_onImageError:function(a){LOG.reportError(wixErrors.IMAGE_LOAD_ERROR,"Image","refresh",a),this._renderIfReady()},_getComponentSizeInUnits:function(){return{x:this._sizeOfComponentInUnits.x+this._units.x,y:this._sizeOfComponentInUnits.y+this._units.y}},_getComponentSizeInPx:function(){return null!==this._skinParts?this._units.x!==this.unitOptions.PX||this._units.y!==this.unitOptions.PX?this._skinParts.view.getSize():{x:Number(this._sizeOfComponentInUnits.x),y:Number(this._sizeOfComponentInUnits.y)}:void 0},_invalidate:function(a){switch(typeOf(a)){case"string":this._invalidProps[a]="invalid";break;case"array":for(var b=0;b<a.length;++b)this._invalidProps[a[b]]="invalid"}},_validate:function(a){switch(typeOf(a)){case"string":delete this._invalidProps[a];break;case"array":for(var b=0;b<a.length;++b)delete this._invalidProps[a[b]];break;default:this._invalidProps={}}},_isPropInvalid:function(a){return Boolean(this._invalidProps[a])},setCropMode:function(a){this._imageDimensions.setCropMode(a)&&(this._invalidate("cropMode"),this._renderIfReady())},setAlign:function(a,b){var c=!1;this._imageDimensions.setHorizontalAlign(a)&&(c=!0),this._imageDimensions.setVerticalAlign(b)&&(c=!0),c&&(this._invalidate("align"),this._renderIfReady())},setSize:function(a,b,c){var d=!1;this._passedUnit=c||this._passedUnit,a&&(d=this._passedUnit&&this._passedUnit!==this._units.x||this._sizeOfComponentInUnits.x!==parseInt(a,10),this._units.x=this._passedUnit||this._units.x,this._sizeOfComponentInUnits.x=parseInt(a,10)),b&&(d=d||this._passedUnit&&this._passedUnit!==this._units.y||this._sizeOfComponentInUnits.y!==parseInt(b,10),this._units.y=this._passedUnit||this._units.y,this._sizeOfComponentInUnits.y=parseInt(b,10)),d&&(this._invalidate("size"),this._renderIfReady())},_isValueInObject:function(a,b){for(var c in a)if(a[c]===b)return!0;return!1}})}),define.component("core.components.MenuButton",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.skinParts({label:{type:"htmlElement"},icon:{type:"htmlElement",optional:!0},description:{type:"htmlElement",optional:!0},bullet:{type:"htmlElement",optional:!0}}),b.binds(["_buttonClick","_onMouseOver","_onMouseOut","_setImages","_onThemePropChange"]),b.states(["selected","idle","up","over","down","disable"]),b.dataTypes(["Link","Page","","AppPage","Text"]),b.fields({_renderTriggers:[Constants.DisplayEvents.DISPLAY_CHANGED],_selected:!1,_dropdownOpen:!1,_menu:null,_transitionValue:null,dropdownMode:!1,children:[]}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._listSubType="NONE",c&&c.listSubType&&this.setListSubtype(c.listSubType),this.injects().Theme.addEvent("propertyChange",this._onThemePropChange)},createSubButton:function(a,b,c){var d=this;a(b,null,function(a){d.children.push(a),c(a)})},setMenu:function(a){this._menu=a},getMinimalWidth:function(){return Math.max(this.getOffsetWidth(),this._skinParts.label.offsetWidth)},fillWidthByPadding:function(a){this.setPadding(0);var b=a-this.getOffsetWidth();this.setPadding(b)},getPads:function(){return{left:parseInt(this._skinParts.bg.getStyle("padding-left"),10),right:parseInt(this._skinParts.bg.getStyle("padding-right"),10)}},disableTransition:function(){this._transitionValue=this.getViewNode().getStyle("-webkit-transition-duration"),this.getViewNode().setStyle("-webkit-transition-duration","0s")},enableTransition:function(){null!=this._transitionValue&&this.getViewNode().setStyle("-webkit-transition-duration",this._transitionValue)},setPadding:function(a){0>+a&&(a=0);var b,c=a/2;switch(0===c-Math.floor(c)?b=c:(c=Math.floor(c),b=c+1),this._menu.getComponentProperty("alignText")){case"center":this._skinParts.bg.setStyle("padding-left",c+"px"),this._skinParts.bg.setStyle("padding-right",b+"px");break;case"right":this._skinParts.bg.setStyle("padding-left",a+"px"),this._skinParts.bg.setStyle("padding-right","0px");break;case"left":this._skinParts.bg.setStyle("padding-left","0px"),this._skinParts.bg.setStyle("padding-right",a+"px")}},getMinimalDropdownWidth:function(){var a=0,b=this.getViewNode().getElements(".dropSizeTarget");return b&&b.length>0?b.forEach(function(b){a+=b.offsetWidth}):a=this.getViewNode().offsetWidth,a},isHidden:function(){var a=!1;return 1==this._data.get("hidePage")&&(a=!0),a},compareRefID:function(a){return this._data?this._data.get("id")===a.substr(1):!1},alignText:function(){var a=this.getPads();this.setPadding(a.left+a.right)},getOffsetWidth:function(){return this.getViewNode().offsetWidth},getOffsetLeft:function(){return this.getViewNode().offsetLeft},_onThemePropChange:function(a){this._setImages(a)},_onDataChange:function(a){return this._updateButtonView(),this.fireEvent("dataChanged"),this.parent(a)},render:function(){this._updateButtonView()},setSelected:function(a){this._selected=a,this._selected?this.setState("selected"):(this.removeState("selected"),this._dropdownOpen&&this.setState("over"))},setDropdownOpen:function(a){this._dropdownOpen=a,this._selected||(this._dropdownOpen?this.setState("over"):this.removeState("over"))},_getButtonLabelTextField:function(){return"Page"==this._data.getType()?"title":"text"},_updateButtonView:function(){if(this._data&&this._skinParts){var a=this._getButtonLabelTextField(),b=this._data.get(a);this._skinParts.label.set("html",this._getNonEmptyText(b));var c=this._skinParts.description;if(c){var d=this._data.get("target");c.set("html",this._getNonEmptyText(d))}this._setImages()}},getID:function(){return this._data?this._data.get("id"):""},_getNonEmptyText:function(a){return a=a.trim().replace(/ /g,"&nbsp;"),a||"&nbsp;"},_onAllSkinPartsReady:function(a){this.injects().Theme.addEvent(Constants.ComponentEvents.PROPERTY_CHANGE,this._setImages);var b=a.hitArea||a.view;b.addEvent(Constants.CoreEvents.CLICK,this._buttonClick),b.addEvent("mouseenter",this._onMouseOver),b.addEvent("mouseleave",this._onMouseOut)},_setImages:function(a){var b,c=this._listSubType+"_DIRECTORY";if(!a||a.name==c){var d=this.injects().Theme.getProperty(c);if("Link"==this._data.getType())this._skinParts.icon.uncollapse(),b="PAGES"==this._listSubType?d+this._data.get("icon"):d+this.injects().LinkTypes.getLinkIcon(this._data.get("linkType")),this._skinParts.icon.set("src",b);else if(this._skinParts.icon){var e=this._data.get("icon");e?(b=d+this._data.get("icon"),this._skinParts.icon.set("src",b)):this._skinParts.icon.setStyle("display","none")}}},getWidthOnLayout:function(){return this.getViewNode().offsetWidth+parseInt(this.getViewNode().getStyle("margin-left"),10)+parseInt(this.getViewNode().getStyle("margin-right"),10)},setLabel:function(a){this._skinParts.label.set("html",this._getNonEmptyText(a))},setListSubtype:function(a){this._listSubType=a},_buttonClick:function(){this.fireEvent("click")},_onMouseOver:function(){this.dropdownMode&&(this._selected||this.setState("over")),this.fireEvent("over")},_onMouseOut:function(){this.dropdownMode&&(this._selected||this._dropdownOpen||this.removeState("over")),this.fireEvent("out")}})}),define.component("core.components.Page",function(a){var b=a;b.inherits("core.components.Container"),b.resources(["W.Layout","W.Viewer"]),b.binds(["_notifyPageComponentsOnPageVisibilityChange","_doNotification"]),b.statics({MAX_HEIGHT:6e4,MIN_HEIGHT:500}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._isContentWixified=!1,this._isContentWixifyStarted=!1,this._wixifyCBList=[],this._contentReady=!1,this.setMaxH(this.MAX_HEIGHT),this.setMinH(this.MIN_HEIGHT),b.collapse(),this.resources.W.Viewer.addEvent("pageTransitionEnded",this._notifyPageComponentsOnPageVisibilityChange),b.setStyle("position","absolute").setStyle("top","0px").setStyle("left","0px")},delayedDispose:function(a){this.disposeChildren(),this._view.setStyle("visibility","hidden");var b=this,c=function(){b.dispose(),a&&a()};setTimeout(c,500)},dispose:function(){this.resources.W.Viewer.removeEvent("pageTransitionEnded",this._notifyPageComponentsOnPageVisibilityChange),this.parent()},getPageComponents:function(){var a=[];return this.getContainerComponents(a)},listenForContentRendered:function(){for(var a=this._view.getElements("[comp]"),b=[],c=0;c<a.length;c++){var d=a[c];d.getLogic&&d.getLogic().isRendered()===!0||null===d.getParent("[comp^='wixapps.integration.components.AppPart']")&&b.push(d)}0===b.length?this._setContentRendered():new Async.Bulk(b,null,{completeEvent:Constants.ComponentEvents.RENDER,completeCallback:function(){this._setContentRendered()}.bind(this)})},getAcceptableDataTypes:function(){return["Page"]},wixifyContent:function(a){a&&this._wixifyCBList.push(a);var b=this._view.getAttribute("id");W.Pages.isPageLoaded(b)?this._oldWixifyContent():W.Pages.loadPageById(b,this._oldWixifyContent.bind(this),this)},_oldWixifyContent:function(){if(this._isContentWixified)return this._setWixified(),void 0;if(!this._isContentWixifyStarted){this._isContentWixifyStarted=!0;var a=this._view.getElements("[comp]");if(0===a.length)return this._setWixified(),this.listenForContentRendered(),void 0;new Async.Bulk(a,null,{completeEvent:"wixified",completeCallback:function(){this._setWixified()}.bind(this)}),this.listenForContentRendered(),a.wixify()}},render:function(){if(this.resources.W.Layout&&this.resources.W.Layout.getComponentMinResizeHeight){var a=this.resources.W.Layout.getComponentMinResizeHeight(this);this.setHeight(a)}},isContentWixify:function(){return this._isContentWixified},_setWixified:function(){this._isContentWixified||(this._view.getElements(".initHidden").removeClass("initHidden"),this._view.removeClass("initHidden"),this._isContentWixified=!0),this.fireEvent("contentWixified",this);
for(var a=0;a<this._wixifyCBList.length;++a)this._wixifyCBList[a]();this._wixifyCBList=[],this.resources.W.Layout&&this.resources.W.Layout.attachSavedAnchors(this._view)},_setContentRendered:function(){this._contentReady=!0,this._findAndEnforceInvalidatedAnchors(this),this.render(),this.fireEvent("pageContentReady",this)},_findAndEnforceInvalidatedAnchors:function(a){if(a.getChildComponents){for(var b=a.getChildComponents(),c=[],d=0;d<b.length;d++)this._findAndEnforceInvalidatedAnchors(b[d].getLogic()),b[d].getLogic().isAnchorsInvalidated&&b[d].getLogic().isAnchorsInvalidated()&&c.push(b[d].getLogic());this.resources.W.Layout&&this.resources.W.Layout.enforceAnchors&&this.resources.W.Layout.enforceAnchors(c)}},setAsWixified:function(){this._setWixified()},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.NEVER},from:!1}},isSelectable:function(){return!1},isContentReady:function(){return this._contentReady},getInlineContentContainer:function(){return this._skinParts.inlineContent?this._skinParts.inlineContent:this._view},getThirdPartyApplicationComponent:function(){var a=this._view.getElement("[comp*='TPASection']");return a.getLogic()},isThirdPartyApplicationPage:function(){return this._data.get("tpaApplicationId")?!0:void 0},_doNotification:function(){var a=$$("#"+this._newPageId)[0].getLogic(),b=this.getPageComponents(),c=!1;this._compId==this._newPageId&&(c=!0),b.forEach(function(b){b.onPageVisibilityChange(c,a)})},_notifyPageComponentsOnPageVisibilityChange:function(a){var b=$$("#"+a)[0];b&&b.getLogic&&(this._newPageId=a,this._isContentWixified?this._doNotification():this.addEvent("contentWixified",this._doNotification))}})}),define.component("core.components.ServiceItem",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.utilize([]),b.resources([]),b.binds(["_toggleOpen","_onImageReady"]),b.traits([]),b.skinParts({icon:{type:"htmlElement"},label:{type:"htmlElement"},readMore:{type:"htmlElement"},description:{type:"htmlElement"}}),b.dataTypes([]),b.states(["uncut","cutClosed","cutOpened"]),b.propertiesSchemaType(""),b.statics({}),b.fields({}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._opened=!1,this._uncut=!0,this.imageDataQuery=void 0},render:function(){this._skinParts.label.set("html",this._data.get("title"));var a=this._data.get("description");a=a.replace(/\n/g,"<br/>"),this._skinParts.description.set("html",a);var b=$(this._skinParts.description).getElements("a");this._sanitizeLinks(b),this._disableLinks(b),this._skinParts.readMore.set("html","Read More"),this._testOpenState(),this._view.addEvent("click",this._toggleOpen);var c=this._data.get("image");c!=this.imageDataQuery&&(this._imageSkinContainer=this.injects().Components.createComponent("core.components.Image","mobile.core.skins.ImageSkin",c,{width:6,height:6,unit:"em",align:"center",valign:"top",cropMode:"fill"},this._onImageReady),this._skinParts.icon.empty(),this._imageSkinContainer.insertInto(this._skinParts.icon),this.imageDataQuery=c)},_testOpenState:function(){var a=this._skinParts.allText.getSize(),b=parseInt(this.injects().Utils.getComputedStyle(this._skinParts.description).fontSize,10);a.y>6.5*b?(this._opened=!this._opened,this._uncut=!1,this._toggleOpen()):(this._uncut=!0,this.setState("uncut"))},_toggleOpen:function(){this._uncut||W.Viewer.isScrollLock()||(this._opened?(this._skinParts.readMore.set("html","Read More"),this.setState("cutClosed")):(this._skinParts.readMore.set("html","Close"),this.setState("cutOpened")),this.fireEvent("autoSizedAnimation"),this._opened=!this._opened)},_onAutoSizedAnimtion:function(){},_onImageReady:function(a){a._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onImageDataChange.bind(this,a._data)),this._onImageDataChange(a._data)},_onImageDataChange:function(a){a.getMeta("isHidden")?(this._skinParts.icon.collapse(),this._skinParts.view.removeClass("showImage"),this._skinParts.view.addClass("hideImage")):(this._skinParts.icon.uncollapse(),this._skinParts.view.addClass("showImage"),this._skinParts.view.removeClass("hideImage"))},getAcceptableDataTypes:function(){return["Service"]}})}),define.component("core.components.SimpleBaseList",function(a){var b=a;b.inherits("core.components.BaseList"),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._allItemsLoaded=!1,this._isLoadingItems=!1},getAcceptableDataTypes:function(){return["PropertyList"]},getItemsContainer:function(){return this._skinParts.itemsContainer||this._view},_prepareForRender:function(){if(this._allItemsLoaded)return!0;if(this._isLoadingItems)return!1;this._isLoadingItems=!0;var a=this._getItemsData();return this._renderItems(a),this._allItemsLoaded},_onDataChange:function(){this._allItemsLoaded=!1,this._isLoadingItems=!1,this.parent()},_getItemsData:function(){return this._data?this._data.get("items"):void 0},_onAllItemsReady:function(){this._isLoadingItems=!1,this._allItemsLoaded=!0,this._renderIfReady()}})}),define.component("core.components.SimpleButton",function(a){var b=a;b.utilize(["mobile.core.components.base.BaseComponent"]),b.binds(["_buttonClick"]),b.skinParts({label:{type:"htmlElement"},hitArea:{type:"htmlElement"}}),b.states(["up","over","down","disable"]),b.methods({render:function(){var a="Page"==this._data.getType()?"title":"text";this._skinParts.label.set("html",this._data.get(a))},_onAllSkinPartsReady:function(a){a.hitArea.addEvent("click",this._buttonClick)},_buttonClick:function(){this.fireEvent("click")},getAcceptableDataTypes:function(){return["Button","Link","Page"]}})}),function(){var a="BG_USES_CUSTOM_IMAGE",b="BG_USES_THEME_IMAGE";define.component("mobile.core.components.SiteStructure",function(c){var d=c;d.inherits("core.components.Container"),d.binds(["changeBGImage"]),d.fields({_bgSizes:[{w:204,h:309},{w:320,h:452},{w:320,h:646},{w:320,h:800},{w:400,h:591},{w:480,h:480},{w:533,h:239},{w:683,h:334},{w:768,h:896},{w:1024,h:640}]}),d.methods({initialize:function(a,b,c){this.parent(a,b,c),window.onorientationchange&&window.addEvent("orientationchange",this.changeBGImage),window.addEvent("resize",this.changeBGImage),W.Theme.addEvent("propertyChange",this.changeBGImage),this.changeBGImage({type:"init"})},render:function(){this.sitePagesNode=this._view.getElement("#SITE_PAGES"),this.sitePagesNode||LOG.reportError(wixErrors.SITE_STRUCTURE_NO_SITE_PAGES,"core.components.SiteStructure","render");var a=this.injects().Theme.getProperty("padding1");a=a.split(" ");var b="0";switch(a.length){case 1:b="0 "+a[0];break;case 2:case 3:b="0 "+a[1];break;case 4:b="0 "+a[1]+" 0 "+a[3]}this.sitePagesNode.setStyle("margin",b)},_getReformattedBgColor:function(){var a=this.injects().Theme.getProperty("bgSize").split(",");return{width:a[0],height:a[1]}},changeBGImage:function(){var c,d=this.injects().Utils.getWindowSize(),e=this._getBestFit(d,this._bgSizes),f=this.injects().Theme.getProperty("bgType");switch(f){case b:c=this.injects().Theme.getProperty("BG_DIRECTORY")+"bg_"+e.w+"x"+e.h+".jpg",$(document.body).setStyle("background",'url("'+c+'") repeat');break;case a:var g=this.injects().Config.getServiceTopologyProperty("staticMediaUrl")+"/",h=this.injects().Theme.getProperty("bgId"),i=this._getReformattedBgColor(),j=i.width,k=i.height;if(j>100){j=e.w;var l=i.width/i.height;k=Math.round(j/l)}var m=g+h+"_crp_0"+"_0"+"_"+i.width+"_"+i.height+"_"+j+"_"+k+"_crp";$(document.body).setStyle("background",'url("'+m+'") repeat');break;default:$(document.body).setStyle("background","")}c=this.injects().Theme.getProperty("siteBgColor"),$(document.body).setStyle("background-color",c.getHex(!1))},_getWantedBgSize:function(){var a,b,c,d=this._getReformattedBgColor(),e=d.width,f=d.height,g=this._view.clientWidth,h=this._view.clientHeight,i=f/e,j=h/g;j>i?(b=h,a=b/i):(a=g,b=a*i);for(var k=a>b?b:a,l=0;l<this._bgSizes.length;l++)if(this._bgSizes[l]>=k){c=this._bgSizes[l];break}return c},_getBestFit:function(a,b){for(var c=b[0],d=1;d<b.length;++d){var e=b[d],f=e.w-a.width,g=c.w-a.width;f>=0?c=0>g?b[d]:g>f?b[d]:c:0>g&&(c=f>g?b[d]:c)}return c}})})}(),define.component("core.components.TwitterFollow",function(a){var b=a;b.utilize(["mobile.core.components.base.BaseComponent"]),b.skinParts({twitter:{type:"htmlElement"}}),b.fields({propertiesSchema:{showCount:{type:"string","enum":["true","false"],"default":"true",description:"Followers count display"},button:{type:"string","enum":["blue","gray"],"default":"blue",description:"Button color"},textColor:{type:"string","default":"",description:"HEX color code for the text color"},linkColor:{type:"string","default":"",description:"HEX color code for the Username link color"},width:{type:"string","default":"",description:"width of the Follow Button"},align:{type:"string","default":"",description:"alignment of the Follow Button"},dataLang:{type:"string","enum":["en","fr","de","it","es","ko","ja"],"default":"en",description:"The language for the Tweet Button"}}}),b.methods({initialize:function(a,b){this.parent(a,b)},render:function(){this._runTwitterScript(),this._rebuildTwitterElement()},_onComponentPropertyChange:function(){this._rebuildTwitterElement()},_rebuildTwitterElement:function(){this._skinParts.twitter.empty();var a=this._data.get("accountToFollow").replace("@","");a||(a="wix");var b={"class":"twitter-follow-button",href:"https://twitter.com/"+a,"data-show-count":this.getComponentProperty("showCount"),"data-button":this.getComponentProperty("button"),"data-text-color":this.getComponentProperty("textColor"),"data-link-color":this.getComponentProperty("linkColor"),"data-lang":this.getComponentProperty("dataLang"),"data-width":this.getComponentProperty("width"),"data-align":this.getComponentProperty("align")},c=new Element("a",b);this._skinParts.twitter.adopt(c),void 0!==window.twttr&&twttr.widgets.load()},getAcceptableDataTypes:function(){return["TwitterFollow"]},_runTwitterScript:function(){this.injects().Viewer.loadExternalScript("//platform.twitter.com/widgets.js")}})}),define.component("core.components.base.BaseComp",function(a){var b=a;b.inherits("bootstrap.managers.events.EventDispatcher"),b.utilize(["core.managers.component.ComponentDefinition"]),b.traits(["core.components.base.traits.BaseCompInvalidation","core.components.base.traits.BaseCompSkinHandler","core.components.base.traits.BaseCompChildCompHandler","core.components.base.traits.BaseCompStates","core.components.base.traits.BaseCompDataHandler","core.components.base.traits.BaseCompProperties","core.components.base.traits.BaseCompLayout","core.components.base.traits.OldBaseCompIntegration","core.components.base.traits.OldBaseCompLayoutIntegration","core.components.base.traits.OldBaseCompEditorPropIntegration"]),b.resources(["W.ComponentLifecycle"]),b.skinParts({}),b.dataTypes([""]),b.states({}),b.statics({NEW_BASE_COMP:!0,INVALIDATIONS:{SKIN_CHANGE:"skinChange",DATA_CHANGE:"dataChange",DISPLAY:"display",WIDTH_REQUEST:"widthRequest",HEIGHT_REQUEST:"heightRequest",X_REQUEST:"xRequest",Y_REQUEST:"yRequest",SIZE:"sizeChanged",POSITION:"positionChanged",PART_SIZE:"partSize",PART_POSITION:"partPosition",STYLE_PARAM_CHANGE:"styleParamChange"}}),b.methods({initialize:function(a,b){this._compId=a,this.$view=b,this.on(Constants.LifecycleSteps.RENDER,this,this._onRender)},getComponentId:function(){return this._compId},isRenderNeeded:function(a){var b=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.WIDTH_REQUEST,this.INVALIDATIONS.HEIGHT_REQUEST];return a.isInvalidated(b)},_onRender:function(){},isDisplayed:function(){var a=this.resources.W.ComponentLifecycle.getComponentInfo(this);return a.isDisplayed},getComponentStatus:function(){var a=this.resources.W.ComponentLifecycle.getComponentInfo(this);return a.state},exterminate:function(){return this._isExterminated?LOG.reportError(wixErrors.COMPONENT_ALREADY_DISPOSED,this.$className,"exterminate",this.getComponentId()):(this._isExterminated=!0,this.parent(),void 0)}})}),define.Class("core.components.base.BaseLayoutEngine",function(a){var b=a;b.methods({initialize:function(a){this._viewNode=a},updateLayoutFromViewNode:function(){},setSize:function(){},setPosition:function(){},getSize:function(){},getPosition:function(){}})}),define.Const("ComponentEvents",{DISPLAYED:"displayed",READY:"componentReady",WIXIFIED:"wixified",PROPERTY_CHANGE:"componentPropertyChange",READY_FOR_RENDER:"readyForRender",RENDER:"render",COMPONENT_SEQUENCER_COMP_SETUP:"componentSetup",COMPONENT_SEQUENCER_PRODUCTION_FINISHED:"productionFinished"}),define.Const("ComponentPartTypes",{HTML_ELEMENT:"htmlElement"}),define.Class("core.components.base.InvalidationCollector",function(a){var b=a;b.methods({initialize:function(){this._invalidations={}},invalidate:function(a,b){if(a){var c=this._invalidations[a]||[];c.push(b),this._invalidations[a]=c}},clearInvalidationType:function(a){delete this._invalidations[a]},isInvalidated:function(a){for(var b=0;b<a.length;++b)if(type=a[b],void 0!==this._invalidations[type])return!0;return!1},getInvalidationByType:function(a){return this._invalidations[a]},getLastInvalidationByType:function(a){var b=this._invalidations[a];return b?b[b.length-1]:null}})}),define.Class("core.components.base.SizeLimits",function(a){var b=a;b.methods({initialize:function(){this.minW=null,this.minH=null,this.maxW=null,this.maxH=null},clone:function(){var a=new this.$class;return a.minW=this.minW,a.minH=this.minH,a.maxW=this.maxW,a.maxH=this.maxH,a}})}),define.Const("BaseComponent",{ResizeSides:{TOP:"RESIZE_TOP",LEFT:"RESIZE_LEFT",BOTTOM:"RESIZE_BOTTOM",RIGHT:"RESIZE_RIGHT"},MoveDirections:{HORIZONTAL:"HORIZONTAL_MOVE",VERTICAL:"VERTICAL_MOVE"},AnchorLock:{NEVER:"never",BY_THRESHOLD:"threshold",ALWAYS:"always"}}),define.Class("core.components.base.traits.BaseCompChildCompHandler",function(a){var b=a;b.utilize(["core.managers.components.ComponentBuilder"]),b.resources(["W.ComponentLifecycle","W.Data"]),b.binds(["_onChildComponentReady"]),b.fields({SKIN_PART_ATTR_NAME:"skinPart",STYLE_ATTR_NAME:"styleId"}),b.methods({_createInnerComponent:function(a,b,c){b=b||new Element("div"),b.setProperty(this.SKIN_PART_ATTR_NAME,a.id);var d=this._getInnerComponentStyle(a);!d&&a.styleId&&b.setProperty(this.STYLE_ATTR_NAME,a.styleId);var e=a.argObject||{},f=this._getInnerComponentData(a),g=a.skin,h=a.type,i=new this.imports.ComponentBuilder(b);return i.withType(h).withSkin(g).withData(f).withArgs(e).withSkinParamMapper(d).onCreated(this._onChildComponentReady).create(),c&&!b.$logic,b.$logic},_onChildComponentReady:function(a){console.log("created "+a),this.resources.W.ComponentLifecycle.setParentComponentProcess(a,this)},_getInnerComponentData:function(a){var b;if(a.dataQuery)b=a.dataQuery;else if(a.dataRefField){var c=a.dataRefField;b="*"==c?this._data:this._data.get(c)}else if(a.dataType){var d=this._data?this._data.getDataManager():this.resources.W.Data;b=d.addDataItemWithUniqueId("",{type:a.dataType}).dataObject,b.setMeta("isPersistent",!1)}return b},_getInnerComponentStyle:function(a){var b,c=this._skin&&this._skin.getParamMapper();return a.styleGroup&&c&&(b="inherit"==a.styleGroup?c:c.getStyleByGroupName(a.styleGroup)),b}})}),define.Class("core.components.base.traits.BaseCompDataHandler",function(a){var b=a;b.binds(["_onDataChange"]),b.statics({_definitionFieldName_:"_dataTypes_",_fieldName_:"dataTypes",_aggregateSchema_:function(a,b,c){if((!a||a&&"array"!==typeOf(a))&&(a=[""]),b&&"array"===typeOf(b)&&(a=a.combine(b)),"array"===typeOf(c)){for(var d=[],e=0;e<a.length;++e)-1===c.indexOf(a[e])&&d.push(a[e]);a=d}return a}}),b.methods({initialize:function(){this._data=null,this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateData),this.$compSchema.dataTypes||(this.$compSchema.dataTypes=[""])},_getDataManager:function(){return this._data?this._data.getDataManager():null},getRawData:function(){return this._data?this._data.getData():void 0},getDataItem:function(){return this._data},setDataItem:function(a){this.isDataTypeValid(a)&&a!=this._data&&(this._removeCurrentData(),this._data=a,a&&(this._data.addComponentWithInterest(this),this._data.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange)),this._onDataChange(a))},_removeCurrentData:function(){if(this._data)try{this._data.removeComponentWithInterest(this),this._data.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange);var a=this._data.getDataManager();a&&a.removeDataItem(this._data),this._data=null}catch(b){}},setDataByQuery:function(a){this.injects().Data.getDataByQuery(a,function(a){this.setDataItem(a)}.bind(this))},isDataTypeValid:function(a){var b=a?a.getType():"";return!this.$compSchema.dataTypes.contains,this.$compSchema.dataTypes.contains(b)},_setDataField:function(a,b){this._data.set(a,b,!0)},_setMetaDataField:function(a,b){this._data.setMeta(a,b)},_onDataChange:function(a,b,c){var d={dataItem:a,field:b,value:c};this.invalidate(this.INVALIDATIONS.DATA_CHANGE,d,!0)},_exterminateData:function(){this._removeCurrentData()}})}),define.Class("core.components.base.traits.BaseCompInvalidation",function(a){var b=a;b.resources(["W.ComponentLifecycle"]),b.utilize(["core.components.base.InvalidationCollector"]),b.methods({initialize:function(){this._invalidations_=new this.imports.InvalidationCollector},invalidate:function(a,b,c){a&&(this._invalidations_.invalidate(a,b),c&&this.trigger(a,b)),this.resources.W.ComponentLifecycle.forceRender()},isInvalidated:function(a){return this._invalidations_.isInvalidated(a)},getInvalidationByType:function(a){return this._invalidations_.getInvalidationByType(a)},getLastInvalidationByType:function(a){return this._invalidations_.getLastInvalidationByType(a)}})}),define.Class("core.components.base.traits.BaseCompLayout",function(a){var b=a;b.methods({initialize:function(){this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateLayout)},setWidth:function(a){value=parseInt(a,10),isNaN(value)||(value=this._limitWidth(value),this._setWidth_(value),this.getRequestDimensions().width=value,this.invalidate(this.INVALIDATIONS.WIDTH_REQUEST,{width:value,requestedWeight:a},!0),this.resources.W.ComponentLifecycle.forceRender())},setHeight:function(a){value=parseInt(a,10),isNaN(value)||(value=this._limitHeight(value),this._setHeight_(value),this.getRequestDimensions().height=value,this.invalidate(this.INVALIDATIONS.HEIGHT_REQUEST,{height:value,requestedHeight:a},!0),this.resources.W.ComponentLifecycle.forceRender())},setX:function(a){value=parseInt(a,10),isNaN(value)||(this._setX_(value),this.getRequestDimensions().left=value,this.invalidate(this.INVALIDATIONS.X_REQUEST,{x:value,requestedX:a},!0),this.resources.W.ComponentLifecycle.forceRender())},setY:function(a){value=parseInt(a,10),isNaN(value)||(this._setY_(value),this.getRequestDimensions().top=value,this.invalidate(this.INVALIDATIONS.Y_REQUEST,{y:value,requestedY:a},!0),this.resources.W.ComponentLifecycle.forceRender())},getWidth:function(){return this.getRequestDimensions().width},getHeight:function(){return this.getRequestDimensions().height},getX:function(){return this.getRequestDimensions().left},getY:function(){return this.getRequestDimensions().top},getInvalidatedWidth:function(){var a=this.getLastInvalidationByType(this.INVALIDATIONS.WIDTH_REQUEST);return a?a.width:null},getInvalidatedHeight:function(){var a=this.getLastInvalidationByType(this.INVALIDATIONS.HEIGHT_REQUEST);return a?a.height:null},getInvalidatedX:function(){var a=this.getLastInvalidationByType(this.INVALIDATIONS.X_REQUEST);return a?a.x:null},getInvalidatedY:function(){var a=this.getLastInvalidationByType(this.INVALIDATIONS.Y_REQUEST);return a?a.y:null},_setWidth_:function(a){a=this._limitWidth(a),this.$view.style.minWidth=a+"px"},_setHeight_:function(a){a=this._limitHeight(a),this.$view.style.minHeight=a+"px"},_setX_:function(a){this.$view.style.left=a+"px"},_setY_:function(a){this.$view.style.top=a+"px"},getPhysicalHeight:function(){var a=this.getMeasure().height,b=this.getInvalidatedHeight();return Math.max(a,b)},getPhysicalWidth:function(){var a=this.getMeasure().width,b=this.getInvalidatedWidth();return Math.max(a,b)},getRequestDimensions:function(){return this.$view.$requestDimensions=this.$view.$requestDimensions||{width:0,height:0,top:0,left:0},this.$view.$requestDimensions},getMeasure:function(){return this.$view.$measure||{width:0,height:0,top:0,left:0}},getMinDragY:function(a){return W.Layout&&W.Layout.getComponentMinDragY(this,a)},isSizeInvalidated:function(){return!!this.getInvalidatedWidth()||!!this.getInvalidatedHeight()},_limitWidth:function(a){return this._limitDimension(a,this.getSizeLimits().minW,this.getSizeLimits().maxW)},_limitHeight:function(a){return this._limitDimension(a,this.getSizeLimits().minH,this.getSizeLimits().maxH)},_limitDimension:function(a,b,c){return Math.min(Math.max(a,b),c)},disableReportLayoutChange:function(){this._isReportLayoutChangeDisabled=!0},enableReportLayoutChange:function(){this._isReportLayoutChangeDisabled=!1},isFixedPositioned:function(){return!1},reportLayoutChange:function(){if(!this._isReportLayoutChangeDisabled){var a=!0;null==this.getAnchors()||W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getAnchors())?a=!1:null!=this.getHorizontalGroup()&&W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getHorizontalGroup())?a=!1:this._areAnchorsAlreadySet||(a=!1),this._anchorTargetsReady||a?(this._anchorsInvalidated=!1,this._anchorTargetsReady=!0,W.Layout&&W.Layout.enforceAnchors([this])):this._anchorsInvalidated=!0}},_exterminateLayout:function(){W.Layout&&W.Layout.deleteSavedAnchorsById(this.getComponentId())}})}),define.Class("core.components.base.traits.BaseCompProperties",function(a){var b=a;b.resources(["W.ComponentData"]),b.statics({_definitionFieldName_:"_propertiesSchemaType_",_fieldName_:"propertiesSchemaType",_aggregateSchema_:function(a){return a||""}}),b.methods({initialize:function(){this._properties=null,this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateProperties)},setComponentProperties:function(a){a&&a!==this._properties&&(this._removeCurrentProperties(),this._properties=a,this._properties.addComponentWithInterest(this),this._properties.addEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange),this.$view.setProperty("propertyQuery",this._properties.get("id")))},_removeCurrentProperties:function(){if(this._properties){this._properties.removeComponentWithInterest(this),this._properties.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onDataChange);var a=this._properties.getDataManager();a&&a.removeDataItem(this._properties),this._properties=null}},getComponentProperties:function(){return this._properties||this._createComponentProperties(),this._properties},getComponentProperty:function(a){return this._properties||this._createComponentProperties(),this._properties.get(a)},setComponentProperty:function(a,b,c){this._properties||this._createComponentProperties(),this._properties.set(a,b,c)},_createComponentProperties:function(){if(this.$view){var a=this._compId,b=this.$compSchema.propertiesSchemaType;if(!b)return null;var c=this.resources.W.ComponentData.addDataItem(a,{type:b},this);this.setComponentProperties(c)}},deleteComponentProperty:function(){},_onComponentPropertyChange:function(){},_loadComponentProperties:function(){},_exterminateProperties:function(){this._removeCurrentProperties()}})}),define.Class("core.components.base.traits.BaseCompSkinHandler",function(a){var b=a;b.statics({_definitionFieldName_:"_skinParts_",_fieldName_:"skinParts",_aggregateSchema_:function(a,b,c){if((!a||a&&"object"!==typeOf(a))&&(a={}),b&&"object"===typeOf(b)&&Object.merge(a,b),c&&"object"===typeOf(c))for(var d in c)delete a[d];return a}}),b.methods({initialize:function(a,b,c){this.on(Constants.EventDispatcher.Events.EXTERMINATING,this,this._exterminateView),this._styleNameSpace=c&&c.styleNameSpace,this.$compSchema.skinParts||(this.$compSchema.skinParts={})},setSkin:function(a){this._removeOldSkinAndExtractInlineContent(),this._skin=a,this._skin._setLogic_(this)},getSkin:function(){return this._skin||null},setSkinMapper:function(a){if(this._skin.getOriginalClassName()===a.getSkin())this._skin.setParamMapper(a);else{var b=a.getSkinClass(),c=new b;c.setParamMapper(a),this.setSkin(c)}},getSkinMapper:function(){return this._skin&&this._skin.getParamMapper()||null},getStyleNameSpace:function(){return this._styleNameSpace||this.$className},getInlineContent:function(){return this._skinParts&&this._skinParts.inlineContent?this._skinParts.inlineContent.getChildren():!this._skinParts&&this.$view?this.$view.getChildren():null},_removeOldSkinAndExtractInlineContent:function(){var a=this.getInlineContent();a&&(this.$view.empty(),this.$view.adopt(a)),this._skin&&this._skin._removeLogic_()},_updateSkinParts_:function(a){this._validateSkinParts(a),this._skinParts=this._processCompParts(a),this.invalidate(this.INVALIDATIONS.SKIN_CHANGE)},_validateSkinParts:function(a){var b=this.$compSchema.skinParts;if(b)for(var c in b){var d=b[c];a[c]||d.optional||d.autoCreate===!1||LOG.reportError(wixErrors.SKIN_PART_MISSING,this.getOriginalClassName()+" / "+this._skin.getOriginalClassName(),"_validateSkinParts",c)()}},_processCompParts:function(a){var b=Object.clone(a),c=this.$compSchema.skinParts;for(var d in c){var e=c[d];if("htmlElement"!==e.type&&e.autoCreate!==!1){var f=this.getSkinPartDefinition(d),g=a[d];b[d]=this._createInnerComponent(f,g,!1)}}return b},getSkinPartDefinition:function(a){var b=this.$compSchema.skinParts[a],c=this._skin&&this._skin.getCompPartsDefinition()[a]||{},d={id:a};return b?d=Object.merge(d,c,b):(d.partDefinitionNotFound="maybe you missed a letter?",LOG.reportError(wixErrors.CM_NO_PART,this.getOriginalClassName(),"getSkinPartDefinition",a)()),d.hookMethod&&"function"==typeOf(this[d.hookMethod])&&(d.argObject=d.argObject||{},d=this[d.hookMethod](d)),d},_exterminateView:function(){this._skin&&this._skin.exterminate(),this.$view&&(this.$view.cleanup(),this.$view.destroy(),this.$view=null)}})}),define.Class("core.components.base.traits.BaseCompStates",function(a){var b=a;b.fields({DEFAULT_GROUP_NAME:"DEFAULT",ATTR_NAME:"state"}),b.statics({_definitionFieldName_:"_states_",_fieldName_:"states",_aggregateSchema_:function(a,b,c){if(a=a||[],"array"===typeOf(a)&&(a={DEFAULT:a}),b&&("array"===typeOf(b)?a.DEFAULT=b:Object.merge(a,b)),c)if("array"===typeOf(c))a.DEFAULT=[];else for(var d in c)delete a[d];var e={};for(var f in a)Array.each(a[f],function(a){return e[a]?(LOG.reportError(wixErrors.CM_DUPLICATE_STATE_NAME,"BaseCompStates","_aggregateSchema_",a)(),null):(e[a]=1,void 0)}.bind(this));return a}}),b.methods({initialize:function(){this._selectedStates={},this._groupNames=[],this.$compSchema.states||(this.$compSchema.states={}),this._initializeCurrentState()},_initializeCurrentState:function(){this._selectedStates={},Object.each(this.$compSchema.states,function(a,b){this._selectedStates[b]=a[0]},this),this._syncViewNodeWithStates()},getState:function(a){var b=a||this.DEFAULT_GROUP_NAME,c=this._selectedStates[b];return c||null},setState:function(a,b){var c=a,d=b;return d||(d=this._getGroupNameByState(c)),d?this._selectedStates[d]?this.$compSchema.states[d].contains(c)?(this._selectedStates[d]=c,this._syncViewNodeWithStates(),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,"BaseCompStates","setState",this.getOriginalClassName()+"{"+b+":"+a+"}"),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_GROUP,"BaseCompStates","setState",this.getOriginalClassName()+"{"+b+"}"),void 0):(LOG.reportError(wixErrors.CM_UNKNOWN_STATE_NAME,"BaseCompStates","setState",this.getOriginalClassName()+"{"+b+":"+a+"}"),void 0)},hasState:function(a,b){return b||(b=this._getGroupNameByState(a)),b?this.$compSchema.states?this.$compSchema.states[b]?this.$compSchema.states[b].contains(a)?!0:!1:!1:!1:!1},_getGroupNameByState:function(a){for(var b in this.$compSchema.states)if(this.$compSchema.states[b].contains(a))return b;return null},_syncViewNodeWithStates:function(){var a=this.getViewNode();if(a){var b=Object.values(this._selectedStates).join(" ");a.setAttribute(this.ATTR_NAME,b),a.addClass("FOCRE_REFLOW_PLEASE"),a.removeClass("FOCRE_REFLOW_PLEASE")}}})}),define.Class("core.components.base.traits.OldBaseCompEditorPropIntegration",function(a){var b=a;b.utilize(["core.components.base.SizeLimits"]),b.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),b.methods({initialize:function(){this._showOnAllPagesChangeability=!0,this._usesExternalData=!1,this._resizableSides||(this._resizableSides=[Constants.BaseComponent.ResizeSides.TOP,Constants.BaseComponent.ResizeSides.LEFT,Constants.BaseComponent.ResizeSides.BOTTOM,Constants.BaseComponent.ResizeSides.RIGHT]),this._moveDirections=[Constants.BaseComponent.MoveDirections.HORIZONTAL,Constants.BaseComponent.MoveDirections.VERTICAL],this.on(this.INVALIDATIONS.Y_REQUEST,this,this._OBCEI_onMovement),this.on(this.INVALIDATIONS.X_REQUEST,this,this._OBCEI_onMovement)},getSelectableX:function(){return this.getX()},getSelectableY:function(){return this.getY()},getSelectableWidth:function(){return this.getPhysicalWidth()},getSelectableHeight:function(){return this.getPhysicalHeight()},isSelectable:function(){return!0},getHorizontalGroup:function(){return this._horizontalGroup},_OBCEI_onMovement:function(){this.fireEvent("componentMoved")},allowHeightLock:function(){return this.isVertResizable()},getResizableSides:function(){return this._resizableSides},isResizable:function(){return this._resizableSides.length>0},isHorizResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.RIGHT)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.LEFT)},isVertResizable:function(){return this._resizableSides.contains(Constants.BaseComponent.ResizeSides.TOP)||this._resizableSides.contains(Constants.BaseComponent.ResizeSides.BOTTOM)},isHorizontallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.HORIZONTAL)},isVerticallyMovable:function(){return this._moveDirections.contains(Constants.BaseComponent.MoveDirections.VERTICAL)},getSizeRefNode:function(){return this._getEditBoxReferenceNode().getSize()},_getEditBoxReferenceNode:function(){return this.$view},getExtraPixels:function(a){return this.getDivExtraPixels(this.$view,a)},getDivExtraPixels:function(a,b){var c=Number.from(a.getStyle("border-top"))+Number.from(a.getStyle("padding-top")),d=Number.from(a.getStyle("border-bottom"))+Number.from(a.getStyle("padding-bottom")),e=Number.from(a.getStyle("border-left"))+Number.from(a.getStyle("padding-left")),f=Number.from(a.getStyle("border-right"))+Number.from(a.getStyle("padding-right"));return b&&(c+=Number.from(a.getStyle("margin-top")),d+=Number.from(a.getStyle("margin-bottom")),e+=Number.from(a.getStyle("margin-left")),f+=Number.from(a.getStyle("margin-right"))),{top:c,bottom:d,left:e,right:f,height:c+d,width:e+f}},isSiteSegment:function(){return this.isInstanceOfClass("wysiwyg.viewer.components.SiteSegmentContainer")},isInstanceOfClass:function(a){if(this.className==a)return!0;for(var b=this.$parentPrototype;b;){if(b.className==a)return!0;b=b.$parentPrototype}return!1},useLayoutOnDrag:function(){return!1},useLayoutOnResize:function(){return!1},isDraggable:function(){return!0},isEditableInPlace:function(){return!1},getGlobalPosition:function(){return this.$view.getPosition()},getGlobalPositionRefNode:function(){return this._getEditBoxReferenceNode().getPosition()},getParentComponent:function(){var a=this.getViewNode().getParent("[comp]");return a&&a.getLogic?a.getLogic():null},isAnchorable:function(){return{to:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD},from:{allow:!0,lock:Constants.BaseComponent.AnchorLock.BY_THRESHOLD}}},isContainable:function(){return!0},isDeleteable:function(){return!0},isDuplicatable:function(){return!0},isDeleteableRecurse:function(){if(!this.isDeleteable())return!1;for(var a=this.getViewNode().getElements("[comp]"),b=0;b<a.length;b++)if(a[b].getLogic&&!a[b].getLogic().isDeleteable())return!1;
return!0},isMultiSelectable:function(){return!0},getShowOnAllPagesChangeability:function(){return this._showOnAllPagesChangeability},setShowOnAllPagesChangeability:function(a){this._showOnAllPagesChangeability=a},hasChildren:function(){return!1},canMoveToOtherScope:function(){return!0},isUsingExternalData:function(){return this._usesExternalData},onPageVisibilityChange:function(){},getID:function(){return this.$view.getProperty("id")}})}),define.Class("core.components.base.traits.OldBaseCompIntegration",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.methods({initialize:function(a,b){this._view=b,this._isRendered=!1,this.on(Constants.LifecycleSteps.FIRST_RENDER,this,this._OBCI_onRender),this.on(this.INVALIDATIONS.SIZE,this,this._OBCI_onSizeChange)},_OBCI_onRender:function(){this.off(Constants.LifecycleSteps.FIRST_RENDER,this,this._OBCI_onRender),this._isRendered=!0,this.fireEvent(Constants.ComponentEvents.RENDER),this.$view.fireEvent(Constants.ComponentEvents.RENDER),this.fireEvent(Constants.ComponentEvents.READY),this.$view.fireEvent(Constants.ComponentEvents.READY)},_OBCI_onSizeChange:function(){this.fireEvent("autoSizeChange")},setStyle:function(a){this.setSkinMapper(a)},getStyle:function(){return this.getSkinMapper()},getIsDisposed:function(){return this._isExterminated},isRendered:function(){return this._isRendered},getViewNode:function(){return this.$view},dispose:function(){this.exterminate()},isContainer:function(){return!1}})}),define.Class("core.components.base.traits.OldBaseCompLayoutIntegration",function(a){var b=a;b.utilize(["core.components.base.SizeLimits"]),b.statics({MINIMUM_X_DEFAULT:-2e3,MAXIMUM_X_DEFAULT:2e3,MINIMUM_Y_DEFAULT:-1e3,MAXIMUM_Y_DEFAULT:4e4,MINIMUM_WIDTH_DEFAULT:5,MINIMUM_HEIGHT_DEFAULT:5,MAXIMUM_WIDTH_DEFAULT:2500,MAXIMUM_HEIGHT_DEFAULT:2e3}),b.methods({initialize:function(){this._actualHeight=-1,this._anchors=[],this._reverseAnchors=[],this.initComponentLayout()},initComponentLayout:function(){this.$view.setStyle("visibility","visible"),this.removeEvent(Constants.ComponentEvents.READY_FOR_RENDER,this.initComponentLayout),this._valueFetchingRegex=/[-\d\.]+/;for(var a=["x","y","width","height"],b=!1,c=0;c<a.length;c++){var d=a[c],e=this.$view.get(d);if(null!=e&&""!=e)switch(b=!0,e=Number(e),d){case"width":this.getRequestDimensions().width=e,this._setWidth_(e);break;case"height":this.getRequestDimensions().height=e,this._setHeight_(e);break;case"x":this.getRequestDimensions().left=e,this._setX_(e);break;case"y":this.getRequestDimensions().top=e,this._setY_(e)}}if(b&&this.$view.hasAttribute("pos")===!1)"relative"!=this.$view.getStyle("position")&&this.$view.setStyle("position","absolute");else{var f=this.$view.getAttribute("pos");f&&this.$view.setStyle("position",f)}this.saveCurrentDimensions(),this.saveCurrentCoordinates()},getMinPhysicalHeight:function(){return 1},saveCurrentDimensions:function(){this._lastDimensions={w:this.getWidth(),h:this.getHeight()}},getCurrentDimensions:function(){return this._lastDimensions={w:this.getWidth(),h:this.getHeight()},this._lastDimensions},getLastDimensions:function(){return this._lastDimensions||this.saveCurrentDimensions(),this._lastDimensions},getCurrentCoordinates:function(){return this._lastCoords={x:this.getX(),y:this.getY()},this._lastCoords},getLastCoordinates:function(){return this._lastCoords||this.saveCurrentCoordinates(),this._lastCoords},saveCurrentCoordinates:function(){this._lastCoords={x:this.getX(),y:this.getY()}},_onAutoSized:function(){},getIsDisplayed:function(){return this.isDisplayed()},checkVisibility:function(){return this.isDisplayed()},getSizeLimits:function(){return void 0===this._sizeLimits&&(this._sizeLimits=new this.imports.SizeLimits,this._sizeLimits.minW=this._sizeLimits.minW||this.MINIMUM_WIDTH_DEFAULT,this._sizeLimits.minH=this._sizeLimits.minH||this.MINIMUM_HEIGHT_DEFAULT,this._sizeLimits.maxW=this._sizeLimits.maxW||this.MAXIMUM_WIDTH_DEFAULT,this._sizeLimits.maxH=this._sizeLimits.maxH||this.MAXIMUM_HEIGHT_DEFAULT,this._originalSizeLimits=this._sizeLimits.clone()),this._sizeLimits},setMinW:function(a){this.getSizeLimits().minW=a,this._originalSizeLimits.minW=a,this._applySizeLimitsIfNeeded()},setMinH:function(a){this.getSizeLimits().minH=a,this._originalSizeLimits.minH=a,this._applySizeLimitsIfNeeded()},setMaxW:function(a){this.getSizeLimits().maxW=a,this._originalSizeLimits.maxW=a,this._applySizeLimitsIfNeeded()},setMaxH:function(a){this.getSizeLimits().maxH=a,this._originalSizeLimits.maxH=a,this._applySizeLimitsIfNeeded()},_applySizeLimitsIfNeeded:function(){(this._$width<this.getSizeLimits().minW||this._$width>this.getSizeLimits().maxW)&&this.setWidth(this._$width),(this._$height<this.getSizeLimits().minH||this._$height>this.getSizeLimits().maxH)&&this.setHeight(this._$height)},_onResize:function(){this.fireEvent("resize")},flushPhysicalHeightCache:function(){delete this._actualHeight},flushMinPhysicalHeightCache:function(){delete this._minPhysicalHeight},getAnchors:function(){return this._anchors},setAnchors:function(a){this._areAnchorsAlreadySet=!0,this._anchors=a,a.forEach(this.addReverseAnchor)},addAnchor:function(a){this._anchors.push(a),this.addReverseAnchor(a)},addReverseAnchor:function(a){a.toComp===this?this._reverseAnchors.include(a):a.toComp.addReverseAnchor(a)},getReverseAnchors:function(){return this._reverseAnchors},getHorizontalGroup:function(){return this._horizontalGroup},setHorizontalGroup:function(a){this._horizontalGroup=a}})}),define.Class("core.components.image.ImageDimensions",function(a){var b=a;b.statics({settingOptions:{crop:{FILL:"fill",FULL:"full",STRETCH:"stretch"},align:{LEFT:"left",CENTER:"center",RIGHT:"right"},v_align:{TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"}}}),b.methods({initialize:function(){this._imageSettings={crop:this.settingOptions.crop.FILL,align:this.settingOptions.align.CENTER,v_align:this.settingOptions.v_align.MIDDLE}},getDimensionsForContainerSize:function(a,b){var c=this._getImageRequestSize(a,b),d=this._getImageObjectSize(c,b),e=this._getImageLeftPosition(d.x,b.x),f=this._getImageTopPosition(d.y,b.y);return{imageRequestSize:c,imageObjectSize:d,imageVisibleSize:{x:Math.min(b.x,c.x),y:Math.min(b.y,c.y)},imagePosition:{x:e,y:f}}},_getImageRequestSize:function(a,b){var c,d,e=a.x/a.y,f=b.x/b.y;switch(this._imageSettings.crop){case this.settingOptions.crop.FILL:case this.settingOptions.crop.STRETCH:e>f?(d=b.y,c=d*e):(c=b.x,d=c/e);break;case this.settingOptions.crop.FULL:f>e?(d=b.y,c=d*e):(c=b.x,d=c/e)}return{x:Math.ceil(c),y:Math.ceil(d)}},_getImageObjectSize:function(a,b){var c=a;return this._imageSettings.crop===this.settingOptions.crop.STRETCH&&(c=b),c},_getImageLeftPosition:function(a,b){var c;switch(this._imageSettings.align){case this.settingOptions.align.LEFT:c=0;break;case this.settingOptions.align.CENTER:c=b/2-a/2;break;case this.settingOptions.align.RIGHT:c=b-a}return Math.ceil(c)},_getImageTopPosition:function(a,b){var c;switch(this._imageSettings.v_align){case this.settingOptions.v_align.TOP:c=0;break;case this.settingOptions.v_align.MIDDLE:c=b/2-a/2;break;case this.settingOptions.v_align.BOTTOM:c=b-a}return Math.ceil(c)},getCropMode:function(){return this._imageSettings.crop},getHorizontalAlign:function(){return this._imageSettings.align},getVerticalAlign:function(){return this._imageSettings.v_align},setCropMode:function(a){return this._setSettingsProperty(this.settingOptions.crop,"crop",a)},setHorizontalAlign:function(a){return this._setSettingsProperty(this.settingOptions.align,"align",a)},setVerticalAlign:function(a){return this._setSettingsProperty(this.settingOptions.v_align,"v_align",a)},_setSettingsProperty:function(a,b,c){return this._imageSettings[b]!==c&&this._isValueInObject(a,c)?(this._imageSettings[b]=c,!0):!1},_isValueInObject:function(a,b){for(var c in a)if(a[c]===b)return!0;return!1}})}),define.Class("core.components.image.ImageDimensionsNew",function(a){var b=a;b.utilize(["core.components.image.ImageSettings"]),b.methods({initialize:function(){this.ImageSettings=this.imports.ImageSettings},getDimensionsForExactSize:function(a,b){return this._getImageDimensions(a,b,!0)},getDimensionsForPyramid:function(a,b){return this._getImageDimensions(a,b,!1)},_getImageDimensions:function(a,b,c){var d=b.x/b.y,e=this._getContainerSize(a,d),f=this._getWholeImageSize(a,d,e,c),g=this._getImagePosition(f,e,a);return{containerSize:e,imageSize:f,imagePosition:g}},_getContainerSize:function(a,b){var c=a.getCropMode(),d=Object.clone(a.getSize());return c===this.ImageSettings.CropModes.FIT_WIDTH?d.y=this._getHeightByWidth(d.x,b):c===this.ImageSettings.CropModes.FIT_HEIGHT&&(d.x=this._getWidthByHeight(d.y,b)),d},_getWholeImageSize:function(a,b,c,d){var e=c.x/c.y,f=Object.clone(c),g=a.getCropMode();return g===this.ImageSettings.CropModes.CONTAINS?e>b?f.x=this._getWidthByHeight(c.y,b):f.y=this._getHeightByWidth(c.x,b):(g===this.ImageSettings.CropModes.STRETCH||!d&&g===this.ImageSettings.CropModes.COVER)&&(e>b?f.y=this._getHeightByWidth(c.x,b):f.x=this._getWidthByHeight(c.y,b)),f},_getImagePosition:function(a,b,c){if(c.getCropMode()==this.ImageSettings.CropModes.STRETCH)return{x:0,y:0};var d={};return d.y=Math.ceil((b.y-a.y)/2),d.x=Math.ceil((b.x-a.x)/2),d},_getHeightByWidth:function(a,b){return Math.ceil(a/b)},_getWidthByHeight:function(a,b){return Math.ceil(a*b)}})}),define.component("core.components.image.ImageNew",function(a){var b=a;b.utilize(["core.components.image.ImageDimensionsNew","core.components.image.ImageUrlNew","core.components.image.ImageSettings"]),b.skinParts({image:{type:"htmlElement"}}),b.inherits("mobile.core.components.base.BaseComponent"),b.binds(["_onImageError"]),b.methods({initialize:function(a,b,c){this._initGlobalResources(),this.parent(a,b,c),this._useWebUrl=c.useWebUrl||!1,this._settings=c.settings,this._requestExactSize="boolean"==typeof c.requestExactSize?c.requestExactSize:!0,this._imageDimensions=new this.imports.ImageDimensionsNew,this._imageSrcBuilder=new this.imports.ImageUrlNew,this._imageUrl="",this._isSameImage=!1},_initGlobalResources:function(){this._utils=this.injects().Utils},setSettings:function(a){a&&(this._settings=a,this._renderIfReady())},_onDataChange:function(a,b,c){this._isSameImage=this._imageUrl===a.get("uri"),this._imageUrl=a.get("uri"),this.parent(a,b,c)},_prepareForRender:function(){return this._settings&&this._imageUrl?(this._refreshImage(),!0):!0},_refreshImage:function(){this._skinParts.image.set("alt",this._data.get("alt")),this._handleImageLoadingError();var a=this._getImageDimensions();this._setContainerSize(a.containerSize);var b=this._imageUrl;this._isGIF()?b=this._getImageSrc(this._getOriginalSizeFromData()):this._useWebUrl||this._imageUrl.test(/(^https?)|(^data)/)||this._isGIF()||(b=this._getImageSrc(a.imageSize,!this._isSameImage)),this._isSameImage=!0,this._setImageSrc(b);var c=this._settings.getCropMode()===this._settings.CropModes.STRETCH?a.containerSize:a.imageSize;this._setImagePositionAndSize(a.imagePosition,c)},_getImageDimensions:function(){var a,b=this._getOriginalSizeFromData();return a=this._requestExactSize&&!this._isGIF()?this._imageDimensions.getDimensionsForExactSize(this._settings,b):this._imageDimensions.getDimensionsForPyramid(this._settings,b)},_isGIF:function(){return this._imageUrl.test(/(\.gif$)/)},_getImageSrc:function(a,b){var c;if(this._requestExactSize)c=this._imageSrcBuilder.getImageUrlExactSize(a,this._imageUrl,this._getOriginalSizeFromData());else{var d=b?this._imageSrcBuilder.getImageUrlFromPyramidFirstTime(a,this._imageUrl):this._imageSrcBuilder.getImageUrlFromPyramidForSameImage(a,this._imageUrl,this._pyramidRequestSize);c=d.url,this._pyramidRequestSize=d.pyramidRequestSize}return c},_getOriginalSizeFromData:function(){var a={};return a.x=parseInt(this._data.get("width"),10),a.y=parseInt(this._data.get("height"),10),a.x||a.y||(a.x=a.y=128),a},_setContainerSize:function(a){this._utils.isEquivalent(this._containerSize,a)||(this.getViewNode().setStyles({width:a.x+"px",height:a.y+"px"}),this._containerSize=a)},getSize:function(){return this._containerSize},_setImageSrc:function(a){this._imgSrc!=a&&(this._skinParts.image.set("src",a),this._imgSrc=a)},_setImagePositionAndSize:function(a,b){this._skinParts.image.setStyles({"margin-top":a.y+"px","margin-left":a.x+"px",width:b.x+"px",height:b.y+"px"})},_onImageError:function(){LOG.reportError(wixErrors.IMAGE_LOAD_ERROR,"ImageNew","refresh",this._imageUrl),this._renderIfReady()},_handleImageLoadingError:function(){this._skinParts.image.removeEvents("error"),this._skinParts.image.addEvent("error",this._onImageError)}}),b.dataTypes(["Image",""])}),define.Class("core.components.image.ImageSettings",function(a){var b=a;b.statics({CropModes:{COVER:"fill",CONTAINS:"full",FIT_WIDTH:"fitWidth",FIT_HEIGHT:"fitHeight",STRETCH:"stretch"}}),b.methods({initialize:function(a,b,c){return this.setSettings(a,b,c)},setSettings:function(a,b,c){return this._validateSettings(a,b,c)?(this._cropMode=a,this._containerWidth=b,this._containerHeight=c,this):null},getCropMode:function(){return this._cropMode},getSize:function(){return{x:this._containerWidth,y:this._containerHeight}},setCropMode:function(a){this._validateSettings(a,this._containerWidth,this._containerHeight)&&(this._cropMode=a)},setSize:function(a,b){this._validateSettings(this._cropMode,a,b)&&(this._containerWidth=a,this._containerHeight=b)},setWidth:function(a){this._containerWidth=a},setHeight:function(a){this._containerHeight=a},setContainerHeight:function(a){this._validateSettings(this._cropMode,this._containerWidth,a)&&(this._containerHeight=a)},setContainerWidth:function(a){this._validateSettings(this._cropMode,a,this._containerHeight)&&(this._containerWidth=a)},_validateSettings:function(a,b,c){switch(a){case this.CropModes.FIT_WIDTH:return this._isValidNumber(b);case this.CropModes.FIT_HEIGHT:return this._isValidNumber(c);case this.CropModes.COVER:case this.CropModes.CONTAINS:case this.CropModes.STRETCH:return this._isValidNumber(c)&&this._isValidNumber(b);default:return!1}},_isValidNumber:function(a){return a&&"number"==typeof a&&!isNaN(a)&&a>0},_getErrorDescString:function(a,b,c){return"_cropMode: "+a+" width: "+b+" height: "+c}})}),define.Class("core.components.image.ImageUrl",function(a){var b=a;b.resources(["W.Config"]),b.methods({getImageUrlExactSize:function(a,b){var c=this.resources.W.Config.getMediaStaticUrl(b)+b,d=this._getFileExtension(c);return c+"_srz_"+parseInt(a.x,10)+"_"+parseInt(a.y,10)+"_85_22_0.50_1.20_0.00_"+d+"_srz"},getImageUrlFromPyramid:function(a,b,c,d){var e=this.resources.W.Config.getMediaStaticUrl(b)+b,f=a.y>a.x?a.y:a.x,g=this._getPyramidSize(f,c,d);return e=e+"_"+g,{url:e,pyramidRequestSize:g}},_getPyramidSize:function(a,b,c){for(var d=[128,256,400,512,650,850,1024],e=d[d.length-1],f=0;f<d.length;++f)if(d[f]>=a){e=d[f];break}return b&&(e=Math.max(e,c)||e),e},_getFileExtension:function(a){var b=/[.]([^.]+)$/.exec(a);return b&&/[.]([^.]+)$/.exec(a)[1]||""}})}),define.Class("core.components.image.ImageUrlNew",function(a){var b=a;b.methods({initialize:function(){this._initGlobalResources()},_initGlobalResources:function(){this._config=this.injects().Config},getImageUrlExactSizeKeepRatio:function(a,b){var c=this._config.getMediaStaticUrl(b)+b,d=this._getFileExtension(c),e=[c];return e.push("srb"),e.push(parseInt(a.x,10)),e.push(parseInt(a.y,10)),e.push("75_22_0.50_1.20_0.00"),e.push(d),e.push("srb"),e.join("_")},getImageUrlExactSize:function(a,b,c){var d=this._config.getMediaStaticUrl(b)+b,e=this._getFileExtension(d),f=[d];f.push("srz");var g=this._getRequestSizeSmallerThanOriginal(a,c);return f.push(parseInt(g.x,10)),f.push(parseInt(g.y,10)),f.push("75_22_0.50_1.20_0.00"),f.push(e),f.push("srz"),f.join("_")},getImageAbsoluteUrlFromRelativeUrl:function(a){return this._config.getMediaStaticUrl(a)+a},getImageUrlFromPyramidFirstTime:function(a,b){return this._getUrlForPyramid(a,b)},getImageUrlFromPyramidForSameImage:function(a,b,c){return this._getUrlForPyramid(a,b,!0,c)},_getRequestSizeSmallerThanOriginal:function(a,b){var c=b.x/a.x,d=b.y/a.y;if(c>=1&&d>=1)return a;var e={};return d>c?(e.x=b.x,e.y=b.x*(a.y/a.x)):(e.y=b.y,e.x=b.y*(a.x/a.y)),e},_getUrlForPyramid:function(a,b,c,d){var e=this._config.getMediaStaticUrl(b)+b,f=a.y>a.x?a.y:a.x,g=this._getPyramidSize(f,c,d);return e=e+"_"+g,{url:e,pyramidRequestSize:g}},_getPyramidSize:function(a,b,c){var d,e=[128,256,400,512,650,850,1024],f=e[e.length-1];for(d=0;d<e.length;++d)if(e[d]>=a){f=e[d];break}return b&&(f=Math.max(f,c)||f),f},_getFileExtension:function(a){var b=/[.]([^.]+)$/.exec(a);return b&&/[.]([^.]+)$/.exec(a)[1]||""}})}),define.Class("core.components.traits.SwipeSupport",function(a){var b=a;b.binds(["_onTouchDown","_onTouchMove","_onTouchUp"]),b.fields({_swipeMovementSpeedProp:"_movementSpeed",_swipeOrientation:"horizontal",_swipeEmulate:!1,_swipeLastPos:[],_swipeActive:!1,_swipeFrameCount:0,_touchSupported:!1}),b.methods({initialize:function(){this._touchSupported="ontouchend"in document||this._swipeEmulate,this._touchSupported&&(this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this._view.addEvent(this._swipeEmulate?"mousedown":"touchstart",this._onTouchDown,!0),this._Tween=this.injects().Utils.Tween)},_onComponentReady:function(){this._skinParts.swipeLeftHitArea.setStyle("display","none"),this._skinParts.swipeRightHitArea.setStyle("display","none")},_onTouchDown:function(a){this._view.addEvent(this._swipeEmulate?"mousemove":"touchmove",this._onTouchMove,!0),this._view.addEvent(this._swipeEmulate?"mouseup":"touchend",this._onTouchUp,!0),this._swipeLastPos=[{x:a.client.x,y:a.client.y,time:(new Date).getTime()}],this._swipeActive=!0,this._swipeFrameCount=0,this._enableMovement(!0)},_setSwipeMovementSpeed:function(a){this[this._swipeMovementSpeedProp]=a},_addLastPos:function(a){this._swipeLastPos.unshift(a),this._swipeLastPos.length>5&&this._swipeLastPos.pop()},_onTouchMove:function(a){a.preventDefault();var b={x:a.client.x,y:a.client.y,time:(new Date).getTime()},c=this._getSwipeDistance(b,this._swipeLastPos[0]);this._shiftOffset-=c,this._Tween.to(this,1,{_shiftOffset:this._shiftOffset-c,ease:"strong_easeInOut"}),this._addLastPos(b)},_onTouchUp:function(a){var b={x:a.client.x,y:a.client.y,time:(new Date).getTime()};b=this._swipeLastPos[0],this._view.removeEvent(this._swipeEmulate?"mouseup":"touchend",this._onTouchUp,!0),this._view.removeEvent(this._swipeEmulate?"mousemove":"touchmove",this._onTouchMove,!0);var c=this._calculateSwipeSpeed(this._swipeLastPos[this._swipeLastPos.length-1],b);this._Tween.killTweensOf(this),this._setSwipeMovementSpeed(20*-c);var d={ease:"linear",onComplete:function(){this._enableMovement(!1)}.bind(this)};d[this._swipeMovementSpeedProp]=0,this._Tween.to(this,1,d)},_getSwipeDistance:function(a,b){return"horizontal"==this._swipeOrientation?b.x-a.x:"vertical"==this._swipeOrientation?b.y-a.y:void 0},_calculateSwipeSpeed:function(a,b){return this._getSwipeDistance(a,b)/(b.time-a.time)}})}),define.oldTrait({name:"core.components.traits.TouchRollOverSupport",trait:{Binds:["_onComponentTouchStart","_onStageTouchStart","_onRender","_onComponentReady"],initialize:function(){this._touchSupported="ontouchend"in document||this._swipeEmulate,this._touchSupported&&(this._states.touchRollOverSupport=["touchRollOver","touchRollOut"],this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this.addEvent(Constants.ComponentEvents.RENDER,this._onRender))},_onComponentReady:function(){this.setState("touchRollOut")},_onRender:function(){this._view.addEvent("touchstart",this._onComponentTouchStart),document.addEvent("touchstart",this._onStageTouchStart)},_onComponentTouchStart:function(a){-1!==this.getState().indexOf("touchRollOut")&&(a.preventDefault(),a.stopPropagation(),this.setState("touchRollOver"))},_onStageTouchStart:function(a){-1!==this.getState().indexOf("touchRollOver")&&-1===a.target.getParents().indexOf(this._view)&&a.target!==this._view&&this.setState("touchRollOut")},dispose:function(){document.removeEvent("touchstart",this._onStageTouchStart),this.parent()}}}),define.experiment.component("core.components.Button.RichText2.New",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(a,b,c){c&&c.shouldRenderOnDisplay&&this.startRenderingComponentOnDisplay()}),startRenderingComponentOnDisplay:function(){this._renderTriggers.indexOf(Constants.DisplayEvents.DISPLAY_CHANGED)<0&&this._renderTriggers.push(Constants.DisplayEvents.DISPLAY_CHANGED)}})}),define.experiment.component("core.components.Button.RichTextToolbar.New",function(a,b){var c=a;c.fields({_triggers:["click"],_canFocus:!0,_toggleMode:!1,_disabled:!1,_iconSrc:"",_tmpCommand:null,_tmpCommandParameter:null}),c.methods({initialize:function(a,b,c){this.parent(a,b,c),c=c||{},c.label=c.label||b.getAttribute("label"),c&&c.shouldRenderOnDisplay&&this.startRenderingComponentOnDisplay(),this.setParameters(c)},_onDataChange:function(a,b,c){a&&(this._label=a.get("label")||this._label,this._toggleMode=a.get("toggleMode")||this._toggleMode,this._disabled=a.get("disabled")||this._disabled,this._iconSrc=a.get("iconSrc")||this._iconSrc,this._tmpCommand=a.get("command")||this._tmpCommand,this._tmpCommandParameter=a.get("commandParameter")||this._tmpCommandParameter),this.parent(a,b,c)}})}),define.experiment.Class("core.components.Container.NBC_WCD.New",function(a,b){var c=a;c.methods({addChild:function(a){var b,c=a.getParentComponent();if(c)var b=c.getChildComponents().map(function(a){return a.getLogic().getComponentId()});a.getViewNode().insertInto(this.getInlineContentContainer()),c&&this._reportComponentsZOrderChanged(a,c,b),this.moveChild(a,this.Z_INDEX_CHANGE_TYPES.TOP)}})}),define.experiment.component("core.components.Image.ImageLoadPerformance.New",function(a,b){var c=a,d=b;c.methods({_handleLoadEnd:function(a){imagePerformance=this._getImagesPerformance(),imagePerformance.timing.push({url:this._skinParts.image.src,start:this._loadStart,end:LOG.getSessionTime(),hadError:a,width:this._skinParts.image.width,height:this._skinParts.image.height})},_onImageLoaded:d.before(function(){this._handleLoadEnd(!1)}),_onImageError:d.before(function(){this._handleLoadEnd(!0)}),_setNewImage:d.before(function(){this._loadStart=LOG.getSessionTime(),this._getImagesPerformance().started++}),_getImagesPerformance:function(){return window._imagePerformance||(window._imagePerformance={started:0,timing:[]}),window._imagePerformance}})}),define.experiment.component("core.components.MenuButton.LimitRecursiveDDM.New",function(a){var b=a;b.methods({getWidthOnLayout:function(){function a(a){var c=b.getStyle(a);return""!=c?parseInt(c,10):0}var b=this.getViewNode();return b.offsetWidth+a("margin-right")+a("margin-left")}})}),define.experiment.component("core.components.MenuButton.WixAppsPage.New",function(a,b){var c=a;c.skinParts({label:{type:"htmlElement"},icon:{type:"htmlElement",optional:!0},description:{type:"htmlElement",optional:!0},bullet:{type:"htmlElement",optional:!0}}),c.methods({_getButtonLabelTextField:function(){return this._data.getType().contains("Page")?"title":"text"}})}),define.experiment.component("core.components.Page.EditorScripting.New",function(a,b){var c=a,d=b;c.resources(d.merge(["W.Commands"])),c.methods({_setContentRendered:d.after(function(){this.resources.W.Commands.executeCommand("WViewerCommands.Page.ContentRendered",this)})})}),define.experiment.component("core.components.Page.PageHeightFix.New",function(a){var b=a;b.methods({render:function(){this.setHeight(0)},setHeight:function(a,b,c){var d=a;this.isContentReady()&&!b&&(d=this.resources.W.Layout.getComponentMinResizeHeight(this)),this.parent(d,b,c)}})}),define.experiment.component("core.components.Page.Responsive1.New",function(a){var b=a;b.statics({MIN_HEIGHT:100})}),define.experiment.component("core.components.base.BaseComp.EditorScripting.New",function(a,b){var c=a,d=b;c.traits(d.merge(["core.components.base.traits.BaseScripting"]))}),define.experiment.newClass("core.components.base.traits.BaseScripting.EditorScripting.New",function(a,b){var c=a;c.methods({getComponentName:function(){return this.$view.getProperty("compname")},getComponentNameOrID:function(){return this.getComponentName()||this.getComponentId()},setComponentName:function(a){return this.$view.setProperty("compname",a)}})}),define.experiment.component("core.components.image.ImageNew.ImageLoadPerformance.New",function(a,b){var c=a,d=b;c.methods({_handleLoadEnd:function(a){imagePerformance=this._getImagesPerformance(),imagePerformance.timing.push({url:this._skinParts.image.src,start:this._loadStart,end:LOG.getSessionTime(),hadError:a,width:this._skinParts.image.width,height:this._skinParts.image.height})},_setImageSrc:d.before(function(a){this._imgSrc!=a&&(this._loadStart=LOG.getSessionTime(),this._getImagesPerformance().started++)}),_handleImageLoading:function(){this._skinParts.image.removeEvents("load"),this._skinParts.image.addEvent("load",function(){this._handleLoadEnd(!1)}.bind(this))},_onImageError:d.after(function(){this._handleLoadEnd(!0)}),_refreshImage:d.before(function(){this._handleImageLoading()}),_getImagesPerformance:function(){return window._imagePerformance||(window._imagePerformance={started:0,timing:[]}),window._imagePerformance}})}),define.experiment.Class("core.components.traits.SwipeSupport.FixTouchSupportBug.New",function(a){var b=a;b.methods({initialize:function(){this._touchSupported=Modernizr.touch||this._swipeEmulate,this._touchSupported&&(this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this._view.addEvent(this._swipeEmulate?"mousedown":"touchstart",this._onTouchDown,!0),this._Tween=this.injects().Utils.Tween)}})}),define.experiment.Class("core.components.traits.SwipeSupport.MobileSliderGallery.New",function(a,b){var c=a,d=b;c.binds(d.customizeField(function(){return[]})),c.methods({initialize:d.remove(),_onComponentReady:d.remove(),_onTouchDown:d.remove(),_setSwipeMovementSpeed:d.remove(),_addLastPos:d.remove(),_onTouchMove:d.remove(),_onTouchUp:d.remove(),_getSwipeDistance:d.remove(),_calculateSwipeSpeed:d.remove()})}),define.experiment.Class("core.components.traits.TouchRollOverSupport.FixTouchSupportBug.New",function(a){var b=a;b.methods({initialize:function(){this._touchSupported=Modernizr.touch||this._swipeEmulate,this._touchSupported&&(this._states.touchRollOverSupport=["touchRollOver","touchRollOut"],this.addEvent(Constants.ComponentEvents.READY,this._onComponentReady),this.addEvent(Constants.ComponentEvents.RENDER,this._onRender))}})}),define.experiment.dataSchema("Document.CustomSiteWidth.New",function(a){var b=a;return b.merge({siteWidthInPixels:{type:"number","default":980}})}),define.experiment.dataSchema("Image.LinkRefData.New",function(){return{link:"ref",title:"string",uri:"string",description:"string",height:"number",width:"number",borderSize:"string",alt:"string",originalImageDataRef:{type:"ref",description:"Original Image before edit","default":null}}}),define.experiment.dataSchema("WFlatTheme.MobileEditor1.New",function(){return{mobileBg:{type:"background","default":"none 0 0 center center auto repeat no-repeat absolute {color_2}"}}}),define.experiment.newDataSchema("DocumentLink.LinkRefData.New",function(){return{docId:"string",name:"string"}}),define.experiment.newDataSchema("EmailLink.LinkRefData.New",function(){return{mail:"string",mailParams:"string"}}),define.experiment.newDataSchema("LinkInputHelperDataSchema.LinkRefData.New",function(){return{target:"string",href:"string"}}),define.experiment.newDataSchema("LinkRefData.LinkRefData.New",function(){return{}}),define.experiment.newDataSchema("PageLink.LinkRefData.New",function(){return{pageId:"string"}}),define.experiment.newDataSchema("WebsiteLink.LinkRefData.New",function(){return{domain:"string",protocol:"string",path:"string",target:"string",port:{type:"number","default":80}}}),define.experiment.component("core.editor.components.UploadButton.NativeUploadButton.New",function(a,b){var c=a;c.utilize(["core.editor.managers.uploadmanager.DragAndDrop","core.editor.managers.uploadmanager.Uploader"]),window.$Uploader=null,c.resources(["W.Config","mode"]),c.statics({fleshUploader:{render:function(){this._flashLocation=W.Config.getServiceTopologyProperty("scriptsRoot")+"/flash/MediaUploader.swf";var a={},b={};b.quality="high",b.bgcolor="#FAFAFA",b.allowscriptaccess="always",b.allowfullscreen="true",b.wMode="window",b.scale="noScale",b.flashVars="serverRoot="+this.injects().Config.getServiceTopologyProperty("mediaServerRoot");var c={};c.id="UploadBTN",c.name="UploadBTN",c.align="middle",this._flashObjID=W.Utils.getUniqueId("UploadBTNFlashCont"),this._skinParts.flashContainer.setProperty("id",this._flashObjID),this._flashObj=swfobject.embedSWF(this._flashLocation,this._flashObjID,141,30,"10.0.0","playerProductInstall.swf",a,b,c)},setUploadFileType:function(a){this._message="setFileType",this._content=a,setTimeout(this._doCallFlash.bind(this),1)},_doCallFlash:function(){var a=this._getFlashObj("UploadBTN");a&&a.sendToFlash?a.sendToFlash(this._message,this._content):setTimeout(this._doCallFlash.bind(this),1)},_getFlashObj:function(a){var b=-1!=navigator.appName.indexOf("Microsoft");return b?window[a]:document[a]}},nativeUploader:{_onAllSkinPartsReady:function(){this.uploader=window.$Uploader||new this.imports.Uploader({addQueryParam:function(){return"&s="+this.context._content.mediaS},ticketUrl:this.baseUrl+"/media/tickets/get",uploadUrl:this.baseStaticUrl+"/api/add_file",getValidationRules:function(){return this.context._content||{}},parallelUploads:6,events:{onInit:function(){},onUploadStart:function(){},onSelectedFiles:function(){var a=document.createElement("ul");this.inQ.forEach(this.context._attachProgressNode.bind(this.context,a));var b=this.badFiles.filter(function(a){return a.$validation_errors_displayed?!1:a.$validation_errors_displayed=!0});b.length&&(b.forEach(this.context._attachErrorNode.bind(this.context,a)),this.context.injects().UserMedia.fireEvent("UploadError","<>"+this.context._createErrorMessage(b))),this.progressOutputNode&&this.progressOutputNode.appendChild(a)},onUploadProgress:function(a,b){var c,d,e=0,f=this.inProgress.indexOf(a),g=-1!==f?a:{};g.uploadprogress=~~(100*(b.loaded/b.total)),g&&g.getNode&&(d=g.getNode(),d.querySelector(".uploader-progress-bar").innerHTML=g.uploadprogress+"%"),c=this.inQ.concat(this.inProgress,this.done),c.forEach(function(a){e+=a.uploadprogress||0}),e/=c.length,this.context.injects().UserMedia.fireEvent("UploadProgressUpdate",e)},onFileUploaded:function(a,b){a.uploadResponse=this.context._parseMediaResponseXML(b.responseXML);var c=a.getNode();c.style.background="rgba(0,255,0,0.2)"},onUploadEnd:function(){function a(a){var b=a.getNode();setTimeout(function(){b.parentNode&&b.parentNode.removeChild(b),delete a.getNode},1500),this.context.resources.mode.debug&&this.history.push(a)}this.done.forEach(a,this),this.context._finleizeUpload(this.done),this.done.length=0},onUploadError:function(a){this.context.injects().UserMedia.fireEvent("UploadError",'<><ul class="uploader-error-message"><li>'+a+"</li></ul>")}}}),window.Uploader=this.uploader,this.uploader.context=this,this.uploader.progressOutputNode=this._createUploadStatusNode(),this._skinParts.flashContainer.appendChild(this.uploader.progressOutputNode),this._skinParts.flashContainer.appendChild(this.uploader.uploadButton)},setUploadFileType:function(a){this._content=a,this.uploader.uploadButton.setTitle(a.label)},_createUploadStatusNode:function(){var a=document.createElement("div");a.innerHTML='<div>Debug Upload Status <button data-action="close">X</button></div>',a.onclick=function(a){"close"===a.target.getAttribute("data-action")&&this.parentNode&&this.parentNode.removeChild(this)},a.className="uploader-status-updater",a.id="uploader-status-updater-view";var b="background:rgba(255,255,255,0.8);text-align:left;padding:10px;overflow:auto;max-height:600px;position:fixed;z-index:100000000000;top:36px;right:0;display:none";return this.resources.mode.debug&&(b+="display:block"),a.style.cssText=b,a},_createErrorMessage:function(a){var b=a.map(function(a){return a.$validation_errors?"<li>"+a.name+"<br>"+a.$validation_errors.join("<br>")+"</li>":"<li>"+a.name+"<br> invalid file </li>"
});return'<ul class="uploader-error-message">'+b.join("<br>")+"</ul>"},_attachProgressNode:function(a,b){if(!b.getNode){var c=document.createElement("li");c.style.padding="5px",c.style.background="hsla(200,100%,50%,0.2)";var d="<span>File Name: "+b.name+"</span><span>Size: "+b.size+'</span><div class="uploader-progress-bar">0%<div>';c.innerHTML=d,b.getNode=function(){return c},a.appendChild(c)}},_attachErrorNode:function(a,b){if(!b.getNode){var c=document.createElement("li");c.style.background="hsla(0,100%,50%,0.2)",c.style.padding="5px";var d="Error: <br>"+this._createErrorMessage([b]);c.innerHTML=d,b.getNode=function(){return c},a.appendChild(c),setTimeout(function(){delete b.getNode,c.parentNode&&c.parentNode.removeChild(c)},1e4)}},_finleizeUpload:function(a){var b=this,c=this._createMediaAddRequsetXML(a,this._content.wixType.replace("media","picture"),this._content.compType),d=new XMLHttpRequest;d.onload=function(){W.UserMedia.updateMedia(b._content.wixType)},d.onerror=function(){b.injects().UserMedia.fireEvent("UploadError",'<><ul class="uploader-error-message"><li>Upload Error</li></ul>')},d.open("POST",this.baseUrl+"/media/private/add"),d.withCredentials="true",d.setRequestHeader("Content-Type","application/xml"),d.send(c)},_createMediaAddRequsetXML:function(a,b,c){for(var d,e="<mediaItemList>",f=0;f<a.length;f++)d=a[f].uploadResponse,e+="<mediaItem",e+=' mediaType="'+b,e+='" componentType="'+c,e+='" fileName="'+d.fileName,e+='" originalFileName="'+d.originalName,e+='" fileSize="'+d.fileSize,e+='" width="'+(d.width||""),e+='" height="'+(d.height||""),e+='" mimeType="'+d.mimeType,e+='" iconURL="'+d.iconUrl,e+='" version="'+d.ver,e+='" />\n';return e+="</mediaItemList>"},_parseMediaResponseXML:function(a){var b,c;if(a?(b=a.querySelector("upload"),c=b.getAttribute("success")):(b={getAttribute:function(){return"No Response Error"}},c=!1),"true"===c){var d=a.querySelector("properties"),e=a.querySelector("sys_meta");return{status:b.getAttribute("errorDescription"),originalName:e.getAttribute("original_file"),mimeType:e.getAttribute("mime_type"),fileUrl:e.getAttribute("file_url"),iconUrl:e.getAttribute("icon_url"),fileSize:e.getAttribute("file_size"),width:e.getAttribute("width"),height:e.getAttribute("height"),ver:e.getAttribute("ver"),fileName:d.getAttribute("file_name")}}return{status:"error",origin:b.getAttribute("origin"),errorCode:b.getAttribute("errorCode"),errorDescription:b.getAttribute("errorDescription")}}}}),c.methods({initialize:function(a,b,c){if(this.parent(a,b,c),this.scriptsRoot=W.Config.getServiceTopologyProperty("scriptsRoot"),this.mediaServerRoot=W.Config.getServiceTopologyProperty("mediaServerRoot"),this.imports.Uploader.isAllApiExists()){var d=window.location.host.split(".").shift();d="editor",this.baseUrl="//"+d+"."+this.mediaServerRoot,this.baseStaticUrl="//0.static."+this.mediaServerRoot,Object.append(this,this.nativeUploader)}else Object.append(this,this.fleshUploader)},render:function(){},_doCallFlash:void 0,_getFlashObj:void 0,setUploadFileType:void 0})}),define.experiment.component("core.editor.components.UploadButton.NativeUploadButtonReverseToFlash.New",function(a,b){var c=a;c.methods({initialize:function(a,b,c){if(this.parent(a,b,c),this.scriptsRoot=W.Config.getServiceTopologyProperty("scriptsRoot"),this.mediaServerRoot=W.Config.getServiceTopologyProperty("mediaServerRoot"),this.imports.Uploader.isAllApiExists()&&0===swfobject.getFlashPlayerVersion().major){var d=window.location.host.split(".").shift();d="editor",this.baseUrl="//"+d+"."+this.mediaServerRoot,this.baseStaticUrl="//0.static."+this.mediaServerRoot,Object.append(this,this.nativeUploader)}else Object.append(this,this.fleshUploader)}})}),define.experiment.component("core.editor.components.dialogs.DialogWindow.AddBIonClosingDialog.New",function(a,b){var c=a,d=b;c.binds(d.merge(["_onDialogClosing"])),c.methods({_listenToDialogClosing:function(a,b){var c={innerComponentName:a,innerComponentLogic:this.getInnerDialog().getLogic(),args:b};this.addEvent("onDialogClosing",this._onDialogClosing.bind(this,c))},_onDialogClosing:function(a,b){var c=a.innerComponentName,d=a.innerComponentLogic,e=a.args,f=e&&e.dialogId?e.dialogId:c.toString(),g={c1:f};return"_helpDialog"==f&&(g.c2=W.Utils.encodeUrl(d.url)),b&&b.result&&(g.c3=b.result.toString()),LOG.reportEvent(wixEvents.DIALOG_CLOSED,g),e&&e.callback&&e.callback(),g}})}),define.experiment.component("core.editor.components.dialogs.MediaDialog.ImageUploadBI.New",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){LOG.reportEvent(wixEvents.MEDIA_DIALOG_OPEN)}),_onClosing:d.before(function(a){var b="",c="";this._currentSelection[0]&&(b=this._currentSelection[0].getLogic().getDataItem()._data.fileName,c=this._currentSelection[0].getLogic().getDataItem()._data.mimeType);var d=this._currentTab.listID,e={c1:b,c2:d,c3:c};"OK"==a.result?LOG.reportEvent(wixEvents.MEDIA_DIALOG_OK,e):LOG.reportEvent(wixEvents.MEDIA_DIALOG_CANCEL,e)})})}),define.experiment.Class("core.editor.managers.editormanager.EditorManagerBase.FirstSave.New",function(a,b){var c=a;c.statics({MILLISECONDS_TO_POP_UP_AUTO_FIRST_SAVE:12e5})}),define.experiment.newDataSchema("CharacterSets.FontsProject.New",function(){return{sets:{type:"array","default":""}}}),define.experiment.newDataSchema("ContactInformation.MobileQuickActions.New",function(){return{logoUrl:{type:"ref","default":""},companyName:{type:"string","default":""},phone:{type:"string","default":""},email:{type:"string","default":""},address:{type:"string","default":""},fax:{type:"string","default":""}}}),define.experiment.newDataSchema("QuickActions.MobileQuickActions.New",function(){return{quickActionsMenuEnabled:{type:"boolean","default":!1},navigationMenuEnabled:{type:"boolean","default":!0},phoneEnabled:{type:"boolean","default":!1},emailEnabled:{type:"boolean","default":!1},addressEnabled:{type:"boolean","default":!1},socialLinksEnabled:{type:"boolean","default":!1},colorScheme:{type:"string","enum":["dark","light"],"default":"dark"}}}),define.experiment.newDataSchema("SocialLinks.MobileQuickActions.New",function(){return{facebook:"string",twitter:"string",pinterest:"string",google_plus:"string",tumblr:"string",blogger:"string",linkedin:"string",youtube:"string",vimeo:"string",flickr:"string"}}),define.experiment.Class("core.editor.managers.editormanager.EditorManagerBase.MobileQuickActions.New",function(a,b){var c=a,d=b;c.resources(d.merge(["W.Data"])),c.methods({_siteLoaded:function(a){LOG.reportEditorLoadingEvent("SITE LOADED"),this.fireEvent(Constants.EditorEvents.SITE_LOADED,a),this._siteStructure=a,this._setMetaSiteData(),this._setSiteMetaData(),this._siteLoadedExtra(a)},_setSiteMetaData:function(){if(window.editorModel&&window.editorModel.siteMetaData){var a=window.editorModel.siteMetaData,b=a.contactInfo,c={type:"ContactInformation"};for(var d in b)c[d]=b[d];a.preloader&&(c.logoUrl=this.resources.W.Data.createDataItem({type:"Image",uri:a.preloader.uri,width:256,height:256,borderSize:0,title:"",description:"",alt:""}).getData()),this.resources.W.Data.addDataItem("CONTACT_INFORMATION",c);var e=a.quickActions,f=e.configuration,g={type:"QuickActions",colorScheme:e.colorScheme};for(var h in f)g[h]=f[h];this.resources.W.Data.addDataItem("QUICK_ACTIONS",g);var i=a.quickActions.socialLinks,j={type:"SocialLinks"};i.forEach(function(a){a.id&&a.url&&(j[a.id]=a.url)}),this.resources.W.Data.addDataItem("SOCIAL_LINKS",j)}else this.resources.W.Data.addDataItem("QUICK_ACTIONS",{type:"QuickActions"}),this.resources.W.Data.addDataItem("CONTACT_INFORMATION",{type:"ContactInformation"}),this.resources.W.Data.addDataItem("SOCIAL_LINKS",{type:"SocialLinks"})}})}),define.experiment.Class("core.editor.managers.serverfacade.ServerApiUrls.NoRedirectOnFirstSave.New",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){this._constants.FIRST_SAVE_URL_PART="/api/first_save"}),getFirstSaveUrl:function(){return this._getUrlWithQueryParams(this._constants.FIRST_SAVE_URL_PART)}})}),define.experiment.Class("core.editor.managers.serverfacade.ServerApiUrls.SiteVersion.New",function(a,b){var c=a;c.methods({getOverrideSaveUrl:function(){return this._constants.OVERRIDE_SAVE_URL_PART="/api/override_save",this._getUrlWithQueryParams(this._constants.OVERRIDE_SAVE_URL_PART)}})}),define.experiment.Class("core.editor.managers.serverfacade.SiteSerializer.CustomSiteWidth.New",function(a){var b=a;b.methods({_handleSingleDataItem:function(a,b){return"SITE_STRUCTURE"===b?{renderModifiers:a.getData().renderModifiers,siteName:a.getData().siteName,mainPage:a.getData().mainPage,mainPageId:a.getData().mainPageId||void 0,siteWidthInPixels:a.getData().siteWidthInPixels||980,type:"Document"}:a.cloneData()}})}),define.experiment.Class("core.editor.managers.uploadmanager.Uploader.ImageUploadBI.New",function(a,b){var c=a,d=b;c.methods({createUploadButton:function(){var a=document.createElement("div");a.innerHTML='<button id="uploadClick">Upload File</button><input type="file" id="fileinput" multiple/>',a.id="uploader-wrapper";var b=a.querySelector("#fileinput"),c=a.querySelector("#uploadClick");c.onclick=function(){LOG.reportEvent(wixEvents.UPLOAD_BUTTON_PRESSED),b.click()},b.onchange=this.fileListChanged.bind(this),this.uploadButton=a,this.uploadButton.setTitle=function(a){c.textContent=a||"Upload File"},this.appendTo&&this.appendTo.appendChild(a)},handleSelectedFiles:d.after(function(a){var b={c1:"",c2:"",i1:a.length};a.length>0&&(b.c1=a[0].name,b.c2=a[0].type),LOG.reportEvent(wixEvents.UPLOAD_SELECTED_FILES,b)})})}),define.experiment.Class("core.managers.ConfigurationManager.ImagesFromTopology.New",function(a,b){var c=a;c.binds(["_saveTopology"]),c.methods({initialize:b.after(function(){this.resource.getResourceValue("topology",this._saveTopology)}),_saveTopology:function(a){this._topology=a},getLocationMapProperty:function(a){return this._topology[a]}})}),define.experiment.Class("core.managers.configuration.MobileConfigurationManager.AddUserAgents.New",function(a,b){var c=a;c.methods({_isMobileUserAgent:function(){return/iphone|ipod|android.*mobile|windows.*phone|blackberry.*mobile/i.test(window.navigator.userAgent.toLowerCase())},isMobile:function(){if("boolean"==typeof this._isMobile)return this._isMobile;var a=Math.min(screen.width,screen.height);this.isAppleMobileDevice()||(a/=window.devicePixelRatio);var b=a<this.MOBILE_MAX_WIDTH,c=this._isMobileUserAgent();return this._isMobile=(b||c)&&this.isTouchScreen(),this._isMobile}})}),define.experiment.Class("core.managers.configuration.MobileConfigurationManager.FixViewport.New",function(a,b){var c=a;c.methods({_getScreenWidth:function(){var a=this.isAppleMobileDevice();return a||this.isNewChromeOnAndroid()?screen.width:screen.width/window.devicePixelRatio},getMobileScreenWidth:function(){var a=Math.min(screen.width,screen.height);return this.isAndroidMobileDevice()&&!this.isNewChromeOnAndroid()&&(a/=window.devicePixelRatio),a},isNewChromeOnAndroid:function(){if(this.isAndroidMobileDevice()){var a=navigator.userAgent.toLowerCase();if(/chrome/i.test(a)){var b=a.split("chrome/"),c=b[1].split(" ")[0],d=c.split(".")[0],e=parseInt(d);if(e>=27)return!0}}return!1},isMobile:function(){if("boolean"==typeof this._isMobile)return this._isMobile;var a=this.getMobileScreenWidth(),b=a<this.MOBILE_MAX_WIDTH,c=this._isMobileUserAgent();return this._isMobile=(b||c)&&this.isTouchScreen(),this._isMobile}})}),define.experiment.Class("core.managers.components.BCComponentDeserializer.PageDuplicateLinksFix.New",function(a){var b=a;b.resources(["W.Data","W.Preview"]),b.methods({initialize:function(){this._previewDataManager=null},_createBuilderFromCompDescription:function(a){var b=a.node;this._isComponentRichText(a)&&this._cloneDataWithNewId(a);var c=this._initBuilder(a,b),d=a.components||[];return this._createChildren(d).each(this._attchToBuilder(c)),c},_isComponentRichText:function(a){return a.dataQuery&&-1!==a.componentType.indexOf("WRichText")},_cloneDataWithNewId:function(a){this._previewDataManager=this._previewDataManager||this.resources.W.Preview.getPreviewManagers().Data;var b=this._previewDataManager.getDataByQuery(a.dataQuery);this._handleTextComponentPaste(b.getData())},_handleTextComponentPaste:function(a){var b=a.text;if(b){var c,d=/dataquery\=\"([^\"]+)\"/g,e=d.exec(b);this._previewDataManager=this._previewDataManager||this.resources.W.Preview.getPreviewManagers().Data;for(var f=this._previewDataManager;e&&e.length>0;){c=e[1];var g=f.getDataByQuery(c);if(g=g||f.getDataByQuery("#"+c),!g)return LOG.reportError(wixErrors.LINK_DATA_ITEM_DOESNT_EXIST,"WClipBoard","_handleTextComponentPaste",c),void 0;var h=g.getData(),i=Object.clone(h);delete i.id;var j=f.addDataItemWithUniqueId("Link",i),k="#"+j.id;b=b.replace(c,k),e=d.exec(b)}a.text=b}}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.EditorScripting.New",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){}),getComponentName:function(){return this._view.getProperty("compname")},getComponentNameOrID:function(){return this.getComponentName()||this.getID()},setComponentName:function(a){return this._view.setProperty("compname",a)}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.InnerStylesFix.New",function(a,b){var c=a;c.methods({_createComponentbyDefinition:function(a,b,c){b=b||new Element("div"),b.setProperty("skinPart",a.id);var d;if(a.dataQuery)d=a.dataQuery;else if(a.dataRefField){var e=a.dataRefField;d="*"===e?this._data:this._data.get(e)}else if(a.dataItem)d=a.dataItem;else if(a.dataType){var f=this._data?this._data.getDataManager():W.Data;d=f.addDataItemWithUniqueId("",{type:a.dataType}).dataObject,d.setMeta("isPersistent",!1)}this._data&&this._data.getDataManager()!==W.Data?b.set("dataQuerySource","preview"):a.dataQuerySource&&b.set("dataQuerySource",a.dataQuerySource),a.argObject=a.argObject||{};var g;a.styleGroup&&this._style&&(g="inherit"===a.styleGroup?this._style:this._style.getStyleByGroupName(a.styleGroup)),!g&&a.styleId&&b.setProperty("styleId",a.styleId);var h;return(c||g)&&(h=function(a){c&&c(a)}),this.injects().Components.createComponent({compNode:b,type:a.type,skin:a.skin,data:d,args:a.argObject,componentReadyCallback:h,innerStyle:g})},wixifySetSkin:function(a){if(!this._skin){this._skin=a;var b=this.getSizeLimits(),c=this._originalSizeLimits;b.minW=this._skin.minW||c.minW,b.minH=this._skin.minH||c.minH,b.maxW=this._skin.maxW||c.maxW,b.maxH=this._skin.maxH||c.maxH,this._updateViewAttributes(),this._skin.register(this._view,this._setSkinPartElements,this._skinParamsChange)}},wixifySetStyle:function(a,b){this._style=a,b&&this._style.addEvent("skinChange",this._replaceSkinAsync),this._onStyleReady()}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.MaximumComponentHeight.New",function(a){var b=a;b.statics({MAXIMUM_HEIGHT_DEFAULT:5e3})}),define.experiment.Class("mobile.core.components.base.BaseComponent.PartialComponentPreview.New",function(a,b){var c=a;c.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0,previewable:!1},custom:[]}}),c.methods({isPreviewable:function(){return this.EDITOR_META_DATA.general.previewable},getPreviewableActionsContainer:function(){return"itemsContainer"}})}),define.experiment.Class("mobile.core.components.base.BaseComponent.Responsive1.New",function(a){var b=a;b.methods({_onAutoSized:function(a){if(!this._view||!this._isDisplayed||0==this.getPhysicalHeight())return this._pendingAutoSize=!0,this._pendingAutoSizeArgs=a,void 0;var b=this._actualWidth;this.flushPhysicalHeightCache();var c,d=this.getPhysicalHeight(),e=this.getWidth();if(c=this._lastHeightOnAutoSize?this._lastHeightOnAutoSize:0,(d!=c||b!=e&&b)&&(this._actualWidth=e,!a||!a.ignoreLayout)){var f=!0;null==this.getAnchors()||W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getAnchors())?f=!1:null!=this.getHorizontalGroup()&&W.Layout&&!W.Layout.validateAnchorTargetsRendered(this.getHorizontalGroup())?f=!1:this._areAnchorsAlreadySet||(f=!1),this._anchorTargetsReady||f?(this._anchorsInvalidated=!1,this._anchorTargetsReady=!0,W.Layout&&W.Layout.enforceAnchors([this])):this._anchorsInvalidated=!0}if(this._view.get("needsToEnforceAnchors")){var g=this;setTimeout(function(){W.Layout&&W.Layout.enforceAnchors([g])},1e3)}this._lastHeightOnAutoSize=d,this.fireEvent("autoSizeChange")}})}),define.experiment.Class("core.managers.component.ComponentManager.SyncWixify.New",function(a){var b=a;b.methods({getComponent:function(a,b){if(a=this.getNameOverride(a),this._componentMap[a])return b&&b(this._componentMap[a]),this._componentMap[a];var c=this.define.getDefinition("component"),d=nsUtil.getNameSpace(c,a),e=this._componentQue.hasQueue(a)===!1;return this._componentQue.add(a,b),e&&(d?this.registerNewComponent(a,d):this._classManager.getClass(a,function(){})),null}})}),define.experiment.Class("core.managers.css.CssManager.FontsProject.New",function(a,b){var c=a,d=b;c.resources(["W.Resources","W.Data"]),c.methods({initialize:d.before(function(){this._initCharacterSets()}),_initCharacterSets:function(){var a=this.resources.W.Data;if(a.isDataAvailable("#CHARACTER_SETS")){var b=a.getDataByQuery("#CHARACTER_SETS");this._cahracterSets=b.get("setsList")}else{switch(this._cahracterSets=["latin"],languageSymbol=this.resources.W.Resources.getLanguageSymbol()){case"pl":this._cahracterSets.push("latin-ext");break;case"ru":this._cahracterSets.push("cyrillic")}a.addDataItem("CHARACTER_SETS",{type:"CharacterSets",sets:this._cahracterSets.clone()})}},_getFontsQuery:function(a){fontQuery="";for(var b in a)fontQuery+=b.split(" ").join("+"),fontQuery+=":n,b,i,bi|",fontQuery+="&subset="+this._cahracterSets.join(",");return fontQuery},_configureCustomFonts:function(){this._customFontsCssDefinition={},this._customFontsNames=[],this.getFontsData();var a=Object.filter(Constants.FONT_METADATA.fonts,function(a){return"google"==a.provider});for(fontName in a)this._customFontsNames.push(fontName),this._customFontsCssDefinition[fontName]=fontName},getFontsData:function(){return Constants.FONT_METADATA.fonts},getFontsListSpriteUrl:function(){return"richtext/fonts.FontsProject.New.png"}})}),define.experiment.Class("core.managers.css.CssManager.Staff.Wix",function(a,b){var c=a,d=b;c.methods({_configureSystemFonts:d.before(function(){Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["Meiryo","メイリオ","ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-UltLt"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-UltLt"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-25UltL"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-35Thin"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-45Ligh"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-65Medi"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-75Bold"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW01-95Blac"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW02-95Blac"]),Constants.CSS.SYSTEM_FONTS["sans-serif"].push(["HelveticaNeueW10-95Blac"]);var a=this.getHelveticaCssUrl();a&&this._addFontsLoaderCssTag(a)}),getFontsListSpriteUrl:function(){return"richtext/fontsStaff.png"}})}),define.experiment.Class("core.managers.data.DataItemBase.StylePerComponent.New",function(a){var b=a;b.methods({markDataAsClean:function(){var a=this.get("id");this._dataManager.clearDirtyObject(a)}})}),define.experiment.Class("core.managers.data.DataItemBase.SyncWixify.New",function(a){var b=a;b.methods({isReady:function(){return!0}})}),define.experiment.Class("core.managers.data.DataItemWithSchema.SyncWixify.New",function(a){var b=a;b.methods({isReady:function(){if(this._isReady)return!0;var a=this.getWaitingForReadyList();return this._isReady=a.length>0?!1:!0,this._isReady},getWaitingForReadyList:function(){var a=[],b=this.getData(),c=this.getDataManager();for(var d in b){var e,f,g=this.getFieldType(d);if("ref"==g){if(e=this.get(d),!e)continue;f=c.isDataAvailable(e),f||a.push(e)}else if("refList"==g)for(var h=this.get(d),i=0;i<h.length;i++)e=h[i],f=c.isDataAvailable(e),f||a.push(e)}return a}})}),define.experiment.Class("core.managers.data.DataManager.NoRedirectOnFirstSave.New",function(a){var b=a;b.methods({markAllDirty:function(){for(var a in this.dataMap){var b=this.dataMap[a];b.getMeta("isPersistent")!==!1&&(this.dirtyDataObjectsMap[a]=this.dataMap[a])}}})}),define.experiment.Class("core.managers.data.DataManager.SiteVersion.New",function(a){var b=a;b.methods({markAllDirty:function(){for(var a in this.dataMap){var b=this.dataMap[a];b.getMeta("isPersistent")!==!1&&(this.dirtyDataObjectsMap[a]=this.dataMap[a])}}})}),define.experiment.Class("core.managers.data.DataManager.StylePerComponent.New",function(a){var b=a;b.methods({clearDirtyObject:function(a){delete this.dirtyDataObjectsMap[a]}})}),define.experiment.Class("core.managers.data.DataManager.SyncWixify.New",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){this._notReadyDataMap={},this._waitingForReadyDataMap={}}),addDataItem:function(a,b){b=this.resources.W.Experiments.applyExperiments(a,b);var c=this.createDataItem(b);c._data.id=a,this.markDirtyObject(c);var d=c.isReady();return d?this._setDataReady(c):this._addToWaitingForReady(c),c},_addToWaitingForReady:function(a){var b=a.get("id");this._notReadyDataMap[b]=a;for(var c=a.getWaitingForReadyList(),d=0;d<c.length;d++){var e=c[d];0===e.indexOf("#")&&(e=e.substr(1)),this._waitingForReadyDataMap[e]||(this._waitingForReadyDataMap[e]=[]),this._waitingForReadyDataMap[e].push(b)}},_setDataReady:function(a){var b=a.get("id");this.dataMap[b]=a,this._runCallbacks(b,a),this._updateDataWaitingList(a),this._notReadyDataMap[b]&&delete this._notReadyDataMap[b]},_updateDataWaitingList:function(a){var b=a.get("id"),c=this._waitingForReadyDataMap[b];if(c){delete this._waitingForReadyDataMap[b];for(var d=0;d<c.length;d++){var e=this._notReadyDataMap[c[d]];e&&e.isReady()&&this._setDataReady(e)}}},getDataByQuery:function(a,b){var c=null;if(0===a.indexOf("#")){var d=a.substr(1);if(c=this.dataMap[d],b=b||function(){},c)return b(c),c;this.callbackQueue.add(d,b);var e=this.define.getDefinition(this.DEFINE_NAMESPACE),f=nsUtil.getNameSpace(e,d);if(f)return this.addDataItem(d,f)}else LOG.reportError(wixErrors.DM_MALFORMED_QUERY,"DataManager","getDataByQuery",a),W.Utils.callLater(b,[null])},isReady:function(){return Object.getLength(this._notReadyDataMap)>0&&Object.getLength(this._waitingForReadyDataMap)>0?!1:!0}})}),define.experiment.Class("core.managers.serverfacade.CorsRESTClient.ShowOneMnMessage.New",function(a,b){var c=a;c.methods({get:function(a,b,c){var d=this._createCorsXhr(a);d.onabort=function(){this._onXhrEvent("abort",d,c)}.bind(this),d.ontimeout=function(){this._onXhrEvent("timeout",d,c)}.bind(this),d.onerror=function(){this._onXhrEvent("error",d,c)}.bind(this),d.onload=function(){this._onXhrEvent("load",d,c)}.bind(this),d.onprogress=function(){},b&&Object.each(b,function(a){a.key&&a.value&&d.setRequestHeader(a.key,a.value)}),d.send()}})}),define.experiment.Class("core.managers.skin.BaseSkin2.InnerStylesFix.New",function(a){var b=a;b.methods({setParamMapper:function(a,b){this.removeParamMapper(),this._paramMapper=a,this._paramMapper.addEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onParamChange),b&&this._paramMapper.addEvent(Constants.StyleEvents.SKIN_CHANGED,this._onParamMapperSkinChange),this._render()}})}),define.experiment.Class("core.managers.skin.SkinManager.SyncWixify.New",function(a){var b=a;b.methods({getSkin:function(a,b){if(a=this.getNameOverride(a),this._skinClassMap[a])return b&&b(this._skinClassMap[a]),this._skinClassMap[a];var c=this._skinQue.hasQueue(a)===!1;if(this._skinQue.add(a,b),c){var d=this.define.getDefinition("skin"),e=nsUtil.getNameSpace(d,a);e?this.registerNewSkin(a,e):this._classManager.getClass(a,function(){})}return this._skinClassMap[a]||null}})}),define.experiment.Class("core.managers.skin.SkinRenderer.InnerStylesFix.New",function(a){var b=a;b.methods({getStyleId:function(a){return a&&a.getMapId()||""}})}),define.experiment.Class("core.managers.style.SkinParamMapper.AdvancedStylingCancel.New",function(a,b){var c=a;c.methods({resetStyleFromData:function(a,b){this._skin=new b,this._rawData=Object.clone(a),this._dataItem.set("skin",this._skin.$className),this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this.fireEvent(Constants.StyleEvents.SKIN_CHANGED),this.fireEvent(Constants.StyleEvents.READY)}})}),define.experiment.Class("core.managers.style.SkinParamMapper.InnerStylesFix.New",function(a,b){var c=a,d=b;c.methods({initialize:function(a,b,c,d){this.SkinParserClass=this.imports.SkinParamParser,this.SkinParamRenderHandlerClass=this.imports.SkinParamRenderHandler,this._dataItem=a,this._rawData=b,this._mapId=this._dataItem.get("id")+(d?"-"+d:""),c="string"==typeof c?W.Skins.getSkin(c):c,this._skin=new c,this._initMapProperties(),this._skinParser=new this.SkinParserClass(this._dataItem,this._rawData,this._skin,this.$class),this._skinParamRenderHandler=new this.SkinParamRenderHandlerClass(this.getGroups()),this._garbageCollection(),this.resource.getResourceValue("W.Theme",function(a){a.getDataItem().addEvent(Constants.DataEvents.DATA_CHANGED,this._onThemePropertiesChange)}.bind(this))},getNewGroupIdCounter:d.remove()})}),define.experiment.Class("core.managers.style.SkinParamParser.InnerStylesFix.New",function(a,b){var c=a;c.methods({_parseSkinInnerComponents:function(a,b,c,d){for(var e in c){var f=c[e].skin,g=c[e].styleGroup,h=this._findSkinByName(f,d);if(g)if("inherit"===g)this.parseSkinByInstance(a,b,h);else if(this._hasGroupInRawData(b,g)){var i=b.groups[g];this._innerSkinMaps[g]?this._innerSkinMaps[g].addInnerSkin(a,i,h):this._innerSkinMaps[g]=new this.SkinMapperClass(a,i,h,g)}}},_hasGroupInRawData:function(a,b){return a.groups&&a.groups[b]?!0:!1}})}),define.experiment.Class("core.managers.theme.ThemeManager.Responsive1.New",function(a,b){var c=a,d=b;c.methods({hasProperty:function(a){return null!=this._data.getFieldSchema(a)},getPropertyType:function(a){return this._data.getFieldSchema(a)?this._data.getFieldSchema(a).type:void 0},_onDataReady:d.before(function(a){if(a._data.font){this._originalFontValues=[];for(var b=0;b<a._data.font.length;b++){var c=a._data.font[b],d=c.indexOf("px"),e=c.lastIndexOf(" ",d)+1,f=c.substring(e,d);this._originalFontValues.push(parseInt(f)),a._data.font[b]=c.replace(f,this.convertFontSizeToMobile(parseInt(f)))}}}),getOriginalFontSize:function(a){return this._originalFontValues[parseInt(a.substr(5))]},convertFontSizeToMobile:function(a){var b,c=30,d=12,e=16,f=Math.abs(a-e),g=(a-e)/f;return b=e+g*Math.pow(f,.65),b=Math.max(b,d),b=Math.min(b,c),Math.round(b)}})}),define.experiment.Class("core.managers.viewmanager.ViewManagerBase.LazyMasterPage.New",function(a,b){var c=a;c.methods({_isInPage:function(a){return!this._notChildOfSelector(a,"[comp=mobile.core.components.Page],[comp=core.components.Page],[comp=wixapps.integration.components.AppPage]")},_isPage:function(a){return"mobile.core.components.Page"===a.get("comp")||"core.components.Page"===a.get("comp")||"mobile.core.components.Page"===a.get("comp")},_getPagesWithoutContent:function(a){return this._getAllComponents(a,function(a){return this._isPage(a)}.bind(this))},_getMasterPageComponentsWithoutPages:function(a){var b=this._getAllComponents(a,function(a){return!this._isInPage(a)&&!this._isPage(a)}.bind(this));if(window.adData){this.setAdData(window.adData);var c=document.getElementById("wixFooter");c&&b.push(c)}return b},_wixifySiteLazily:function(a,b){var c=this._getPagesWithoutContent(a),d=this._getMasterPageComponentsWithoutPages(a),e=!1,f=!1;this._logViewerRender("master page render"),new Async.Bulk(c,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){c.removeClass("initHidden"),this.updatePagesData();var a=[];if(b===!1)for(var d in this._pages)a.push(this._pages[d].getLogic());else{var g=this._getPageDataFromHash(W.Utils.hash.getHash());a.push(this._pages[g.get("id")].getLogic())}this._logViewerRender("page render"),new Async.Bulk(a,null,{completeEvent:"contentWixified",completeCallback:function(){e=!0,f&&this._onSiteReady()}.bind(this)});for(var h=0;h<a.length;++h)a[h].wixifyContent()}.bind(this)}),new Async.Bulk(d,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){f=!0,e&&this._onSiteReady()}.bind(this)}),c.wixify(),d.wixify()},_logViewerRender:function(a){deployStatus("viewerRender",{step:a,time:LOG.getSessionTime()})}})}),define.experiment.Class("core.managers.viewmanager.ViewManagerBase.PageLoadReport.New",function(a,b){var c=a,d=b;c.methods({_wixifySiteLazily:function(a,b){var c=this._getInitComponents(a);if(window.adData){this.setAdData(window.adData);var d=document.getElementById("wixFooter");d&&c.push(d)}this._logViewerRender("master page render"),new Async.Bulk(c,null,{completeEvent:Constants.ComponentEvents.READY,completeCallback:function(){c.removeClass("initHidden"),this.updatePagesData();var a=[];if(b===!1)for(var d in this._pages)a.push(this._pages[d].getLogic());else{var e=this._getPageDataFromHash(W.Utils.hash.getHash());a.push(this._pages[e.get("id")].getLogic())}this._logViewerRender("page render"),new Async.Bulk(a,null,{completeEvent:"contentWixified",completeCallback:function(){this._onSiteReady()}.bind(this)});for(var f=0;f<a.length;++f)a[f].wixifyContent()}.bind(this)}),c.wixify()},_onSiteReady:d.before(function(){this._logViewerRender("site ready")}),_logViewerRender:function(a){deployStatus("viewerRender",{step:a,time:LOG.getSessionTime()})}})}),define.experiment.Class("core.managers.viewmanager.ViewManagerBase.SiteJumpFix.New",function(a,b){var c=a;c.resources(["W.Config"]),c.methods({_onSiteReady:function(){this.setPreviewMode(this._isPreview),this._isReady=!0,this._isSiteReady=!0,this.isMobileDevice()&&this._scrollToHideMobileAddressBar(),W.Utils.hash.addEvent("change",this._onHashChange),W.Utils.hash.fireHashChangeEvent(),this._loadNextPage(),this._reportBIEvents(),this.fireEvent("SiteReady"),"editor"==window.viewMode&&"#save=1"==window.location.hash&&(window.location.hash="save=0",W.Commands.executeCommand("WEditorCommands.SaveSuccessDialog"))},isMobileDevice:function(){return this.resources.W.Config.mobileConfig.isMobile()},_scrollToHideMobileAddressBar:function(){window.scrollTo(0,1)}})}),define.experiment.newClass("core.utils.LinkRenderer.LinkRefData.New",function(a){var b=a;b.resources(["W.Config"]),b.statics({PROTOCOL_POSTFIX:"://",HTTP_DEFAULT_PORT:80,PORT_PREFIX:":",SAME_TAB_TARGET:"_self",NEW_TAB_TARGET:"_blank",PAGE_LINK_PREFIX:"#!",MAILTO_PREFIX:"mailto:",MEDIA_STATIC_URL:"http://media.wix.com/ugd/"}),b.methods({renderLink:function(a,b){if(!a||!b||!b.getType())throw new Error("Link Rendering failed! No Node or no valid LinkDataItem");var c=b.getType().toLowerCase();switch(c){case"websitelink":return this._renderURLLinkOnNode(a,b.getData());case"pagelink":return this._renderPageLink(a,b.getData());case"emaillink":return this._renderEmailLink(a,b.getData());case"documentlink":return this._renderDocumentLink(a,b.getData());default:return}},_renderURLLinkOnNode:function(a,b){var c=this.renderURLLink(b);a.set("href",c),this._setLinkTarget(a,b)},renderURLLink:function(a){var b=a.port===this.HTTP_DEFAULT_PORT?"":this.PORT_PREFIX+a.port,c=[a.protocol,this.PROTOCOL_POSTFIX,a.domain,b,a.path].join("");
return c},_renderPageLink:function(a,b){a.set("href",this.PAGE_LINK_PREFIX+b.pageId),this._setNodeTarget(a,this.SAME_TAB_TARGET)},_renderEmailLink:function(a,b){var c=b.mail,d=b.mailParams;0!=c.indexOf(this.MAILTO_PREFIX)&&(c=this.MAILTO_PREFIX+c),d&&(c=[c,"?",d].join("")),a.set("href",c),this._setLinkTarget(a,null)},_renderDocumentLink:function(a,b){var c=this.MEDIA_STATIC_URL+b.docId;a.set("href",c),this._setLinkTarget(a)},_setLinkTarget:function(a,b){var c;c=b?b.target:this.NEW_TAB_TARGET,this._setNodeTarget(a,c)},_setNodeTarget:function(a,b){a.set("target",b)},removeRenderedLinkFrom:function(a){a.removeAttribute("href"),a.removeAttribute("target")}})}),define.experiment.Class("core.utils.css.Background.BackgroundSRZ.New",function(a){var b=a;b.methods({_getPyramidSuffix:function(){var a,b,c="",d=this._pyramid||Constants.Background.DEFAULT_PYRAMID_SIZE,e=[],f=1;e[0]=parseInt(this.getImageSize()[0],10),e[1]=parseInt(this.getImageSize()[1],10),f=e[0]/e[1],a=e[0],b=e[1],(e[0]>d||e[1]>d)&&(a=e[0]>=e[1]?d:Math.round(f*d),b=e[1]>=e[0]?d:Math.round(1/f*d));var g=this._getFileExtension(this._imageId);return c="_srz_"+a+"_"+b+"_75_22_0.50_1.20_0.00_"+g+"_srz"},_getFileExtension:function(a){var b=/[.]([^.]+)$/.exec(a);return b&&/[.]([^.]+)$/.exec(a)[1]||""}})}),define.experiment.Class("core.utils.css.Background.MobileBackgroundSize.New",function(a){var b=a;b.methods({_getPyramidSuffix:function(){var a,b,c=W.Config.mobileConfig.isMobileOrTablet(),d="",e=this._pyramid||(c?1e3:Constants.Background.DEFAULT_PYRAMID_SIZE),f=[],g=1;f[0]=parseInt(this.getImageSize()[0],10),f[1]=parseInt(this.getImageSize()[1],10),g=f[0]/f[1],a=f[0],b=f[1],(f[0]>e||f[1]>e)&&(a=f[0]>=f[1]?e:Math.round(g*e),b=f[1]>=f[0]?e:Math.round(1/g*e));var h=this._getFileExtension(this._imageId);return d="_srz_"+a+"_"+b+"_75_22_0.50_1.20_0.00_"+h+"_srz"},_getFileExtension:function(a){var b=/[.]([^.]+)$/.exec(a);return b&&/[.]([^.]+)$/.exec(a)[1]||""}})});